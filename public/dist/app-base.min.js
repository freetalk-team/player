/*! For license information please see app-base.min.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(self,(()=>(()=>{var __webpack_modules__={278:()=>{function e(e){let t,i=!1;"object"==typeof e?(t=e.content,i=!0):t=e;let n,s,r,o=t;n=t.match(/^(!\[[^\]]+\]\((.*)\))?[ \n]*(.*)/),n&&(r=n[2],o=n[3],n=o.match(/^(#{1,6}[ ]+(.*))?[ \n]*(.*)/),n&&(s=n[2],o=n[3]||s));const a=Object.deleteUndefined({title:s,thumb:r});return i&&Object.assign(e,a),a.content=o,a}Object.assign(window,{toMarkdown:function(e,t=e.type){if("string"==typeof e)return e.replace(/"(.*?)"/g,((e,t)=>`***${t}***`)).replace(/\((.*?)\)/g,((e,t)=>`(*${t}*)`));switch(t){case"files":return function(e){let t,i="### Files share\n\n|name|size||\n|:-----|:-:|:-:|";for(const n of e)t=n.link,i+=`\n|${n.name}|${fileX.formatSize(n.size)}|[link](${t})|`;return i}(e);case"task":return function(e){let t="### "+e.title||0;return e.user&&(t+=`\n<font size="2">*Author:* **${e.user.name}**</font>`),e.ts&&(t+=`\n<font size="2">*Created: ${new Date(1e3*e.ts).formatTimeDate()}*</font>`),e.md&&(t+="\n\n"+e.md.replace(/^#{1,3}/gm,"####")),t}(e);case"article":return function(e){let t,i="";if(e.channel&&(t="string"==typeof e.channel?e.channel:e.channel.id),e.thumb&&(i+=`![thumb alt <](${e.thumb})\n`),i+="### "+e.title+"\n\n",!e.logo){const t=new URL(e.link);e.logo=t.origin+"/favicon.ico"}let n=e.date;return n||(n=new Date(e.time||1e3*e.ts).formatTimeDate()),i+=`![logo alt <](${e.logo}) <font size="3">[link](${e.link}) *${n}*</font>`,i}(e)}return null},fromMarkdown:function(t,i){return"post"===i?e(t):{content:t}},getPostInfo:e})},831:()=>{function e(e,t={},i=!0){return console.log("HTTPX Sending request:",e),new Promise(((n,s)=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){var e=r.status;if(0===e||e>=200&&e<400){const t=r.getResponseHeader("content-type");let s=r.responseText;if(i)/application\/json/.test(t)&&(s=JSON.parse(s)),console.log("XHTTP response:",e,t);else{const e=r.response;console.log("RESPONSE:",typeof e,e);const t=inflate(e,{to:"string"});s=JSON.parse(t)}n(s)}else s(e)}},r.open("GET",e,!0),i||(r.responseType="arraybuffer");for(const[e,i]of Object.entries(t))r.setRequestHeader(e,i);r.send()}))}function t(e,t={},i={}){return new Promise(((n,s)=>{const r=new XMLHttpRequest,o=t.constructor===Object;let a,l=t;r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){var e=r.status;if(0===e||e>=200&&e<400){let e;if(r.responseText){const t=r.getResponseHeader("content-type");e=/application\/json/.test(t)?JSON.parse(r.responseText):r.responseText}n(e)}else s(e)}},r.open("POST",e,!0),o?(a="application/json",l=JSON.stringify(t)):t instanceof Blob&&(a="application/octet-stream"),a&&r.setRequestHeader("content-type",a);for(const[e,t]of Object.entries(i))r.setRequestHeader(e,t);r.send(l)}))}window.ajax={get:e,post:t,delete:function(e,t={}){return new Promise(((i,n)=>{const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){var e=s.status;0===e||e>=200&&e<400?i():n(e)}},s.open("DELETE",e,!0);for(const[e,i]of Object.entries(t))s.setRequestHeader(e,i);s.send()}))},fetch:async function(e,t){const i=await fetch(e,t);return"application/json"==i.headers.get("content-type")?await i.json():i.text()},submit:function(e,t){const i=document.createElement("form");i.method="POST",i.action=e;for(const[e,n]of Object.entries(t)){const t=document.createElement("input");t.type="hidden",t.name=e,t.value=n,i.appendChild(t)}document.body.appendChild(i),i.submit(),document.body.removeChild(i)},token:i=>({get:(t,n={})=>(n.authorization="Bearer "+i,e(t,n)),post:(e,n,s={})=>(s.authorization="Bearer "+i,t(e,n,s)),post2:async(e,t,n={})=>(n.authorization="Bearer "+i,n["content-type"]="application/json",(await fetch(e,{method:"POST",headers:n,body:JSON.stringify(t),mode:"no-cors"})).json()),options:(e,t={})=>(t.authorization="Bearer "+i,t.Origin=window.location.origin,function(e,t={}){return new Promise(((i,n)=>{const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){var e=s.status;0===e||e>=200&&e<400?i():n(e)}},s.open("OPTIONS",e,!0);for(const[e,i]of Object.entries(t))s.setRequestHeader(e,i);s.send()}))}(e,t))})}},910:()=>{function e(e){const t=atob(e),i=new Uint8Array(t.length);return Array.prototype.forEach.call(t,((e,t)=>i[t]=e.charCodeAt(0))),i}window.aes={generateKey:function(e=256){return console.log("# Generating new AES key ..."),crypto.subtle.generateKey({name:"AES-CTR",length:e},!0,["encrypt","decrypt"])},importKey:function(t,i="jwt",n=!0){let s;switch(i){case"raw":s=e(t);break;case"jwt":s=JSON.parse(atob(t))}return crypto.subtle.importKey(i,s,{name:"AES-CTR"},n,["encrypt","decrypt"])},exportKey:async function(e){const t=await crypto.subtle.exportKey("jwk",e);return btoa(JSON.stringify(t))},encrypt:async function(t,i,n){const s=new TextEncoder,r="string"==typeof n?e(n):n;let o=s.encode(t);return a=await crypto.subtle.encrypt({name:"aes-ctr",counter:r,length:64},i,o),btoa(String.fromCharCode.apply(null,a instanceof Uint8Array?a:new Uint8Array(a)));var a},decrypt:async function(t,i,n){const s=e(t),r="string"==typeof n?e(n):n;let o=await crypto.subtle.decrypt({name:"aes-ctr",counter:r,length:64},i,s);return(new TextDecoder).decode(o)}}},788:()=>{const e=86400;function t(e){return e instanceof Date?e:"string"==typeof e?new Date(e):new Date(1e3*e)}(new Date).getTimezoneOffset(),Date.prototype.toLocalDateString=function(e,t){if("bg"===e){let e="";if(t.weekday){const i=["Неделя","Понеделник","Вторник","Сряда","Четвъртък","Петък","Събота"],n=this.getDay();e+="short"==t.weekday?i[n].slice(3)+".":i[n],e+=" "}if(t.day&&(e+=this.getDate().toString(),e+=" "),t.month)if("numeric"==t.month);else{const i=["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"][this.getMonth()];e+="short"==t.month&&i.length>4?i.slice(0,3)+".":i,e+=" "}return e.trimEnd()}return this.toLocaleDateString(`${e}-${e.toUpperCase()}`,t)},Date.prototype.toLocalDateStringShort=function(e,t={weekday:"long",month:"short",day:"numeric"}){return this.toLocalDateString(e,t)},Date.prototype.seconds=function(){return Date.toSeconds(this.getTime())},Date.prototype.age=function(e=new Date){return e.getFullYear()-this.getFullYear()},Date.seconds=function(e=1){const t=(new Date).seconds();return Math.floor(t/e)*e},Date.toSeconds=function(e=new Date){return"string"==typeof e&&(e=new Date(e)),e instanceof Date&&(e=e.getTime()),Math.floor(e/1e3)},Date.fromSeconds=function(e){return new Date(1e3*e)},Date.daysToSeconds=function(e){return 24*e*60*60},Date.secondsToString=function(e){return new Date(1e3*e).toISOString()},Date.prototype.offsetFrom=function(e=Date.now(),t=""){const i=Math.floor((e-this.getTime())/1e3);let n,s;return i<3600?(n=Math.floor((i+40)/60),s=0==n?"now":`${n} min`):i<86400?(n=Math.floor(i/3600),s=`${n} h`):i<604800?(n=Math.floor(i/86400),s=`${n} d`):(t=null,s=this.toLocaleDateString("en-US",{month:"short",day:"numeric"})),t&&(s+=" "+t),s},Date.timeElapsed=function(e,t=Date.now()){return new Date(e).offsetFrom(t)},Date.timeElapsedLong=function(e,t=Date.now()){return new Date(e).offsetFrom(t,"ago")},Date.secondsElapsed=function(e=Date.seconds(),t=Date.now()){return Date.timeElapsed(1e3*e,t)},Date.prototype.formatTimeDate=function(){return`${("0"+this.getHours()).slice(-2)}:${("0"+this.getMinutes()).slice(-2)} ${this.toLocaleString("default",{month:"short"})} ${("0"+this.getDate()).slice(-2)}`},Date.formatTimeDate=function(e=Date.seconds()){return t(e).formatTimeDate()},Date.formatDate=function(e=Date.seconds()){return t(e).toDateString()},Date.formatDateMonth=function(e=Date.seconds()){return t(e).toLocaleDateString("en",{month:"short",year:"numeric"})},Date.formatDateShort=function(e=Date.seconds()){return t(e).toLocalDateStringShort("en")},Date.formatDateShorter=function(e=Date.seconds()){return t(e).toLocalDateStringShort("en",{month:"short",day:"numeric"})},Date.todayUTC=function(e=new Date){"number"==typeof e&&(e=new Date(1e3*e));const t=e.setUTCHours(0,0,0,0);return Date.toSeconds(t)},Date.today=function(e=new Date){"number"==typeof e&&(e=new Date(1e3*e));const t=e.setHours(0,0,0,0);return Date.toSeconds(t)},Date.dayStartSeconds=function(t=Date.seconds(),i=0){const n=60*(new Date).getTimezoneOffset();return Math.floor(t/e)*e+i*e+n},Date.tomorrowSeconds=function(){return Date.dayStartSeconds(Date.seconds(),1)},Date.days=function(e,t=Date.now()){return new Date(t+24*e*3600*1e3)}},976:()=>{function e(e,t,i={}){return new Promise(((n,s)=>e.getDirectory(t,i,n,s)))}function t(e){return new Promise(((t,i)=>{e.createReader().readEntries((function(e){t(e)}))}))}function i(e,t){return new Promise(((i,n)=>{e.getFile(t,{},(function(e){e.file((function(e){const t=new FileReader;t.file=e,i(t)}),n)}),n)}))}function n(e,t=0,i){return new Promise(((n,s)=>{e.onloadend=function(e){n(this.result)},e.onerror=s;let r=e.file;i&&(r=r.slice(t,t+i)),e.readAsArrayBuffer(r)}))}function s(e){return new Promise(((t,i)=>e.remove(t,i)))}window.fs={init:function(e=1073741824){return new Promise(((t,i)=>{navigator.webkitPersistentStorage.requestQuota(e,(e=>webkitRequestFileSystem(window.PERSISTENT,e,t,i)))}))},ls:t,directory:e,rmdir:async function(i,n){const r=await e(i,n),o=await t(r);for(const e of o)await s(e);return s(r)},save:async function(e,t){const s=await showSaveFilePicker(),r=await s.createWritable(),o=await i(e,t),a=await n(o);await r.write(a),await r.close()},writer:function(e,t,i=!1){return new Promise(((n,s)=>{e.getFile(t,{create:!0,exclusive:i},(function(e){e.createWriter((function(e){n(e)}))}),s)}))},write:function(e,t){return new Promise(((i,n)=>{e.onwriteend=i,e.onerror=n;const s=new Blob(Array.isArray(t)?t:[t]);e.write(s)}))},truncate:function(e,t){return new Promise(((i,n)=>{e.onwriteend=i,e.onerror=n,e.truncate(t)}))},read:n,reader:i,readFile:async function(e,t){return n(await i(e,t))},getFile:function(e,t){return new Promise(((i,n)=>{e.getFile(t,{},(function(e){e.file((e=>i(e)),n)}),n)}))},metadata:function(e){return new Promise(((t,i)=>{e.getMetadata(t,i)}))},dump:function(e){return new Promise(((t,i)=>{e.createReader().readEntries((function(e){t(e.map((e=>e.name)))}))}))}}},265:()=>{Object.assign(window,{AsyncFunction:Object.getPrototypeOf((async function(){})).constructor,GeneratorFunction:Object.getPrototypeOf((function*(){})).constructor,AsyncGeneratorFunction:Object.getPrototypeOf((async function*(){})).constructor})},537:()=>{Object.toArray=function(e,t=function(){}){const i=[];if(e)for(const[n,s]of Object.entries(e))s.id=s.id||n,t(s),i.push(s);return i},Object.fromArray=function(e){const t={};for(const i of e)t[i.id]=i;return t},Object.empty=function(e){return 0===Object.keys(e).length&&e.constructor===Object},Object.deleteUndefined=function(e){return Object.keys(e).forEach((t=>void 0===e[t]&&delete e[t])),e},Object.flipEntries=function(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[t,e])))},Object.hash=function(e){let t=4294967279;for(const i of Object.values(e))"object"==typeof i?t^=Array.isArray(i)?Array.hash(i):Object.hash(i):"string"==typeof i?t^=i.hashCode():"number"==typeof i?t^=i:"boolean"==typeof i&&(t^=i?1549556828:3318072773);return t>>>0},Object.normalize=function(e){for(const[t,i]of Object.entries(e))if("object"==typeof i)if(Array.isArray(i)){const n=i.filter((e=>!!e));for(const e of n)Object.normalize(e);e[t]=n}else Object.keys(i).length>0?Object.normalize(i):delete e[i]},Object.merge=function(e,t="info"){const i=e=>{e[t]&&(Object.assign(e,e[t]),delete e[t])};if(Array.isArray(e))for(const t of e)i(t);else i(e);return e},Array.hash=function(e){let t=3326489;for(const i of e)"object"==typeof i?t^=Array.isArray(i)?Array.hash(i):Object.hash(i):"string"==typeof i?t^=i.hashCode():"number"==typeof i?t^=i:"boolean"==typeof i&&(t^=i?1549556828:3318072773);return t>>>0},Array.prototype.unique=function(){return this.filter(((e,t,i)=>i.indexOf(e)===t))},Array.prototype.uniqueId=function(e="id"){return Array.from(new Set(this.map((t=>t[e])))).map((t=>this.find((i=>i[e]==t))))},Array.prototype.rotate=function(e){return e%=this.length,this.slice(e,this.length).concat(this.slice(0,e))},Array.prototype.sum=function(){return this.reduce(((e,t)=>e+t),0)},Array.prototype.avg=function(){return this.sum()/this.length},Array.prototype.avgi=function(){return Math.floor(this.avg())},Array.prototype.max=function(e=-2147483648){return this.reduce(((e,t)=>e>t?e:t),e)},Array.prototype.min=function(e=4294967295){return this.reduce(((e,t)=>e<t?e:t),e)},Array.prototype.sortTimestamp=function(){this.sort(((e,t)=>t.ts-e.ts))}},345:()=>{String.prototype.hashCode=function(){for(var e=5381,t=this.length;t;)e=33*e^this.charCodeAt(--t);return e>>>0},String.prototype.hashCodeSigned=function(){return this.hashCode()>>0},String.prototype.hashHex=function(){return this.hashCode().toString(16)},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.splitByCapital=function(){return this.split(/(?=[A-Z])/).join(" ").replace(/(?<=\b[A-Z]) (?=[A-Z]\b)/g,"")},String.prototype.toHex=function(){let e="";for(let t=0;t<this.length;t++)e+=this.charCodeAt(t).toString(16);return e},String.prototype.toByteArray=function(){const e=[];for(let t=0;t<this.length;t+=1){const i=this.charCodeAt(t);if(i<128)e.push(i);else if(i<2048)e.push(192|i>>6,128|63&i);else if(i<55296||i>=57344)e.push(224|i>>12,128|i>>6&63,128|63&i);else{if(t+=1,!(t<this.length))break;{const n=65536+(1023&i)<<10|1023&this.charCodeAt(t);e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n)}}}return e},String.prototype.eval=function(ctx,..._){const exp=this.valueOf();return function(..._){return eval(exp)}.call(ctx,..._)},String.prototype.evalx=function(e,...t){const i=this.replace(/len\((.*?)\)/,((i,n)=>{const s=n.match(/_([0-9])/);if(s){const e=parseInt(s[1]);return t[e]?t[e].length:0}return n.eval(e,...t).length})).replace(/_([0-9])/g,((e,t)=>`_[${t}]`||"")).eval(e,...t);return null!=i?i:""},String.prototype.evalCtx=function(e,t=!0){const i=e,n={};let s=this;const r=s.match(/^var\s+(.*?);(.*)$/);r&&(r[1].split(",").map((e=>e.trim())).map((e=>e.split("=").map((e=>e.trim())))).map((([e,t])=>n[e]=t.evalCtx(i))),s=r[2]);let o=Object.keys(i).concat(Object.keys(n)),a=Object.values(i).concat(Object.values(n)),l=s.replace(/(\.?)(val|len|arr|sum|avgi?|max)\((.*?)\)/,((e,t,i,n)=>{if(t)return e;switch(i){case"len":return`(typeof ${n} == "undefined" ? 0 : (Array.isArray(${n}) ? ${n}.length : 0))`;case"arr":return`(typeof ${n} == "undefined" ? [] : (Array.isArray(${n}) ? ${n} : []))`;case"sum":case"avg":case"avgi":case"max":return`(typeof ${n} == "undefined" ? 0 : (Array.isArray(${n}) ? ${n}.${i}() : 0))`}return`(typeof ${n} == "undefined" ? null : ${n})`}));return Function(...o,t?"return "+l:l)(...a)},String.prototype.replacex=function(e,...t){return this.replace(/\{\{(.+?)\}\}/g,((i,n)=>n.evalx(e,...t)))},String.prototype.localeCompareNocase=function(e){return this.localeCompare(e,"en",{sensitivity:"base"})},String.prototype.startsWithNocase=function(e){return this.toLowerCase().startsWith(e.toLowerCase())},String.prototype.reverse=function(){let e="";for(let t=this.length-1;t>=0;t--)e+=this[t];return e},String.prototype.removeComments=function(e="c"){return this.replace(/\/\*[\s\S]*?\*\/|(?<=[^:])\/\/.*|^\/\/.*/g,"").trim()},String.prototype.align=function(e,t=!0){const i=e>=this.length?" ".repeat(e-this.length):"";return t?this.concat(i):i.concat(this)},String.prototype.display=function(){return this.replace(/[_-]+/g," ").splitByCapital().capitalizeFirstLetter()};const kExpressionPrefix="$>";String.ExpressionPrefix=kExpressionPrefix,String.prototype.isExpression=function(){return this.startsWith(kExpressionPrefix)},String.prototype.expressionValue=function(){return this.slice(kExpressionPrefix.length)},String.prototype.evalExpression=function(e){return this.expressionValue().trim().evalCtx(e)},String.prototype.makeExpression=function(){return kExpressionPrefix+this},String.prototype.matchIndex=function(){const[,e,,t]=this.match(/^([A-z]+)(\[(\d+)\])?$/);return[e,t?parseInt(t):void 0]},String.longestCommonPrefix=function(e){let t=e.reduce(((e,t)=>t.length<e.length?t:e));for(let i of e)for(;i.slice(0,t.length)!=t;)t=t.slice(0,-1);return t},String.evalCtx=function(e,...t){exp.join("\n").evalCtx(e.false)},String.prototype.isEmail=function(){return/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(this.toLowerCase())},String.prototype.getInitials=function(){const e=this.split(/[ _-]/);return e.length>1?e[0][0]+e[1][0]:this[0]+this[1]},String.isString=function(e){return"string"==typeof e},String.prototype.splitLast=function(e){let t,i=this.valueOf();const n=this.lastIndexOf(e);return-1!=n&&(i=this.slice(0,n),t=this.slice(n+e.length)),[i,t]},String.sort=function(e,t){return e<t?-1:e>t?1:0}},830:()=>{var e;const t=(e=(e,t)=>{const i=t[0]-e[0],n=t[1]-e[1];return{length:Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),angle:Math.atan2(n,i)}},.2,i=(t,i,n,s)=>{const r=e(i||t,n||t),o=r.angle+(s?Math.PI:0),a=.2*r.length;return[t[0]+Math.cos(o)*a,t[1]+Math.sin(o)*a]},(e,t,n)=>{const[s,r]=i(n[t-1],n[t-2],e),[o,a]=i(e,n[t-1],n[t+1],!0);return`C ${s},${r} ${o},${a} ${e[0]},${e[1]}`});var i;const n={width:400,marginX:10,marginY:15,maxLinesY:10},s={create(e,i,s,r={...n}){r.height||(r.height=3*r.width/4);const{width:o,height:a,marginX:l,marginY:c}=r,h=o-2*l-16,d=a-2*c-22,u=l+16,p=c;let m,g;const f=i.map((e=>e.min())),v=i.map((e=>e.max()));m=f.min(),g=v.max();let y=g-m;const b=[1,2,5,10,25,50,100,200,500,1e3];let w=0;for(;10*b[w]<y;++w);y/b[w]>10&&w++;const k=b[w];g+=k-g%k,m-=m%k;const x=function(e,t,i,n,s,r){const o=i-t,a=r/o,l=Math.ceil(o/n)+1,c=[],h=e.length,d=Math.floor(s/h);for(let t=0,i=0;i<e.length;++i,t+=d)c.push({x1:t,x2:t,y1:0,y2:r});for(let e=t,i=0;i<l;e+=n,++i){const e=r-i*n*a;c.push({x1:0,x2:s,y1:e,y2:e})}return console.debug("GRID points:",c),c}(e,m,g,k,h,d);x.map((e=>(e.x1+=u,e.x2+=u,e.y1+=p,e.y2+=p)));const _=i.map((t=>function(e,t,i,n,s,r){const o=e.length,a=s,l=Math.floor(a/o),c=r,h=r/(n-i),d=[];let u;console.debug("Values:",i,n);for(let n=0,s=0;s<e.length;++s,n+=l)u=c-(t[s]-i)*h,d.push([n,u]);return d}(e,t,m,g,h,d)));_.map((e=>e.map((e=>(e[0]+=u,e[1]+=p))))),_.map((e=>e.path=((e,t)=>e.reduce(((e,i,n,s)=>0===n?`M ${i[0]},${i[1]}`:`${e} ${t(i,n,s)}`),""))(e,t)));const C=[];for(let e=m;e<=g;e+=k)C.push(e);const E=d/(C.length-1),S={width:o,height:a,labels:e,series:i,grid:x,points:_,values:C,labelX:{start:u,step:h/e.length,Y:a-22},labelY:{start:a-22-p,step:-E,X:-16}};return dom.renderTemplate(s,S)},render(e,t,i){const n=(new Date).getDay(),s=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].rotate(n);return this.create(s,t,"weekly-chart").innerHTML}};window.chart=s},489:()=>{function e(e){return!!e.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)}function t(e){return!!e.match(/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/)}function i(i){return e(i)||t(i)}window.validate={host:function(e){return function(e){return!!e.match(/^[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9](?:\.[a-zA-Z]{2,})+$/)}(e)||i(e)},domain:function(e){return/^((?:(?:(?:\w[\.\-\+]?)*)\w)+)((?:(?:(?:\w[\.\-\+]?){0,62})\w)+)\.(\w{2,6})$/.test(e)},ipv4:e,ipv6:t,ip:i,url:function(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)},email:function(e){return/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e.toLowerCase())},tags:function(e){return/^[a-z]{3,}( [a-z]{3,}){0,4}$/.test(e)},slug:function(e){return/^[a-z][0-9a-z]{3,11}$/.test(e)}}},753:()=>{CodeMirror.commands.tabAndIndentMarkdownList=function(e){var t=e.listSelections()[0].head;if(!1!==e.getStateAfter(t.line).list)e.execCommand("indentMore");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var i=Array(e.options.tabSize+1).join(" ");e.replaceSelection(i)}},CodeMirror.commands.shiftTabAndUnindentMarkdownList=function(e){var t=e.listSelections()[0].head;if(!1!==e.getStateAfter(t.line).list)e.execCommand("indentLess");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var i=Array(e.options.tabSize+1).join(" ");e.replaceSelection(i)}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AppBase:()=>wd});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{Lexer:()=>P,Parser:()=>B,Renderer:()=>M,Slugger:()=>$,TextRenderer:()=>R,Tokenizer:()=>L,defaults:()=>s,getDefaults:()=>n,lexer:()=>X,marked:()=>N,options:()=>F,parse:()=>W,parseInline:()=>V,parser:()=>Y,setOptions:()=>q,use:()=>H,walkTokens:()=>U});var i={};function n(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1,externalLinks:!1}}__webpack_require__.r(i),__webpack_require__.d(i,{render:()=>ee,renderContainer:()=>te,renderHtml:()=>J,renderText:()=>Z}),__webpack_require__(278),__webpack_require__(345),__webpack_require__(788),__webpack_require__(265),__webpack_require__(537);let s={baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1,externalLinks:!1};const r=/[&<>"']/,o=/[&<>"']/g,a=/[<>"']|&(?!#?\w+;)/,l=/[<>"']|&(?!#?\w+;)/g,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},h=e=>c[e];function d(e,t){if(t){if(r.test(e))return e.replace(o,h)}else if(a.test(e))return e.replace(l,h);return e}const u=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function p(e){return e.replace(u,((e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const m=/(^|[^\[])\^/g;function g(e,t){e="string"==typeof e?e:e.source,t=t||"";const i={replace:(t,n)=>(n=(n=n.source||n).replace(m,"$1"),e=e.replace(t,n),i),getRegex:()=>new RegExp(e,t)};return i}const f=/[^\w:]/g,v=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function y(e,t,i){if(e){let e;try{e=decodeURIComponent(p(i)).replace(f,"").toLowerCase()}catch(e){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!v.test(i)&&(i=function(e,t){b[" "+e]||(w.test(e)?b[" "+e]=e+"/":b[" "+e]=S(e,"/",!0));const i=-1===(e=b[" "+e]).indexOf(":");return"//"===t.substring(0,2)?i?t:e.replace(k,"$1")+t:"/"===t.charAt(0)?i?t:e.replace(x,"$1")+t:e+t}(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch(e){return null}return i}const b={},w=/^[^:]+:\/*[^/]*$/,k=/^([^:]+:)[\s\S]*$/,x=/^([^:]+:\/*[^/]*)[\s\S]*$/,_={exec:function(){}};function C(e){let t,i,n=1;for(;n<arguments.length;n++)for(i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}function E(e,t){const i=e.replace(/\|/g,((e,t,i)=>{let n=!1,s=t;for(;--s>=0&&"\\"===i[s];)n=!n;return n?"|":" |"})).split(/ \|/);let n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function S(e,t,i){const n=e.length;if(0===n)return"";let s=0;for(;s<n;){const r=e.charAt(n-s-1);if(r!==t||i){if(r===t||!i)break;s++}else s++}return e.slice(0,n-s)}function A(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function T(e,t){if(t<1)return"";let i="";for(;t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e}function j(e,t,i,n){const s=t.href,r=t.title?d(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){n.state.inLink=!0;const e={type:"link",raw:i,href:s,title:r,text:o,tokens:n.inlineTokens(o,[])};return n.state.inLink=!1,e}return{type:"image",raw:i,href:s,title:r,text:d(o)}}class L{constructor(e){this.options=e||s}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:S(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],i=function(e,t){const i=e.match(/^(\s+)(?:```)/);if(null===i)return t;const n=i[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[i]=t;return i.length>=n.length?e.slice(n.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim():t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=S(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}const i={type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=t[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(e,[]),text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i,n,s,r,o,a,l,c,h,d,u,p,m=t[1].trim();const g=m.length>1,f={type:"list",raw:"",ordered:g,start:g?+m.slice(0,-1):"",loose:!1,items:[]};m=g?`\\d{1,9}\\${m.slice(-1)}`:`\\${m}`,this.options.pedantic&&(m=g?m:"[*+-]");const v=new RegExp(`^( {0,3}${m})((?:[\t ][^\\n]*)?(?:\\n|$))`);for(;e&&(p=!1,t=v.exec(e))&&!this.rules.block.hr.test(e);){if(i=t[0],e=e.substring(i.length),c=t[2].split("\n",1)[0],h=e.split("\n",1)[0],this.options.pedantic?(r=2,u=c.trimLeft()):(r=t[2].search(/[^ ]/),r=r>4?1:r,u=c.slice(r),r+=t[1].length),a=!1,!c&&/^ *$/.test(h)&&(i+=h+"\n",e=e.substring(h.length+1),p=!0),!p){const t=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))`),n=new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);for(;e&&(d=e.split("\n",1)[0],c=d,this.options.pedantic&&(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!t.test(c))&&!n.test(e);){if(c.search(/[^ ]/)>=r||!c.trim())u+="\n"+c.slice(r);else{if(a)break;u+="\n"+c}a||c.trim()||(a=!0),i+=d+"\n",e=e.substring(d.length+1)}}f.loose||(l?f.loose=!0:/\n *\n *$/.test(i)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(u),n&&(s="[ ] "!==n[0],u=u.replace(/^\[[ xX]\] +/,""))),f.items.push({type:"list_item",raw:i,task:!!n,checked:s,loose:!1,text:u}),f.raw+=i}f.items[f.items.length-1].raw=i.trimRight(),f.items[f.items.length-1].text=u.trimRight(),f.raw=f.raw.trimRight();const y=f.items.length;for(o=0;o<y;o++){this.lexer.state.top=!1,f.items[o].tokens=this.lexer.blockTokens(f.items[o].text,[]);const e=f.items[o].tokens.filter((e=>"space"===e.type)),t=e.every((e=>{const t=e.raw.split("");let i=0;for(const e of t)if("\n"===e&&(i+=1),i>1)return!0;return!1}));!f.loose&&e.length&&t&&(f.loose=!0,f.items[o].loose=!0)}return f}}html(e){const t=this.rules.block.html.exec(e);if(t){const e={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};return this.options.sanitize&&(e.type="paragraph",e.text=this.options.sanitizer?this.options.sanitizer(t[0]):d(t[0]),e.tokens=[],this.lexer.inline(e.text,e.tokens)),e}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const e={type:"table",header:E(t[1]).map((e=>({text:e}))),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let i,n,s,r,o=e.align.length;for(i=0;i<o;i++)/^ *-+: *$/.test(e.align[i])?e.align[i]="right":/^ *:-+: *$/.test(e.align[i])?e.align[i]="center":/^ *:-+ *$/.test(e.align[i])?e.align[i]="left":e.align[i]=null;for(o=e.rows.length,i=0;i<o;i++)e.rows[i]=E(e.rows[i],e.header.length).map((e=>({text:e})));for(o=e.header.length,n=0;n<o;n++)e.header[n].tokens=[],this.lexer.inline(e.header[n].text,e.header[n].tokens);for(o=e.rows.length,n=0;n<o;n++)for(r=e.rows[n],s=0;s<r.length;s++)r[s].tokens=[],this.lexer.inline(r[s].text,r[s].tokens);return e}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const e={type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e={type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}text(e){const t=this.rules.block.text.exec(e);if(t){const e={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:d(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):d(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=S(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;const i=e.length;let n=0,s=0;for(;s<i;s++)if("\\"===e[s])s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return-1}(t[2],"()");if(e>-1){const i=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let i=t[2],n="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);e&&(i=e[1],n=e[3])}else n=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(i=this.options.pedantic&&!/>$/.test(e)?i.slice(1):i.slice(1,-1)),j(t,{href:i?i.replace(this.rules.inline._escapes,"$1"):i,title:n?n.replace(this.rules.inline._escapes,"$1"):n},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){let e=(i[2]||i[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e||!e.href){const e=i[0].charAt(0);return{type:"text",raw:e,text:e}}return j(i,e,i[0],this.lexer)}}emStrong(e,t,i=""){let n=this.rules.inline.emStrong.lDelim.exec(e);if(!n)return;if(n[3]&&i.match(/[\p{L}\p{N}]/u))return;const s=n[1]||n[2]||"";if(!s||s&&(""===i||this.rules.inline.punctuation.exec(i))){const i=n[0].length-1;let s,r,o=i,a=0;const l="*"===n[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+i);null!=(n=l.exec(t));){if(s=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!s)continue;if(r=s.length,n[3]||n[4]){o+=r;continue}if((n[5]||n[6])&&i%3&&!((i+r)%3)){a+=r;continue}if(o-=r,o>0)continue;if(r=Math.min(r,r+o+a),Math.min(i,r)%2){const t=e.slice(1,i+n.index+r);return{type:"em",raw:e.slice(0,i+n.index+r+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}const t=e.slice(2,i+n.index+r-1);return{type:"strong",raw:e.slice(0,i+n.index+r+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const i=/[^ ]/.test(e),n=/^ /.test(e)&&/ $/.test(e);return i&&n&&(e=e.substring(1,e.length-1)),e=d(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const i=this.rules.inline.autolink.exec(e);if(i){let e,n;return"@"===i[2]?(e=d(this.options.mangle?t(i[1]):i[1]),n="mailto:"+e):(e=d(i[1]),n=e),{type:"link",raw:i[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let i;if(i=this.rules.inline.url.exec(e)){let e,n;if("@"===i[2])e=d(this.options.mangle?t(i[0]):i[0]),n="mailto:"+e;else{let t;do{t=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0]}while(t!==i[0]);e=d(i[0]),n="www."===i[1]?"http://"+e:e}return{type:"link",raw:i[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t){const i=this.rules.inline.text.exec(e);if(i){let e;return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):d(i[0]):i[0]:d(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:e}}}}const D={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:_,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};D.def=g(D.def).replace("label",D._label).replace("title",D._title).getRegex(),D.bullet=/(?:[*+-]|\d{1,9}[.)])/,D.listItemStart=g(/^( *)(bull) */).replace("bull",D.bullet).getRegex(),D.list=g(D.list).replace(/bull/g,D.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+D.def.source+")").getRegex(),D._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",D._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,D.html=g(D.html,"i").replace("comment",D._comment).replace("tag",D._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),D.paragraph=g(D._paragraph).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex(),D.blockquote=g(D.blockquote).replace("paragraph",D.paragraph).getRegex(),D.normal=C({},D),D.gfm=C({},D.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),D.gfm.table=g(D.gfm.table).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex(),D.gfm.paragraph=g(D._paragraph).replace("hr",D.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",D.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",D._tag).getRegex(),D.pedantic=C({},D.normal,{html:g("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",D._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:_,paragraph:g(D.normal._paragraph).replace("hr",D.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",D.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const O={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:_,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:_,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function I(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function z(e){let t,i,n="";const s=e.length;for(t=0;t<s;t++)i=e.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),n+="&#"+i+";";return n}O._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",O.punctuation=g(O.punctuation).replace(/punctuation/g,O._punctuation).getRegex(),O.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,O.escapedEmSt=/\\\*|\\_/g,O._comment=g(D._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),O.emStrong.lDelim=g(O.emStrong.lDelim).replace(/punct/g,O._punctuation).getRegex(),O.emStrong.rDelimAst=g(O.emStrong.rDelimAst,"g").replace(/punct/g,O._punctuation).getRegex(),O.emStrong.rDelimUnd=g(O.emStrong.rDelimUnd,"g").replace(/punct/g,O._punctuation).getRegex(),O._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,O._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,O._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,O.autolink=g(O.autolink).replace("scheme",O._scheme).replace("email",O._email).getRegex(),O._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,O.tag=g(O.tag).replace("comment",O._comment).replace("attribute",O._attribute).getRegex(),O._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,O._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,O._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,O.link=g(O.link).replace("label",O._label).replace("href",O._href).replace("title",O._title).getRegex(),O.reflink=g(O.reflink).replace("label",O._label).replace("ref",D._label).getRegex(),O.nolink=g(O.nolink).replace("ref",D._label).getRegex(),O.reflinkSearch=g(O.reflinkSearch,"g").replace("reflink",O.reflink).replace("nolink",O.nolink).getRegex(),O.normal=C({},O),O.pedantic=C({},O.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:g(/^!?\[(label)\]\((.*?)\)/).replace("label",O._label).getRegex(),reflink:g(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",O._label).getRegex()}),O.gfm=C({},O.normal,{escape:g(O.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),O.gfm.url=g(O.gfm.url,"i").replace("email",O.gfm._extended_email).getRegex(),O.breaks=C({},O.gfm,{br:g(O.br).replace("{2,}","*").getRegex(),text:g(O.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});class P{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||s,this.options.tokenizer=this.options.tokenizer||new L,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:D.normal,inline:O.normal};this.options.pedantic?(t.block=D.pedantic,t.inline=O.pedantic):this.options.gfm&&(t.block=D.gfm,this.options.breaks?t.inline=O.breaks:t.inline=O.gfm),this.tokenizer.rules=t}static get rules(){return{block:D,inline:O}}static lex(e,t){return new P(t).lex(e)}static lexInline(e,t){return new P(t).inlineTokens(e)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let i,n,s,r;for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,((e,t,i)=>t+"    ".repeat(i.length)));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((n=>!!(i=n.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))))if(i=this.tokenizer.space(e))e=e.substring(i.raw.length),1===i.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(i);else if(i=this.tokenizer.code(e))e=e.substring(i.raw.length),n=t[t.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?t.push(i):(n.raw+="\n"+i.raw,n.text+="\n"+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(i=this.tokenizer.fences(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.heading(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.hr(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.blockquote(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.list(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.html(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.def(e))e=e.substring(i.raw.length),n=t[t.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title}):(n.raw+="\n"+i.raw,n.text+="\n"+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(i=this.tokenizer.table(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.lheading(e))e=e.substring(i.raw.length),t.push(i);else{if(s=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const i=e.slice(1);let n;this.options.extensions.startBlock.forEach((function(e){n=e.call({lexer:this},i),"number"==typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(s=e.substring(0,t+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s)))n=t[t.length-1],r&&"paragraph"===n.type?(n.raw+="\n"+i.raw,n.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i),r=s.length!==e.length,e=e.substring(i.raw.length);else if(i=this.tokenizer.text(e))e=e.substring(i.raw.length),n=t[t.length-1],n&&"text"===n.type?(n.raw+="\n"+i.raw,n.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let i,n,s,r,o,a,l=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,r.index)+"["+T("a",r[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,r.index)+"["+T("a",r[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.escapedEmSt.exec(l));)l=l.slice(0,r.index)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(o||(a=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((n=>!!(i=n.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))))if(i=this.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.tag(e))e=e.substring(i.raw.length),n=t[t.length-1],n&&"text"===i.type&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(i=this.tokenizer.link(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(i.raw.length),n=t[t.length-1],n&&"text"===i.type&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(i=this.tokenizer.emStrong(e,l,a))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.del(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.autolink(e,z))e=e.substring(i.raw.length),t.push(i);else if(this.state.inLink||!(i=this.tokenizer.url(e,z))){if(s=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const i=e.slice(1);let n;this.options.extensions.startInline.forEach((function(e){n=e.call({lexer:this},i),"number"==typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(s=e.substring(0,t+1))}if(i=this.tokenizer.inlineText(s,I))e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(a=i.raw.slice(-1)),o=!0,n=t[t.length-1],n&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(i.raw.length),t.push(i);return t}}class M{constructor(e){this.options=e||s}code(e,t,i){const n=(t||"").match(/\S*/)[0];if(this.options.highlight){const t=this.options.highlight(e,n);null!=t&&t!==e&&(i=!0,e=t)}e=e.replace(/\n$/,"")+"\n";let s="";return s&&(s=` class="${this.options.langPrefix+d(n,!0)}"`),`<pre class="relative noevents"><code${s}>`+(i?e:d(e,!0))+'</code><button class="icon fa xs copy top-right display-hover" title="Copy" cmd="copy-code"></button></pre>\n'}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e){return e}heading(e,t,i,n){return this.options.headerIds?`<h${t} id="${this.options.headerPrefix+n.slug(i)}">${e}</h${t}>\n`:`<h${t}>${e}</h${t}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,i){const n=t?"ol":"ul";return"<"+n+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+n+">\n"}listitem(e){return`<li>${e}</li>\n`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e,t){return t?`<p class="image">${e}</p>\n`:`<p>${e}</p>\n`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return`<tr>\n${e}</tr>\n`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?`<${i} align="${t.align}">`:`<${i}>`)+e+`</${i}>\n`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,i){if(null===(e=y(this.options.sanitize,this.options.baseUrl,e)))return i;let n;return e.startsWith("#")?n='<a class="internal" link="'+e+'"':(n='<a href="'+d(e)+'"',this.options.externalLinks&&(n+=' target="_blank"')),t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>",n}image(e,t,i){if(null===(e=y(this.options.sanitize,this.options.baseUrl,e)))return i;let n=`<img src="${e}" alt="${i}"`;return t&&(n+=` title="${t}"`),n+=this.options.xhtml?"/>":">",n}text(e){return e}}class R{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}}class ${constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do{n++,i=e+"-"+n}while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=n,this.seen[i]=0),i}slug(e,t={}){const i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)}}class B{constructor(e){this.options=e||s,this.options.renderer=this.options.renderer||new M,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new R,this.slugger=new $}static parse(e,t){return new B(t).parse(e)}static parseInline(e,t){return new B(t).parseInline(e)}parse(e,t=!0){let i,n,s,r,o,a,l,c,h,d,u,m,g,f,v,y,b,w,k,x="";const _=e.length;for(i=0;i<_;i++)if(d=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[d.type]&&(k=this.options.extensions.renderers[d.type].call({parser:this},d),!1!==k||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type)))x+=k||"";else switch(d.type){case"space":continue;case"hr":x+=this.renderer.hr();continue;case"heading":x+=this.renderer.heading(this.parseInline(d.tokens),d.depth,p(this.parseInline(d.tokens,this.textRenderer)),this.slugger);continue;case"code":x+=this.renderer.code(d.text,d.lang,d.escaped);continue;case"table":for(c="",l="",r=d.header.length,n=0;n<r;n++)l+=this.renderer.tablecell(this.parseInline(d.header[n].tokens),{header:!0,align:d.align[n]});for(c+=this.renderer.tablerow(l),h="",r=d.rows.length,n=0;n<r;n++){for(a=d.rows[n],l="",o=a.length,s=0;s<o;s++)l+=this.renderer.tablecell(this.parseInline(a[s].tokens),{header:!1,align:d.align[s]});h+=this.renderer.tablerow(l)}x+=this.renderer.table(c,h);continue;case"blockquote":h=this.parse(d.tokens),x+=this.renderer.blockquote(h);continue;case"list":for(u=d.ordered,m=d.start,g=d.loose,r=d.items.length,h="",n=0;n<r;n++)v=d.items[n],y=v.checked,b=v.task,f="",v.task&&(w=this.renderer.checkbox(y),g?v.tokens.length>0&&"paragraph"===v.tokens[0].type?(v.tokens[0].text=w+" "+v.tokens[0].text,v.tokens[0].tokens&&v.tokens[0].tokens.length>0&&"text"===v.tokens[0].tokens[0].type&&(v.tokens[0].tokens[0].text=w+" "+v.tokens[0].tokens[0].text)):v.tokens.unshift({type:"text",text:w}):f+=w),f+=this.parse(v.tokens,g),h+=this.renderer.listitem(f,b,y);x+=this.renderer.list(h,u,m);continue;case"html":x+=this.renderer.html(d.text);continue;case"paragraph":{const e=d.tokens,t=1==e.length&&"image"==e[0].type;x+=this.renderer.paragraph(this.parseInline(e),t);continue}case"text":for(h=d.tokens?this.parseInline(d.tokens):d.text;i+1<_&&"text"===e[i+1].type;)d=e[++i],h+="\n"+(d.tokens?this.parseInline(d.tokens):d.text);x+=t?this.renderer.paragraph(h):h;continue;default:{const e='Token with "'+d.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return x}parseInline(e,t){t=t||this.renderer;let i,n,s,r="";const o=e.length;for(i=0;i<o;i++)if(n=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]&&(s=this.options.extensions.renderers[n.type].call({parser:this},n),!1!==s||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)))r+=s||"";else switch(n.type){case"escape":case"text":r+=t.text(n.text);break;case"html":r+=t.html(n.text);break;case"link":r+=t.link(n.href,n.title,this.parseInline(n.tokens,t));break;case"image":r+=t.image(n.href,n.title,n.text);break;case"strong":r+=t.strong(this.parseInline(n.tokens,t));break;case"em":r+=t.em(this.parseInline(n.tokens,t));break;case"codespan":r+=t.codespan(n.text);break;case"br":r+=t.br();break;case"del":r+=t.del(this.parseInline(n.tokens,t));break;default:{const e='Token with "'+n.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return r}}function N(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(i=t,t=null),A(t=C({},N.defaults,t||{})),i){const n=t.highlight;let s;try{s=P.lex(e,t)}catch(e){return i(e)}const r=function(e){let r;if(!e)try{t.walkTokens&&N.walkTokens(s,t.walkTokens),r=B.parse(s,t)}catch(t){e=t}return t.highlight=n,e?i(e):i(null,r)};if(!n||n.length<3)return r();if(delete t.highlight,!s.length)return r();let o=0;return N.walkTokens(s,(function(e){"code"===e.type&&(o++,setTimeout((()=>{n(e.text,e.lang,(function(t,i){if(t)return r(t);null!=i&&i!==e.text&&(e.text=i,e.escaped=!0),o--,0===o&&r()}))}),0))})),void(0===o&&r())}try{const i=P.lex(e,t);return t.walkTokens&&N.walkTokens(i,t.walkTokens),B.parse(i,t).replace(/(\$fa-[a-z0-9-]+)(;[a-z]+)?/g,((e,t,i)=>`<i class="fa ${t.slice(1)}" style="color:${i?i.slice(1):"inherit"}"></i>`))}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+d(e.message+"",!0)+"</pre>";throw e}}N.options=N.setOptions=function(e){var t;return C(N.defaults,e),t=N.defaults,s=t,N},N.getDefaults=n,N.defaults=s,N.use=function(...e){const t=C({},...e),i=N.defaults.extensions||{renderers:{},childTokens:{}};let n;e.forEach((e=>{if(e.extensions&&(n=!0,e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if(e.renderer){const t=i.renderers?i.renderers[e.name]:null;i.renderers[e.name]=t?function(...i){let n=e.renderer.apply(this,i);return!1===n&&(n=t.apply(this,i)),n}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");i[e.level]?i[e.level].unshift(e.tokenizer):i[e.level]=[e.tokenizer],e.start&&("block"===e.level?i.startBlock?i.startBlock.push(e.start):i.startBlock=[e.start]:"inline"===e.level&&(i.startInline?i.startInline.push(e.start):i.startInline=[e.start]))}e.childTokens&&(i.childTokens[e.name]=e.childTokens)}))),e.renderer){const i=N.defaults.renderer||new M;for(const t in e.renderer){const n=i[t];i[t]=(...s)=>{let r=e.renderer[t].apply(i,s);return!1===r&&(r=n.apply(i,s)),r}}t.renderer=i}if(e.tokenizer){const i=N.defaults.tokenizer||new L;for(const t in e.tokenizer){const n=i[t];i[t]=(...s)=>{let r=e.tokenizer[t].apply(i,s);return!1===r&&(r=n.apply(i,s)),r}}t.tokenizer=i}if(e.walkTokens){const i=N.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens.call(this,t),i&&i.call(this,t)}}n&&(t.extensions=i),N.setOptions(t)}))},N.walkTokens=function(e,t){for(const i of e)switch(t.call(N,i),i.type){case"table":for(const e of i.header)N.walkTokens(e.tokens,t);for(const e of i.rows)for(const i of e)N.walkTokens(i.tokens,t);break;case"list":N.walkTokens(i.items,t);break;default:N.defaults.extensions&&N.defaults.extensions.childTokens&&N.defaults.extensions.childTokens[i.type]?N.defaults.extensions.childTokens[i.type].forEach((function(e){N.walkTokens(i[e],t)})):i.tokens&&N.walkTokens(i.tokens,t)}},N.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");A(t=C({},N.defaults,t||{}));try{const i=P.lexInline(e,t);return t.walkTokens&&N.walkTokens(i,t.walkTokens),B.parseInline(i,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+d(e.message+"",!0)+"</pre>";throw e}},N.Parser=B,N.parser=B.parse,N.Renderer=M,N.TextRenderer=R,N.Lexer=P,N.lexer=P.lex,N.Tokenizer=L,N.Slugger=$,N.parse=N;const F=N.options,q=N.setOptions,H=N.use,U=N.walkTokens,V=N.parseInline,W=N,Y=B.parse,X=P.lex;function Z(e,t,...i){const n=(e=e.trim()).matchAll(/@(if|else|endif|foreach|endforeach)(\{\{(.*?)\}\}(\[(.*?)\])?)?/g),s=[];let r,o,a,l=0,c=s;s.start=0;for(const t of n)switch(t[1]){case"if":case"foreach":o=e.slice(c.start,t.index).trim(),o&&c.push(o),a=[],a.type=t[1],a.exp=t[3],a.parent=c,a.start=t.index+t[0].length,a.caps=t[5]?t[5].split(","):[],c.push(a),c=a;break;case"endif":case"endforeach":r=t.index+t[0].length,o=e.slice(c.start,t.index).trim(),o&&c.push(o),c=c.parent,c.start=r,l=r;break;case"else":{r=t.index+t[0].length,o=e.slice(c.start,t.index).trim(),o&&c.push(o);const i=[];i.parent=c.parent,i.start=t.index+t[0].length,c._else=i,c=i}}return s.push(e.slice(l,e.length).trim()),K(s,t,...i).replaceAll(/>\s+</g,"><")}function K(e,t,...i){if(!e)return"";let n="";for(const s of e)if("string"==typeof s)n+=G(s,t,...i).replacex(t,...i);else switch(s.type){case"if":n+=K(s.exp.evalx(t,...i)?s:s._else,t,...i);break;case"foreach":{const e=s.caps.map((e=>/_[0-9]/.test(e)?i[parseInt(e.slice(1))]:t[e]));let r=s.exp.evalx(t,...i)||[];Array.isArray(r)||(r=[r]);for(const t of r)n+=K(s,t,r.length,...e)}}return n}function G(e,t,...i){return e.replace(/\[\[(.*?)\]\](\{\{(.*?)\}\})?/g,((e,n,s,r)=>{const[o,a,...l]=n.split(","),c=/^_\d$/;let h=c.test(o)?i[parseInt(o.slice(1))]:o,d=[];if(Array.isArray(h)&&(d=h,h=d.shift()),!h)return"";h=h.replacex(t,...i);for(const e of l)c.test(e)?d.push(i[parseInt(e.slice(1))]):d.push(e.replacex(t,...i));let u=t;r&&(u=r.evalx(t,...i));const[p,m,g]=Q(h,u,...d),f=Z(p,u,...d);let v="div",y=[];return a&&([v,...y]=a.split(" "),m.push(...y)),`<${v}${m.length>0?' class="'+m.join(" ")+'"':""} ${Object.entries(g).map((([e,i])=>`${e}="${i.replacex(t)}"`)).join(" ")}>${f}</${v}>`}))}function J(e,t,i="div",n=[],...s){const r=Z(e,t,...s),[o,...a]=i.split(" "),l=document.createElement(o);return l.classList.add(...n,...a),l.innerHTML=r,l}function Q(e,t={},...i){const n=document.getElementById(e);n||console.error("Failed to load template",e);let s=n.innerHTML;s=s.replace(/(?=<!--)([\s\S]*?)-->/gs,"").replace(/[\n\t]/,"");let r=n.getAttribute("classes")||"";r&&(r=r.replacex(t,...i));const o=r?r.split(" ").filter((e=>e)):[],a={"&gt;":">","&lt;":"<","&amp;":"&"};for(const[e,t]of Object.entries(a))s=s.replaceAll(e,t);const l={};for(const e of n.attributes){let n=e.name;if(!["id","classes"].includes(n))if(n.startsWith("_a-")){n=n.slice(3);const i=e.value.replacex(t);i&&(l[n]=i)}else l[n]=e.value.replacex(t,...i)}return[s,o,l]}function ee(e,t={},i="div",...n){const[s,r,o]=Q(e,t,...n);let a;try{a=J(s,t,i,r,...n);for(const[e,t]of Object.entries(o))a.setAttribute(e,t)}catch(i){throw console.groupCollapsed("Failed to render template",e),console.debug(t),console.debug(s),console.groupEnd(),i}return a}function te(e,t,i,n,...s){const[r,o]=Q(t,i);i=Array.isArray(i)?i:[i];for(const r of i){const r=J(t,i,n,o,...s);e.appendChild(r)}}const ie="highlight";function ne(e,t){t.parentNode.insertBefore(e,t.nextElementSibling)}function se(e,t){t.parentNode.insertBefore(e,t)}function re(e,...t){const i=document.createElement(e);return function(e,...t){const i=t.shift();i&&(Array.isArray(i)?e.classList.add(...i):e.classList.add(...i.split(" ")),t.length>0&&e.classList.add(...t))}(i,...t),i}function oe(e,t){const i={headerIds:!1,breaks:!0,externalLinks:!0};t&&Object.assign(i,t);const n=e.trim();return W(n,i)}function ae(e){const t={":)":"🙂",":')":"😃",':")':"😀",":p":"😋",":'p":"😛",':"p':"😝",":P":"😛",":'P":"😛",':"P':"😝",":d":"😀",":'d":"😄",':"d':"😆",":D":"😄",":'D":"😅",':"D':"😂",":k":"😗",":'k":"😙",':"k':"😚",":s":"💯",":X":"💣",":t":"👍",":b":"🍺",":B":"🍻",":w":"✋",":(":"😧",":'(":"😥",':"(':"😭",":o":"😯",":'o":"😲",':"o':"😵",":8":"😎",";)":"😉"},i={family:"👪️",zzz:"💤",newspaper:"📰",books:"📚️",up:"👍️",usd:"💲",card:"💳️",money:"💰️",cash:"💸",tm:"™️",boom:"💥",eye:"👁️",eyes:"👀",glasses:"👓️",dizzy:"💫",santa:"🎅",bird:"🐦️",dragon:"🐉",fox:"🦊",horse:"🐎",linux:"🐧",mushroom:"🍄",octopus:"🐙",ox:"🐂",shark:"🦈",snake:"🐍",tiger:"🐅",whale:"🐋",sunflower:"🌻",tree:"🌳",ok:"🆗",wc:"🚾",wtf:"⁉",new:"🆕",free:"🆓",cool:"🆒",cancer:"♋️",gemini:"♊️",taurus:"♉️",libra:"♎️",hamburger:"🍔",honeypot:"🍯",pizza:"🍕",strawberry:"🍓",beer:"🍺",cheers:"🍻",cocktail:"🍸️",coffee:"☕️",drink:"🍹",wine:"🍷",bg:"🇧🇬",de:"🇩🇪",es:"🇪🇸",fr:"🇫🇷",gb:"🇬🇧",gr:"🇬🇷",us:"🇺🇸",congratulations:"㊗️",cannabis:'<i class="fa fa-cannabis w3-text-green"></i>',joint:'<i class="fa fa-joint"></i>',facebook:'<i class="fa fa-facebook w3-text-blue"></i>',feather:'<i class="fa fa-feather w3-text-indigo"></i>'};return e.replaceAll(/\:([A-z]+)\:/g,((e,t)=>i[t.toLowerCase()]||e)).replaceAll(/([:;]['"]?[)(pPdDksXtbBwo8])/g,((e,i)=>t[i]||e)).replaceAll(/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])|(\p{Emoji_Presentation})/gu,(e=>`<i class="em">${e}</i>`))}function le(e,t=1024){let i;if(i="number"==typeof e?e:(Array.isArray(e)?e:Object.values(e)).reduce(((e,t)=>e+t),0),i<t)return i;const n=t**2;return(i<n?`${(i/t).toFixed(1)}K`:`${(i/n).toFixed(1)}M`).replace(".0","")}window.dom={createFa:(...e)=>re("i","fa",...e),createFaButton:function(e,...t){return re("button","icon","fa","fa-fw",e,...t)},highlightElement:function(e,t=1800){e.classList.remove(ie),e.classList.add(ie)},isNode:function(e){return"object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},isElement:function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},isElementVisible:e=>e.getBoundingClientRect().height>0,removeChilds:function(e){for(;e.lastElementChild;)e.removeChild(e.lastElementChild)},removeElement:function(e){return e&&e.parentElement&&e.parentElement.removeChild(e),e},insertAfter:ne,insertBefore:se,insertTop:function(e,t){t.insertBefore(e,t.firstElementChild)},createElement:re,createElementFromMarkdown:function(e,t=!0){const i=dom.createElement("span","md","compact","r2","nomargin","noevents","text-expand");i.setAttribute("expandable","");const n=oe(e);return i.innerHTML=t?ae(n):n,i},showElement:function(e,t=!0){t?e.classList.remove("hidden"):e.classList.add("hidden")},hideElement:function(e){e.classList.add("hidden")},toggleShow:function(e){return e.classList.toggle("hidden")},isHidden:function(e){return e.classList.contains("hidden")},moveTop:function(e,t,i){t&&(e=e.querySelector(`[${t}="${i}"]`));const n=e.parentElement;return n.insertBefore(e,n.firstElementChild),e},moveAfterTop:function(e){ne(e,e.parentElement.firstElementChild)},moveUp:function(e){se(e,e.previousElementSibling)},getParent:function(e,t=1){let i=e;for(let e=0;e<t;++e)i=i.parentElement;return i},findVisible:function e(t,i,n=0,s=i.length,r=Math.floor((n+s)/2)){if(n==s)return[];let o=i[r],a=o.getBoundingClientRect();if(a.top>=t.bottom)return e(t,i,n,r);if(a.bottom<=t.top)return e(t,i,r+1,s);const l=[o];for(let e=r-1;e>=0&&(o=i[e],a=o.getBoundingClientRect(),a.bottom>t.top);e--)l.unshift(o);for(let e=r+1;e<i.length&&(o=i[e],a=o.getBoundingClientRect(),a.top<t.bottom);++e)l.push(o);return l},isVisible:function(e,t){const i=e.getBoundingClientRect();return!(i.bottom<t.top||i.top>t.bottom)},getValues:function(e,t={},i="[role]"){const n=e.querySelectorAll(i);let s,r;for(const e of n){switch(e.tagName){case"IMG":s=e.src;break;case"A":s=e.href;break;case"TIME":if(e.dateTime){t.ts=new Date(e.dateTime).seconds();break}case"INPUT":case"SELECT":s=e.value;break;default:s=e.innerText}r=e.name||e.getAttribute("role"),s&&(t[r]=s)}return t},updateValues:function(e,t){let i;for(let[n,s]of Object.entries(t))i=e.querySelector(`[role="${n}"]`),i&&("status"==n?i.innerHTML=ae(s):"IMG"===i.tagName?i.src=s:i.innerText=s)},loadScript:function(e){const t=document.createElement("script");return t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t),new Promise(((e,i)=>{t.onload=e,t.onerror=i}))},getData:function(e,t="input"){const i={},n=e.querySelectorAll(t);for(const e of n)e.name&&(i[e.name]=e.value.trim());return i},updateElapsed:function(e,t=Date.now()){const i=e.querySelectorAll("time[data-time]");for(const e of i){const i=e.dataset.time;if(i){const n=new Date(1e3*parseInt(i));e.innerText=n.offsetFrom(t)}}},renderTemplate:ee,renderTemplateHtml:J,renderTemplateContainer:te,template:i,facReplace:function(e,t){const i=e.className.split(" ");for(const t of i)if(/^fac-/.test(t)){e.classList.remove(t);break}e.classList.add(t)},showNextImage:function(e,t=!0){const i=e.querySelectorAll("img");if(!(i.length<2))for(let n=0;n<i.length;++n){const s=i[n];if(!s.classList.contains("hidden")){let r=n+(t?1:-1);r<0?r=i.length-1:r==i.length&&(r=0),dom.hideElement(s),dom.showElement(i[r]);const o=e.querySelector(".number");o&&(o.innerText=`${r+1} / ${i.length}`);break}}},openTab:function(e,t){const i="w3-border-red",n=e.getElementsByClassName("tablink");for(const e of n)e.dataset.id==t?e.classList.add(i):e.classList.remove(i);const s=e.querySelectorAll("div[data-tab]");for(const e of s)e.dataset.tab==t?dom.showElement(e):dom.hideElement(e)},markdown:oe,markdowne:function(e,t){return e?ae(oe(e,t)):""},tomarkdown:function(e){const t=(new DOMParser).parseFromString(e.innerHTML,"text/html");let i="";for(const e of t.body.children)switch(e.nodeName){case"#text":i+=e.textContent;break;case"P":i+=e.innerText;break;case"H6":i+="#";case"H5":i+="#";case"H4":i+="#";case"H3":i+="#";case"H2":i+="#";case"H1":i+="# "+e.innerText}return i},renderEmojis:ae,escapeTags:function(e){return e.replace(/(&nbsp;|<([^>]+)>)/gi,"")},escape:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},toggleLoading:e=>e.classList.toggle("loading3"),icon:function(e,...t){if(!e)return"";const i=t.pop(),n=i?` style="color:${i}"`:"";let[s,r]=/^f[0-9a-f]{3}/.test(e)?[` value="${String.fromCodePoint(parseInt(e,16))}"`,""]:["",` ${e}`];return t.length>0&&(r+=" "+t.join(" ")),`<i class="fa${r}"${s}${n}></i>`},color:function(e){return e?`color:${e}`:""},attr:(e,t)=>t?`${e}="${t}"`:"",length:e=>e?e.length():0,logoFromLink:e=>new URL(e).origin+"/favicon.ico",option(e,...t){let i="";const n=(e,t)=>`<option value="${e}" ${e==t?"selected":""}>${e.capitalizeFirstLetter()}</option>`;e||(e=t[0]);for(let s of t)if("function"==typeof s&&(s=s()),Array.isArray(s))for(let t of s)i+=n(t,e);else i+=n(s,e);return i},radio(e,...t){let i="",n=!0;const s=(t,i)=>{const s=`<div class="cr ci"><input type="radio" name="${e}" value="${t}" ${n?"checked":""}><label class="radio">${t.capitalizeFirstLetter()}</label></div>`;return n=!1,s};for(let e of t)if("function"==typeof e&&(e=e()),Array.isArray(e))for(let t of e)i+=s(t);else i+=s(e);return i},tags:function(e){const t=new Set(["linux","cplusplus","javascript","nodejs","python","docker","kubernetes"]);return e.replaceAll("+","plus").split(" ").map((e=>t.has(e.toLowerCase())?`<i class="${e.toLowerCase()}"></i>`:e)).join(" ")}},__webpack_require__(831),__webpack_require__(489),Object.assign(window,{isPromise:function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},delayResolve:async function(e,t=1200){const i=new Promise(((e,i)=>{setTimeout(e,t)}));return await Promise.all([e,i]),e},sleep:function(e){return new Promise((t=>setTimeout(t,e)))},clamp:function(e,t,i){return e<=t?t:e>=i?i:e},unclamp:function(e,t,i=-t){return e>t||e<i?e:Math.sign(e)*t},size:le,time:function(e){const t=e?new Date(1e3*e):new Date,i=t.getHours(),n=t.getMinutes();return`${i>9?i:"0"+i}:${n>9?n:"0"+n}`},percent:function(e){return`${Math.floor(100*e)}%`},randInt:function(e,t){return Math.floor((t-e)*Math.random())+e},count:e=>le(e,1e3),indexName:function(e,t,i){return"number"==typeof t?e=i?`${i}[${t}].${e}`:`${e}[${t}]`:i&&(e=i+"."+e),e},dataset:function(e,t){return void 0!==t?`data-${e}="${t}"`:""},join:function(...e){let t=e.join("/").replace(/\/+/g,"/");return t.endsWith("/")?t.slice(0,-1):t},relativeUrl:function(e){const t=location.origin;return e.startsWith(t)?e.slice(t.length):e},getSettings:function(e,t={}){let i=localStorage.getItem(e);return i&&(i=JSON.parse(i),Object.assign(t,i),i=t),i}}),__webpack_require__(976),__webpack_require__(910);const ce=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop / Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast  Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Rock/Pop"];function he(e,t,i=0,n){let s=t||e.byteLength-i;const r="undefined"!=typeof Buffer;s<0&&(s+=e.byteLength);const o=[],a=i+s;for(let t=i;t<a;t++){const i=e.getUint8(t);if(0===i)break;o.push(i)}if(r)return Buffer.from(o).toString();const l=o.map((e=>String.fromCharCode(e))).join("");return n?l:decodeURIComponent(escape(l))}function de(e,t,i=0,n){let s=!1,r=t||e.byteLength-i;const o=[],a="undefined"!=typeof Buffer;if(r<0&&(r+=e.byteLength),i+1>e.byteLength)return"";n&&(65534===e.getUint16(i)&&(s=!0),i+=2,r-=2);const l=i+r;for(let t=i;t<l;t+=2){let i=e.getUint16(t,s);if(t<l-1&&0===i&&0===e.getUint16(t+1,s))break;i>=0&&i<=55295||i>=57344&&i<=65535?o.push(i):i>=65536&&i<=1114111&&(i-=65536,o.push(55296+((1047552&i)>>10)),o.push(56320+(1023&i)))}if(a){const e=Buffer.alloc(2*o.length);for(let t=0;t<o.length;t++){const i=o[t];s?e.writeUInt16LE(i,2*t):e.writeUInt16BE(i,2*t)}return e.toString()}return String.fromCharCode.apply(null,new Uint16Array(o))}function ue(e,t=0){return function(e){let t=0,i=2130706432;for(;i;)t>>=1,t|=e&i,i>>=8;return t}(e.getUint32(t))}function pe(e,t=0,i){return i?e.getUint8(t)+(e.getUint8(t+1)<<8)+(e.getUint8(t+2)<<16):e.getUint8(t+2)+(e.getUint8(t+1)<<8)+(e.getUint8(t)<<16)}const me=new Map([["TALB","album"],["TBPM","bpm"],["TCOM","composer"],["TCON","genre"],["TCOP","copyright"],["TDEN","encoding-time"],["TDLY","playlist-delay"],["TDOR","original-release-time"],["TDRC","recording-time"],["TDRL","release-time"],["TDTG","tagging-time"],["TENC","encoder"],["TEXT","writer"],["TFLT","file-type"],["TIPL","involved-people"],["TIT1","content-group"],["TIT2","title"],["TIT3","subtitle"],["TKEY","initial-key"],["TLAN","language"],["TLEN","length"],["TMCL","credits"],["TMED","media-type"],["TMOO","mood"],["TOAL","original-album"],["TOFN","original-filename"],["TOLY","original-writer"],["TOPE","original-artist"],["TOWN","owner"],["TPE1","artist"],["TPE2","band"],["TPE3","conductor"],["TPE4","remixer"],["TPOS","set-part"],["TPRO","produced-notice"],["TPUB","publisher"],["TRCK","track"],["TRSN","radio-name"],["TRSO","radio-owner"],["TSOA","album-sort"],["TSOP","performer-sort"],["TSOT","title-sort"],["TSRC","isrc"],["TSSE","encoder-settings"],["TSST","set-subtitle"],["TYER","year"],["TAL","album"],["TBP","bpm"],["TCM","composer"],["TCO","genre"],["TCR","copyright"],["TDY","playlist-delay"],["TEN","encoder"],["TFT","file-type"],["TKE","initial-key"],["TLA","language"],["TLE","length"],["TMT","media-type"],["TOA","original-artist"],["TOF","original-filename"],["TOL","original-writer"],["TOT","original-album"],["TP1","artist"],["TP2","band"],["TP3","conductor"],["TP4","remixer"],["TPA","set-part"],["TPB","publisher"],["TRC","isrc"],["TRK","track"],["TSS","encoder-settings"],["TT1","content-group"],["TT2","title"],["TT3","subtitle"],["TXT","writer"],["TYE","year"],["WCOM","url-commercial"],["WCOP","url-legal"],["WOAF","url-file"],["WOAR","url-artist"],["WOAS","url-source"],["WORS","url-radio"],["WPAY","url-payment"],["WPUB","url-publisher"],["WAF","url-file"],["WAR","url-artist"],["WAS","url-source"],["WCM","url-commercial"],["WCP","url-copyright"],["WPB","url-publisher"],["COMM","comments"],["APIC","image"],["PIC","image"],["PRIV","private"]]),ge=["other","file-icon","icon","cover-front","cover-back","leaflet","media","artist-lead","artist","conductor","band","composer","writer","location","during-recording","during-performance","screen","fish","illustration","logo-band","logo-publisher"];function fe(e,t,i){i=i||0,t=t||4;const n={id:null,tag:null,value:null},s=new DataView(e);if(t<3)return function(e){const t={id:null,tag:null,value:null},i=new DataView(e),n={id:he(i,3),type:he(i,1),size:pe(i,3)},s=me.get(n.id);if(!s)return null;if(t.id=n.id,t.tag=s,"T"===n.type){let e=he(i,-7,7);"TCO"===n.id&&parseInt(e)&&(e=ce[parseInt(e)]),t.value=e}else if("W"===n.type)t.value=he(i,-7,7);else if("COM"===n.id){let e=he(i,-10,10);-1!==e.indexOf("\0")&&(e=e.substr(e.indexOf("\0")+1)),t.value=e}else if("PIC"===n.id){const n={type:null,mime:"image/"+he(i,3,7).toLowerCase(),description:null,data:null};n.type=ge[i.getUint8(11)]||"other";const s=11;let r=0;for(let e=s;;e++)if(0===i.getUint8(e)){r=e-s;break}n.description=0===r?null:he(i,r,s),n.data=e.slice(s+1),t.value=n}return t.tag?t:null}(e);const r={id:he(s,4),type:he(s,1),size:ue(s,4),flags:[s.getUint8(8),s.getUint8(9)]};if(0!==r.flags[1])return null;const o=me.get(r.id);if(!o)return null;if(n.tag=o,n.id=r.id,"T"===r.type){const e=s.getUint8(10);let t=null;0===e||3===e?t=he(s,-11,11):1===e?t=de(s,-11,11,!0):2===e&&(t=de(s,-11,11)),"TCON"===r.id&&null!==t&&parseInt(t)&&(t=ce[parseInt(t)]),n.value=t}else if("W"===r.type)n.value=he(s,-10,10);else if("PRIV"===r.id){const t=10;let i=0;for(let e=0;;e++)if(0===s.getUint8(e)){i=e-t;break}n.value={identifier:0===i?null:he(s,i,t),data:e.slice(i+t+1)}}else if("COMM"===r.id){const e=s.getUint8(10);let t=14;for(let i=t;;i++)if(1===e||2===e){if(0===s.getUint16(i)){t=i+2;break}i++}else if(0===s.getUint8(i)){t=i+1;break}0===e||3===e?n.value=he(s,-1*t,t):1===e?n.value=de(s,-1*t,t,!0):2===e&&(n.value=de(s,-1*t,t))}else if("APIC"===r.id){const t=s.getUint8(10),i={type:null,mime:null,description:null,data:null};let r=11,o=0;for(let e=r;;e++)if(0===s.getUint8(e)){o=e-r;break}i.mime=he(s,o,r),i.type=ge[s.getUint8(r+o+1)]||"other",r+=o+2,o=0;for(let e=r;;e++)if(0===s.getUint8(e)){o=e-r;break}0!==o&&(0===t||3===t?i.description=he(s,o,r):1===t?i.description=de(s,o,r,!0):2===t&&(i.description=de(s,o,r))),i.data=e.slice(r+1),n.value=i}return n.tag?n:null}class ve{constructor(){this.size=0}async close(){}async readBlob(e,t=0,i="application/octet-stream"){const n=await this.read(e,t);return new Blob([n],{type:i})}}class ye extends ve{constructor(e){super(),this._file=e}async open(){this.size=this._file.size}async read(e,t){const i=this._file.slice(t,t+e);return new Promise(((e,t)=>{const n=new FileReader;n.onload=()=>{e(n.result)},n.onerror=()=>{t(new Error("File read failed"))},n.readAsArrayBuffer(i)}))}}const be="undefined"!=typeof window&&"File"in window&&"FileReader"in window&&"undefined"!=typeof ArrayBuffer;const we=new Set(["c","cc","cpp","js","json","yml","yaml","py","sh","wsdl"]);function ke(e){let t;t=e instanceof File?e.name:/^http(s)?:/.test(e)?new URL(e).pathname:e;const i=t.lastIndexOf(".");return-1==i?/^data/.test(t)?[null,t.slice(5).split(";")[0].split("/")[1]]:[t,""]:[t.slice(0,i),t.slice(i+1).toLowerCase()]}function xe(e){return["jpg","jpeg","png","svg","gif"].includes(e.toLowerCase())}function _e(e){return["mp3","flac","ogg"].includes(e)}function Ce(e){return["mp4","mkv","webm"].includes(e)}function Ee(e){let[t,i]=e.split("/");if("application"===t){switch(i){case"x-bzip":case"gzip":i="zip";break;case"x-shellscript":case"x-yaml":case"json":i="text"}return i}return t}function Se(e){let t=e.length;for(;--t>=0;)e[t]=0}window.fileX={getExtension:e=>ke(e)[1],getName:e=>ke(e)[0],getFilename:ke,getType:Ee,getTypeFromExtension:function(e){return _e(e)?"audio":Ce(e)?"video":xe(e)?"image":we.has(e)?"text":void 0},getTypeFromFilename(e){return this.getTypeFromExtension(this.getExtension(e))},getMimeType:function(e){switch(e){case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"svg":return"image/svg";case"gif":return"image/gif";case"bz2":return"application/x-bzip2";case"gz":return"application/gzip";case"zip":return"application/zip";case"json":return"application/json";case"mp3":return"audio/mpeg";case"mp4":return"video/mp4";case"mpeg":return"video/mpeg";case"webm":return"video/webm"}},getDuration:function(e){return(t=e,(t-(t%=60))/60+(9<t?":":":0")+t).split(".")[0];var t},getRating:function(e){return Math.floor((e.rating||0)/10).toString()},getDescriptionFromMeta:function(e){if(!e.meta){let t="";return e.artist&&(t+=e.artist),e.album&&(t&&(t+=" - "),t+=e.album),e.year&&(t+=` (${e.year})`),t=t.trim(),t||"Unknown"}let t="";const i=e.meta;return i.album&&(t=i.year?`${i.album} - ${i.year}`:i.album),t},getTitleFromMeta:function(e,t=!0){const i=e.title||e.name||e.filename||e.file.name;if(!e.meta)return fileX.getName(i);let n;const s=e.meta;if(s.title)n=s.artist&&t?`${s.title} - ${s.artist}`:s.title;else{if(!s.artist)return fileX.getName(i);n=s.artist}return n},isImage:xe,isAudio:_e,isVideo:Ce,isMedia:function(e){return _e(e)||Ce(e)},formatSize:function(e){if(e<1024)return`${e.toString()} B`;let t,i;return e<1048576?(i=e/1024,t="K"):(i=e/1048576,t="M"),i=i.toFixed(1),`${i.endsWith(".0")?i.slice(0,-2):i} ${t}`},readFile:function(e){return new Promise(((t,i)=>{const n=new FileReader;n.onerror=i,n.onload=()=>{const e=n.result;t(e)},n.readAsText(e)}))},getFileType(e){return e.type?Ee(e.type):this.getTypeFromFilename(e.name)},getMeta:async function(e){const t=e.name;let i,n={};const[s,r]=ke(t);if((i=s.match(/^\s*(\d{1,2})[\s-_.]*(.*)(\.\w+)?$/))&&(n={title:i[2],track:parseInt(i[1])}),"mp3"==r)try{const t=await function(e){if(!be)throw new Error("Browser does not have support for the File API and/or ArrayBuffers");return async function(e){await e.open();const t=await async function(e){let t=null;const i=await e.read(128,e.size-128),n=new DataView(i);128===i.byteLength&&"TAG"===he(n,3,void 0,!0)&&(t={kind:"v1",title:he(n,30,3).trim()||null,album:he(n,30,63).trim()||null,artist:he(n,30,33).trim()||null,year:he(n,4,93).trim()||null,genre:null,comment:null,track:null},0===n.getUint8(125)?(t.comment=he(n,28,97),t.version=1.1,t.track=n.getUint8(126)):t.comment=he(n,30,97),t.genre=ce[n.getUint8(127)]||null);const s=await e.read(14,0),r=new DataView(s);if(14===s.byteLength&&"ID3"===he(r,3,void 0,!0)&&r.getUint8(3)<=4){let i=10,n=0;const s=[r.getUint8(3),r.getUint8(4)],o=r.getUint8(5);if(0==(128&o)){t={kind:"v2",title:t?t.title:null,album:t?t.album:null,artist:t?t.artist:null,year:t?t.year:null,version:s,frames:[],images:[]},0!=(64&o)&&(i+=ue(r,11)),n+=ue(r,6);const a=await e.read(n,i),l=new DataView(a);let c=0;for(;c<a.byteLength;){let e,i=!0;for(let e=0;e<3;e++){const t=l.getUint8(c+e);(t<65||t>90)&&(t<48||t>57)&&(i=!1)}if(!i)break;e=s[0]<3?a.slice(c,c+6+pe(l,c+3)):3===s[0]?a.slice(c,c+10+l.getUint32(c+4)):a.slice(c,c+10+ue(l,c+4));const n=await fe(e,s[0],s[1]);if(n&&n.tag){const e=t;e.frames.push(n),"image"===n.tag?e.images.push(n.value):t[n.tag]=n.value}c+=e.byteLength}}}return t}(e);return await e.close(),t}(new ye(e))}(e);if(console.log(t),t){const e=Object.fromEntries(Object.entries(t).filter((([e,t])=>null!=t)));if(e.track&&"string"==typeof e.track){const i=t.track.match(/^([0-9]{1,2}).*/);i&&(e.track=parseInt(i[1]))}Object.assign(n,e)}}catch(t){console.log("Failed to load meta info for mp3 file:",e.name)}return n},getSize:function(e){return size(e.size||e.file.size)},getTitle:function(e){if(e.title)return e.title;if(e.meta&&e.meta.title)return e.meta.title;const t=e.name||e.file.name;let i;if(i=t.match(/^\s*(\d{1,2})[\s-_.]*(.*)(\.\w+)?$/))return i[2];const[n]=ke(t);return n},getAlbum:function(e){return e.meta&&e.meta.album?e.meta.album:""}};const Ae=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Te=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),je=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Le=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),De=new Array(576);Se(De);const Oe=new Array(60);Se(Oe);const Ie=new Array(512);Se(Ie);const ze=new Array(256);Se(ze);const Pe=new Array(29);Se(Pe);const Me=new Array(30);function Re(e,t,i,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let $e,Be,Ne;function Fe(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Se(Me);const qe=e=>e<256?Ie[e]:Ie[256+(e>>>7)],He=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Ue=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,He(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},Ve=(e,t,i)=>{Ue(e,i[2*t],i[2*t+1])},We=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},Ye=(e,t,i)=>{const n=new Array(16);let s,r,o=0;for(s=1;s<=15;s++)n[s]=o=o+i[s-1]<<1;for(r=0;r<=t;r++){let t=e[2*r+1];0!==t&&(e[2*r]=We(n[t]++,t))}},Xe=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Ze=e=>{e.bi_valid>8?He(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ke=(e,t,i,n)=>{const s=2*t,r=2*i;return e[s]<e[r]||e[s]===e[r]&&n[t]<=n[i]},Ge=(e,t,i)=>{const n=e.heap[i];let s=i<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Ke(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Ke(t,n,e.heap[s],e.depth));)e.heap[i]=e.heap[s],i=s,s<<=1;e.heap[i]=n},Je=(e,t,i)=>{let n,s,r,o,a=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],s=e.pending_buf[e.l_buf+a],a++,0===n?Ve(e,s,t):(r=ze[s],Ve(e,r+256+1,t),o=Ae[r],0!==o&&(s-=Pe[r],Ue(e,s,o)),n--,r=qe(n),Ve(e,r,i),o=Te[r],0!==o&&(n-=Me[r],Ue(e,n,o)))}while(a<e.last_lit);Ve(e,256,t)},Qe=(e,t)=>{const i=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,l,c=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<r;o++)0!==i[2*o]?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):i[2*o+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,i[2*l]=1,e.depth[l]=0,e.opt_len--,s&&(e.static_len-=n[2*l+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)Ge(e,i,o);l=r;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ge(e,i,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,i[2*l]=i[2*o]+i[2*a],e.depth[l]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,i[2*o+1]=i[2*a+1]=l,e.heap[1]=l++,Ge(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,h,d,u,p,m,g=0;for(u=0;u<=15;u++)e.bl_count[u]=0;for(i[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)h=e.heap[c],u=i[2*i[2*h+1]+1]+1,u>l&&(u=l,g++),i[2*h+1]=u,h>n||(e.bl_count[u]++,p=0,h>=a&&(p=o[h-a]),m=i[2*h],e.opt_len+=m*(u+p),r&&(e.static_len+=m*(s[2*h+1]+p)));if(0!==g){do{for(u=l-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(u=l;0!==u;u--)for(h=e.bl_count[u];0!==h;)d=e.heap[--c],d>n||(i[2*d+1]!==u&&(e.opt_len+=(u-i[2*d+1])*i[2*d],i[2*d+1]=u),h--)}})(e,t),Ye(i,c,e.bl_count)},et=(e,t,i)=>{let n,s,r=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)s=o,o=t[2*(n+1)+1],++a<l&&s===o||(a<c?e.bl_tree[2*s]+=a:0!==s?(s!==r&&e.bl_tree[2*s]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,r=s,0===o?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4))},tt=(e,t,i)=>{let n,s,r=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=i;n++)if(s=o,o=t[2*(n+1)+1],!(++a<l&&s===o)){if(a<c)do{Ve(e,s,e.bl_tree)}while(0!=--a);else 0!==s?(s!==r&&(Ve(e,s,e.bl_tree),a--),Ve(e,16,e.bl_tree),Ue(e,a-3,2)):a<=10?(Ve(e,17,e.bl_tree),Ue(e,a-3,3)):(Ve(e,18,e.bl_tree),Ue(e,a-11,7));a=0,r=s,0===o?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4)}};let it=!1;const nt=(e,t,i,n)=>{Ue(e,0+(n?1:0),3),((e,t,i,n)=>{Ze(e),He(e,i),He(e,~i),e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i})(e,t,i)};var st={_tr_init:e=>{it||((()=>{let e,t,i,n,s;const r=new Array(16);for(i=0,n=0;n<28;n++)for(Pe[n]=i,e=0;e<1<<Ae[n];e++)ze[i++]=n;for(ze[i-1]=n,s=0,n=0;n<16;n++)for(Me[n]=s,e=0;e<1<<Te[n];e++)Ie[s++]=n;for(s>>=7;n<30;n++)for(Me[n]=s<<7,e=0;e<1<<Te[n]-7;e++)Ie[256+s++]=n;for(t=0;t<=15;t++)r[t]=0;for(e=0;e<=143;)De[2*e+1]=8,e++,r[8]++;for(;e<=255;)De[2*e+1]=9,e++,r[9]++;for(;e<=279;)De[2*e+1]=7,e++,r[7]++;for(;e<=287;)De[2*e+1]=8,e++,r[8]++;for(Ye(De,287,r),e=0;e<30;e++)Oe[2*e+1]=5,Oe[2*e]=We(e,5);$e=new Re(De,Ae,257,286,15),Be=new Re(Oe,Te,0,30,15),Ne=new Re(new Array(0),je,0,19,7)})(),it=!0),e.l_desc=new Fe(e.dyn_ltree,$e),e.d_desc=new Fe(e.dyn_dtree,Be),e.bl_desc=new Fe(e.bl_tree,Ne),e.bi_buf=0,e.bi_valid=0,Xe(e)},_tr_stored_block:nt,_tr_flush_block:(e,t,i,n)=>{let s,r,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Qe(e,e.l_desc),Qe(e,e.d_desc),o=(e=>{let t;for(et(e,e.dyn_ltree,e.l_desc.max_code),et(e,e.dyn_dtree,e.d_desc.max_code),Qe(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Le[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=s&&(s=r)):s=r=i+5,i+4<=s&&-1!==t?nt(e,t,i,n):4===e.strategy||r===s?(Ue(e,2+(n?1:0),3),Je(e,De,Oe)):(Ue(e,4+(n?1:0),3),((e,t,i,n)=>{let s;for(Ue(e,t-257,5),Ue(e,i-1,5),Ue(e,n-4,4),s=0;s<n;s++)Ue(e,e.bl_tree[2*Le[s]+1],3);tt(e,e.dyn_ltree,t-1),tt(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Je(e,e.dyn_ltree,e.dyn_dtree)),Xe(e),n&&Ze(e)},_tr_tally:(e,t,i)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(ze[i]+256+1)]++,e.dyn_dtree[2*qe(t)]++),e.last_lit===e.lit_bufsize-1),_tr_align:e=>{Ue(e,2,3),Ve(e,256,De),(e=>{16===e.bi_valid?(He(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},rt=(e,t,i,n)=>{let s=65535&e|0,r=e>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{s=s+t[n++]|0,r=r+s|0}while(--o);s%=65521,r%=65521}return s|r<<16|0};const ot=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var at=(e,t,i,n)=>{const s=ot,r=n+i;e^=-1;for(let i=n;i<r;i++)e=e>>>8^s[255&(e^t[i])];return-1^e},lt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ct={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ht,_tr_stored_block:dt,_tr_flush_block:ut,_tr_tally:pt,_tr_align:mt}=st,{Z_NO_FLUSH:gt,Z_PARTIAL_FLUSH:ft,Z_FULL_FLUSH:vt,Z_FINISH:yt,Z_BLOCK:bt,Z_OK:wt,Z_STREAM_END:kt,Z_STREAM_ERROR:xt,Z_DATA_ERROR:_t,Z_BUF_ERROR:Ct,Z_DEFAULT_COMPRESSION:Et,Z_FILTERED:St,Z_HUFFMAN_ONLY:At,Z_RLE:Tt,Z_FIXED:jt,Z_DEFAULT_STRATEGY:Lt,Z_UNKNOWN:Dt,Z_DEFLATED:Ot}=ct,It=258,zt=262,Pt=103,Mt=113,Rt=666,$t=(e,t)=>(e.msg=lt[t],t),Bt=e=>(e<<1)-(e>4?9:0),Nt=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let Ft=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const qt=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},Ht=(e,t)=>{ut(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,qt(e.strm)},Ut=(e,t)=>{e.pending_buf[e.pending++]=t},Vt=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Wt=(e,t,i,n)=>{let s=e.avail_in;return s>n&&(s=n),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),i),1===e.state.wrap?e.adler=rt(e.adler,t,s,i):2===e.state.wrap&&(e.adler=at(e.adler,t,s,i)),e.next_in+=s,e.total_in+=s,s)},Yt=(e,t)=>{let i,n,s=e.max_chain_length,r=e.strstart,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-zt?e.strstart-(e.w_size-zt):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+It;let p=c[r+o-1],m=c[r+o];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(i=t,c[i+o]===m&&c[i+o-1]===p&&c[i]===c[r]&&c[++i]===c[r+1]){r+=2,i++;do{}while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<u);if(n=It-(u-r),r=u-It,n>o){if(e.match_start=t,o=n,n>=a)break;p=c[r+o-1],m=c[r+o]}}}while((t=d[t&h])>l&&0!=--s);return o<=e.lookahead?o:e.lookahead},Xt=e=>{const t=e.w_size;let i,n,s,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-zt)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,n=e.hash_size,i=n;do{s=e.head[--i],e.head[i]=s>=t?s-t:0}while(--n);n=t,i=n;do{s=e.prev[--i],e.prev[i]=s>=t?s-t:0}while(--n);r+=t}if(0===e.strm.avail_in)break;if(n=Wt(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Ft(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Ft(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<zt&&0!==e.strm.avail_in)},Zt=(e,t)=>{let i,n;for(;;){if(e.lookahead<zt){if(Xt(e),e.lookahead<zt&&t===gt)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=Ft(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-zt&&(e.match_length=Yt(e,i)),e.match_length>=3)if(n=pt(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ft(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ft(e,e.ins_h,e.window[e.strstart+1]);else n=pt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Ht(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===yt?(Ht(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ht(e,!1),0===e.strm.avail_out)?1:2},Kt=(e,t)=>{let i,n,s;for(;;){if(e.lookahead<zt){if(Xt(e),e.lookahead<zt&&t===gt)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=Ft(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-zt&&(e.match_length=Yt(e,i),e.match_length<=5&&(e.strategy===St||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,n=pt(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=Ft(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Ht(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=pt(e,0,e.window[e.strstart-1]),n&&Ht(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=pt(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===yt?(Ht(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ht(e,!1),0===e.strm.avail_out)?1:2};function Gt(e,t,i,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=s}const Jt=[new Gt(0,0,0,0,((e,t)=>{let i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Xt(e),0===e.lookahead&&t===gt)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const n=e.block_start+i;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,Ht(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-zt&&(Ht(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===yt?(Ht(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(Ht(e,!1),e.strm.avail_out),1)})),new Gt(4,4,8,4,Zt),new Gt(4,5,16,8,Zt),new Gt(4,6,32,32,Zt),new Gt(4,4,16,16,Kt),new Gt(8,16,32,32,Kt),new Gt(8,16,128,128,Kt),new Gt(8,32,128,256,Kt),new Gt(32,128,258,1024,Kt),new Gt(32,258,258,4096,Kt)];function Qt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Nt(this.dyn_ltree),Nt(this.dyn_dtree),Nt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Nt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Nt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ei=e=>{if(!e||!e.state)return $t(e,xt);e.total_in=e.total_out=0,e.data_type=Dt;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:Mt,e.adler=2===t.wrap?0:1,t.last_flush=gt,ht(t),wt},ti=e=>{const t=ei(e);var i;return t===wt&&((i=e.state).window_size=2*i.w_size,Nt(i.head),i.max_lazy_match=Jt[i.level].max_lazy,i.good_match=Jt[i.level].good_length,i.nice_match=Jt[i.level].nice_length,i.max_chain_length=Jt[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},ii=(e,t,i,n,s,r)=>{if(!e)return xt;let o=1;if(t===Et&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||i!==Ot||n<8||n>15||t<0||t>9||r<0||r>jt)return $t(e,xt);8===n&&(n=9);const a=new Qt;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=r,a.method=i,ti(e)};var ni={deflateInit:(e,t)=>ii(e,t,Ot,15,8,Lt),deflateInit2:ii,deflateReset:ti,deflateResetKeep:ei,deflateSetHeader:(e,t)=>e&&e.state?2!==e.state.wrap?xt:(e.state.gzhead=t,wt):xt,deflate:(e,t)=>{let i,n;if(!e||!e.state||t>bt||t<0)return e?$t(e,xt):xt;const s=e.state;if(!e.output||!e.input&&0!==e.avail_in||s.status===Rt&&t!==yt)return $t(e,0===e.avail_out?Ct:xt);s.strm=e;const r=s.last_flush;if(s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,Ut(s,31),Ut(s,139),Ut(s,8),s.gzhead?(Ut(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),Ut(s,255&s.gzhead.time),Ut(s,s.gzhead.time>>8&255),Ut(s,s.gzhead.time>>16&255),Ut(s,s.gzhead.time>>24&255),Ut(s,9===s.level?2:s.strategy>=At||s.level<2?4:0),Ut(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(Ut(s,255&s.gzhead.extra.length),Ut(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=at(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(Ut(s,0),Ut(s,0),Ut(s,0),Ut(s,0),Ut(s,0),Ut(s,9===s.level?2:s.strategy>=At||s.level<2?4:0),Ut(s,3),s.status=Mt);else{let t=Ot+(s.w_bits-8<<4)<<8,i=-1;i=s.strategy>=At||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=i<<6,0!==s.strstart&&(t|=32),t+=31-t%31,s.status=Mt,Vt(s,t),0!==s.strstart&&(Vt(s,e.adler>>>16),Vt(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>i&&(e.adler=at(e.adler,s.pending_buf,s.pending-i,i)),qt(e),i=s.pending,s.pending!==s.pending_buf_size));)Ut(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(e.adler=at(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=at(e.adler,s.pending_buf,s.pending-i,i)),qt(e),i=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,Ut(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>i&&(e.adler=at(e.adler,s.pending_buf,s.pending-i,i)),0===n&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=at(e.adler,s.pending_buf,s.pending-i,i)),qt(e),i=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,Ut(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>i&&(e.adler=at(e.adler,s.pending_buf,s.pending-i,i)),0===n&&(s.status=Pt)}else s.status=Pt;if(s.status===Pt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&qt(e),s.pending+2<=s.pending_buf_size&&(Ut(s,255&e.adler),Ut(s,e.adler>>8&255),e.adler=0,s.status=Mt)):s.status=Mt),0!==s.pending){if(qt(e),0===e.avail_out)return s.last_flush=-1,wt}else if(0===e.avail_in&&Bt(t)<=Bt(r)&&t!==yt)return $t(e,Ct);if(s.status===Rt&&0!==e.avail_in)return $t(e,Ct);if(0!==e.avail_in||0!==s.lookahead||t!==gt&&s.status!==Rt){let i=s.strategy===At?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(Xt(e),0===e.lookahead)){if(t===gt)return 1;break}if(e.match_length=0,i=pt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(Ht(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===yt?(Ht(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ht(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===Tt?((e,t)=>{let i,n,s,r;const o=e.window;for(;;){if(e.lookahead<=It){if(Xt(e),e.lookahead<=It&&t===gt)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){r=e.strstart+It;do{}while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<r);e.match_length=It-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=pt(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=pt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(Ht(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===yt?(Ht(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Ht(e,!1),0===e.strm.avail_out)?1:2})(s,t):Jt[s.level].func(s,t);if(3!==i&&4!==i||(s.status=Rt),1===i||3===i)return 0===e.avail_out&&(s.last_flush=-1),wt;if(2===i&&(t===ft?mt(s):t!==bt&&(dt(s,0,0,!1),t===vt&&(Nt(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),qt(e),0===e.avail_out))return s.last_flush=-1,wt}return t!==yt?wt:s.wrap<=0?kt:(2===s.wrap?(Ut(s,255&e.adler),Ut(s,e.adler>>8&255),Ut(s,e.adler>>16&255),Ut(s,e.adler>>24&255),Ut(s,255&e.total_in),Ut(s,e.total_in>>8&255),Ut(s,e.total_in>>16&255),Ut(s,e.total_in>>24&255)):(Vt(s,e.adler>>>16),Vt(s,65535&e.adler)),qt(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?wt:kt)},deflateEnd:e=>{if(!e||!e.state)return xt;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==Pt&&t!==Mt&&t!==Rt?$t(e,xt):(e.state=null,t===Mt?$t(e,_t):wt)},deflateSetDictionary:(e,t)=>{let i=t.length;if(!e||!e.state)return xt;const n=e.state,s=n.wrap;if(2===s||1===s&&42!==n.status||n.lookahead)return xt;if(1===s&&(e.adler=rt(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===s&&(Nt(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(i-n.w_size,i),0),t=e,i=n.w_size}const r=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,Xt(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=Ft(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,Xt(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=o,e.input=a,e.avail_in=r,n.wrap=s,wt},deflateInfo:"pako deflate (from Nodeca project)"};const si=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var ri={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const t in i)si(i,t)&&(e[t]=i[t])}}return e},flattenChunks:e=>{let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,n=0,s=e.length;t<s;t++){let s=e[t];i.set(s,n),n+=s.length}return i}};let oi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){oi=!1}const ai=new Uint8Array(256);for(let e=0;e<256;e++)ai[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ai[254]=ai[254]=1;var li={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,n,s,r,o=e.length,a=0;for(s=0;s<o;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<o&&(n=e.charCodeAt(s+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),s++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(a),r=0,s=0;r<a;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<o&&(n=e.charCodeAt(s+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),s++)),i<128?t[r++]=i:i<2048?(t[r++]=192|i>>>6,t[r++]=128|63&i):i<65536?(t[r++]=224|i>>>12,t[r++]=128|i>>>6&63,t[r++]=128|63&i):(t[r++]=240|i>>>18,t[r++]=128|i>>>12&63,t[r++]=128|i>>>6&63,t[r++]=128|63&i);return t},buf2string:(e,t)=>{const i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,s;const r=new Array(2*i);for(s=0,n=0;n<i;){let t=e[n++];if(t<128){r[s++]=t;continue}let o=ai[t];if(o>4)r[s++]=65533,n+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&n<i;)t=t<<6|63&e[n++],o--;o>1?r[s++]=65533:t<65536?r[s++]=t:(t-=65536,r[s++]=55296|t>>10&1023,r[s++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&oi)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i})(r,s)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+ai[e[i]]>t?i:t}},ci=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const hi=Object.prototype.toString,{Z_NO_FLUSH:di,Z_SYNC_FLUSH:ui,Z_FULL_FLUSH:pi,Z_FINISH:mi,Z_OK:gi,Z_STREAM_END:fi,Z_DEFAULT_COMPRESSION:vi,Z_DEFAULT_STRATEGY:yi,Z_DEFLATED:bi}=ct;function wi(e){this.options=ri.assign({level:vi,method:bi,chunkSize:16384,windowBits:15,memLevel:8,strategy:yi},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ci,this.strm.avail_out=0;let i=ni.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==gi)throw new Error(lt[i]);if(t.header&&ni.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?li.string2buf(t.dictionary):"[object ArrayBuffer]"===hi.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=ni.deflateSetDictionary(this.strm,e),i!==gi)throw new Error(lt[i]);this._dict_set=!0}}function ki(e,t){const i=new wi(t);if(i.push(e,!0),i.err)throw i.msg||lt[i.err];return i.result}wi.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize;let s,r;if(this.ended)return!1;for(r=t===~~t?t:!0===t?mi:di,"string"==typeof e?i.input=li.string2buf(e):"[object ArrayBuffer]"===hi.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(r===ui||r===pi)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(s=ni.deflate(i,r),s===fi)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),s=ni.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===gi;if(0!==i.avail_out){if(r>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},wi.prototype.onData=function(e){this.chunks.push(e)},wi.prototype.onEnd=function(e){e===gi&&(this.result=ri.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var xi={Deflate:wi,deflate:ki,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ki(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ki(e,t)},constants:ct},_i=function(e,t){let i,n,s,r,o,a,l,c,h,d,u,p,m,g,f,v,y,b,w,k,x,_,C,E;const S=e.state;i=e.next_in,C=e.input,n=i+(e.avail_in-5),s=e.next_out,E=e.output,r=s-(t-e.avail_out),o=s+(e.avail_out-257),a=S.dmax,l=S.wsize,c=S.whave,h=S.wnext,d=S.window,u=S.hold,p=S.bits,m=S.lencode,g=S.distcode,f=(1<<S.lenbits)-1,v=(1<<S.distbits)-1;e:do{p<15&&(u+=C[i++]<<p,p+=8,u+=C[i++]<<p,p+=8),y=m[u&f];t:for(;;){if(b=y>>>24,u>>>=b,p-=b,b=y>>>16&255,0===b)E[s++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=m[(65535&y)+(u&(1<<b)-1)];continue t}if(32&b){S.mode=12;break e}e.msg="invalid literal/length code",S.mode=30;break e}w=65535&y,b&=15,b&&(p<b&&(u+=C[i++]<<p,p+=8),w+=u&(1<<b)-1,u>>>=b,p-=b),p<15&&(u+=C[i++]<<p,p+=8,u+=C[i++]<<p,p+=8),y=g[u&v];i:for(;;){if(b=y>>>24,u>>>=b,p-=b,b=y>>>16&255,!(16&b)){if(0==(64&b)){y=g[(65535&y)+(u&(1<<b)-1)];continue i}e.msg="invalid distance code",S.mode=30;break e}if(k=65535&y,b&=15,p<b&&(u+=C[i++]<<p,p+=8,p<b&&(u+=C[i++]<<p,p+=8)),k+=u&(1<<b)-1,k>a){e.msg="invalid distance too far back",S.mode=30;break e}if(u>>>=b,p-=b,b=s-r,k>b){if(b=k-b,b>c&&S.sane){e.msg="invalid distance too far back",S.mode=30;break e}if(x=0,_=d,0===h){if(x+=l-b,b<w){w-=b;do{E[s++]=d[x++]}while(--b);x=s-k,_=E}}else if(h<b){if(x+=l+h-b,b-=h,b<w){w-=b;do{E[s++]=d[x++]}while(--b);if(x=0,h<w){b=h,w-=b;do{E[s++]=d[x++]}while(--b);x=s-k,_=E}}}else if(x+=h-b,b<w){w-=b;do{E[s++]=d[x++]}while(--b);x=s-k,_=E}for(;w>2;)E[s++]=_[x++],E[s++]=_[x++],E[s++]=_[x++],w-=3;w&&(E[s++]=_[x++],w>1&&(E[s++]=_[x++]))}else{x=s-k;do{E[s++]=E[x++],E[s++]=E[x++],E[s++]=E[x++],w-=3}while(w>2);w&&(E[s++]=E[x++],w>1&&(E[s++]=E[x++]))}break}}break}}while(i<n&&s<o);w=p>>3,i-=w,p-=w<<3,u&=(1<<p)-1,e.next_in=i,e.next_out=s,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=s<o?o-s+257:257-(s-o),S.hold=u,S.bits=p};const Ci=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ei=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Si=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ai=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ti=(e,t,i,n,s,r,o,a)=>{const l=a.bits;let c,h,d,u,p,m,g=0,f=0,v=0,y=0,b=0,w=0,k=0,x=0,_=0,C=0,E=null,S=0;const A=new Uint16Array(16),T=new Uint16Array(16);let j,L,D,O=null,I=0;for(g=0;g<=15;g++)A[g]=0;for(f=0;f<n;f++)A[t[i+f]]++;for(b=l,y=15;y>=1&&0===A[y];y--);if(b>y&&(b=y),0===y)return s[r++]=20971520,s[r++]=20971520,a.bits=1,0;for(v=1;v<y&&0===A[v];v++);for(b<v&&(b=v),x=1,g=1;g<=15;g++)if(x<<=1,x-=A[g],x<0)return-1;if(x>0&&(0===e||1!==y))return-1;for(T[1]=0,g=1;g<15;g++)T[g+1]=T[g]+A[g];for(f=0;f<n;f++)0!==t[i+f]&&(o[T[t[i+f]]++]=f);if(0===e?(E=O=o,m=19):1===e?(E=Ci,S-=257,O=Ei,I-=257,m=256):(E=Si,O=Ai,m=-1),C=0,f=0,g=v,p=r,w=b,k=0,d=-1,_=1<<b,u=_-1,1===e&&_>852||2===e&&_>592)return 1;for(;;){j=g-k,o[f]<m?(L=0,D=o[f]):o[f]>m?(L=O[I+o[f]],D=E[S+o[f]]):(L=96,D=0),c=1<<g-k,h=1<<w,v=h;do{h-=c,s[p+(C>>k)+h]=j<<24|L<<16|D|0}while(0!==h);for(c=1<<g-1;C&c;)c>>=1;if(0!==c?(C&=c-1,C+=c):C=0,f++,0==--A[g]){if(g===y)break;g=t[i+o[f]]}if(g>b&&(C&u)!==d){for(0===k&&(k=b),p+=v,w=g-k,x=1<<w;w+k<y&&(x-=A[w+k],!(x<=0));)w++,x<<=1;if(_+=1<<w,1===e&&_>852||2===e&&_>592)return 1;d=C&u,s[d]=b<<24|w<<16|p-r|0}}return 0!==C&&(s[p+C]=g-k<<24|64<<16|0),a.bits=b,0};const{Z_FINISH:ji,Z_BLOCK:Li,Z_TREES:Di,Z_OK:Oi,Z_STREAM_END:Ii,Z_NEED_DICT:zi,Z_STREAM_ERROR:Pi,Z_DATA_ERROR:Mi,Z_MEM_ERROR:Ri,Z_BUF_ERROR:$i,Z_DEFLATED:Bi}=ct,Ni=12,Fi=30,qi=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Hi(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ui=e=>{if(!e||!e.state)return Pi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Oi},Vi=e=>{if(!e||!e.state)return Pi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ui(e)},Wi=(e,t)=>{let i;if(!e||!e.state)return Pi;const n=e.state;return t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Pi:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,Vi(e))},Yi=(e,t)=>{if(!e)return Pi;const i=new Hi;e.state=i,i.window=null;const n=Wi(e,t);return n!==Oi&&(e.state=null),n};let Xi,Zi,Ki=!0;const Gi=e=>{if(Ki){Xi=new Int32Array(512),Zi=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ti(1,e.lens,0,288,Xi,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ti(2,e.lens,0,32,Zi,0,e.work,{bits:5}),Ki=!1}e.lencode=Xi,e.lenbits=9,e.distcode=Zi,e.distbits=5},Ji=(e,t,i,n)=>{let s;const r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(t.subarray(i-r.wsize,i),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(t.subarray(i-n,i-n+s),r.wnext),(n-=s)?(r.window.set(t.subarray(i-n,i),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0};var Qi={inflateReset:Vi,inflateReset2:Wi,inflateResetKeep:Ui,inflateInit:e=>Yi(e,15),inflateInit2:Yi,inflate:(e,t)=>{let i,n,s,r,o,a,l,c,h,d,u,p,m,g,f,v,y,b,w,k,x,_,C=0;const E=new Uint8Array(4);let S,A;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Pi;i=e.state,i.mode===Ni&&(i.mode=13),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,n=e.input,a=e.avail_in,c=i.hold,h=i.bits,d=a,u=l,_=Oi;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;h<16;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(2&i.wrap&&35615===c){i.check=0,E[0]=255&c,E[1]=c>>>8&255,i.check=at(i.check,E,2,0),c=0,h=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",i.mode=Fi;break}if((15&c)!==Bi){e.msg="unknown compression method",i.mode=Fi;break}if(c>>>=4,h-=4,x=8+(15&c),0===i.wbits)i.wbits=x;else if(x>i.wbits){e.msg="invalid window size",i.mode=Fi;break}i.dmax=1<<i.wbits,e.adler=i.check=1,i.mode=512&c?10:Ni,c=0,h=0;break;case 2:for(;h<16;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(i.flags=c,(255&i.flags)!==Bi){e.msg="unknown compression method",i.mode=Fi;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=Fi;break}i.head&&(i.head.text=c>>8&1),512&i.flags&&(E[0]=255&c,E[1]=c>>>8&255,i.check=at(i.check,E,2,0)),c=0,h=0,i.mode=3;case 3:for(;h<32;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}i.head&&(i.head.time=c),512&i.flags&&(E[0]=255&c,E[1]=c>>>8&255,E[2]=c>>>16&255,E[3]=c>>>24&255,i.check=at(i.check,E,4,0)),c=0,h=0,i.mode=4;case 4:for(;h<16;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}i.head&&(i.head.xflags=255&c,i.head.os=c>>8),512&i.flags&&(E[0]=255&c,E[1]=c>>>8&255,i.check=at(i.check,E,2,0)),c=0,h=0,i.mode=5;case 5:if(1024&i.flags){for(;h<16;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}i.length=c,i.head&&(i.head.extra_len=c),512&i.flags&&(E[0]=255&c,E[1]=c>>>8&255,i.check=at(i.check,E,2,0)),c=0,h=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(p=i.length,p>a&&(p=a),p&&(i.head&&(x=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(r,r+p),x)),512&i.flags&&(i.check=at(i.check,n,p,r)),a-=p,r+=p,i.length-=p),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===a)break e;p=0;do{x=n[r+p++],i.head&&x&&i.length<65536&&(i.head.name+=String.fromCharCode(x))}while(x&&p<a);if(512&i.flags&&(i.check=at(i.check,n,p,r)),a-=p,r+=p,x)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===a)break e;p=0;do{x=n[r+p++],i.head&&x&&i.length<65536&&(i.head.comment+=String.fromCharCode(x))}while(x&&p<a);if(512&i.flags&&(i.check=at(i.check,n,p,r)),a-=p,r+=p,x)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;h<16;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(c!==(65535&i.check)){e.msg="header crc mismatch",i.mode=Fi;break}c=0,h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Ni;break;case 10:for(;h<32;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}e.adler=i.check=qi(c),c=0,h=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,i.hold=c,i.bits=h,zi;e.adler=i.check=1,i.mode=Ni;case Ni:if(t===Li||t===Di)break e;case 13:if(i.last){c>>>=7&h,h-=7&h,i.mode=27;break}for(;h<3;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}switch(i.last=1&c,c>>>=1,h-=1,3&c){case 0:i.mode=14;break;case 1:if(Gi(i),i.mode=20,t===Di){c>>>=2,h-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=Fi}c>>>=2,h-=2;break;case 14:for(c>>>=7&h,h-=7&h;h<32;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Fi;break}if(i.length=65535&c,c=0,h=0,i.mode=15,t===Di)break e;case 15:i.mode=16;case 16:if(p=i.length,p){if(p>a&&(p=a),p>l&&(p=l),0===p)break e;s.set(n.subarray(r,r+p),o),a-=p,r+=p,l-=p,o+=p,i.length-=p;break}i.mode=Ni;break;case 17:for(;h<14;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(i.nlen=257+(31&c),c>>>=5,h-=5,i.ndist=1+(31&c),c>>>=5,h-=5,i.ncode=4+(15&c),c>>>=4,h-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Fi;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;h<3;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}i.lens[T[i.have++]]=7&c,c>>>=3,h-=3}for(;i.have<19;)i.lens[T[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,S={bits:i.lenbits},_=Ti(0,i.lens,0,19,i.lencode,0,i.work,S),i.lenbits=S.bits,_){e.msg="invalid code lengths set",i.mode=Fi;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;C=i.lencode[c&(1<<i.lenbits)-1],f=C>>>24,v=C>>>16&255,y=65535&C,!(f<=h);){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(y<16)c>>>=f,h-=f,i.lens[i.have++]=y;else{if(16===y){for(A=f+2;h<A;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(c>>>=f,h-=f,0===i.have){e.msg="invalid bit length repeat",i.mode=Fi;break}x=i.lens[i.have-1],p=3+(3&c),c>>>=2,h-=2}else if(17===y){for(A=f+3;h<A;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}c>>>=f,h-=f,x=0,p=3+(7&c),c>>>=3,h-=3}else{for(A=f+7;h<A;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}c>>>=f,h-=f,x=0,p=11+(127&c),c>>>=7,h-=7}if(i.have+p>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Fi;break}for(;p--;)i.lens[i.have++]=x}}if(i.mode===Fi)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=Fi;break}if(i.lenbits=9,S={bits:i.lenbits},_=Ti(1,i.lens,0,i.nlen,i.lencode,0,i.work,S),i.lenbits=S.bits,_){e.msg="invalid literal/lengths set",i.mode=Fi;break}if(i.distbits=6,i.distcode=i.distdyn,S={bits:i.distbits},_=Ti(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,S),i.distbits=S.bits,_){e.msg="invalid distances set",i.mode=Fi;break}if(i.mode=20,t===Di)break e;case 20:i.mode=21;case 21:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,i.hold=c,i.bits=h,_i(e,u),o=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,n=e.input,a=e.avail_in,c=i.hold,h=i.bits,i.mode===Ni&&(i.back=-1);break}for(i.back=0;C=i.lencode[c&(1<<i.lenbits)-1],f=C>>>24,v=C>>>16&255,y=65535&C,!(f<=h);){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(v&&0==(240&v)){for(b=f,w=v,k=y;C=i.lencode[k+((c&(1<<b+w)-1)>>b)],f=C>>>24,v=C>>>16&255,y=65535&C,!(b+f<=h);){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}c>>>=b,h-=b,i.back+=b}if(c>>>=f,h-=f,i.back+=f,i.length=y,0===v){i.mode=26;break}if(32&v){i.back=-1,i.mode=Ni;break}if(64&v){e.msg="invalid literal/length code",i.mode=Fi;break}i.extra=15&v,i.mode=22;case 22:if(i.extra){for(A=i.extra;h<A;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;C=i.distcode[c&(1<<i.distbits)-1],f=C>>>24,v=C>>>16&255,y=65535&C,!(f<=h);){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(0==(240&v)){for(b=f,w=v,k=y;C=i.distcode[k+((c&(1<<b+w)-1)>>b)],f=C>>>24,v=C>>>16&255,y=65535&C,!(b+f<=h);){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}c>>>=b,h-=b,i.back+=b}if(c>>>=f,h-=f,i.back+=f,64&v){e.msg="invalid distance code",i.mode=Fi;break}i.offset=y,i.extra=15&v,i.mode=24;case 24:if(i.extra){for(A=i.extra;h<A;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=Fi;break}i.mode=25;case 25:if(0===l)break e;if(p=u-l,i.offset>p){if(p=i.offset-p,p>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Fi;break}p>i.wnext?(p-=i.wnext,m=i.wsize-p):m=i.wnext-p,p>i.length&&(p=i.length),g=i.window}else g=s,m=o-i.offset,p=i.length;p>l&&(p=l),l-=p,i.length-=p;do{s[o++]=g[m++]}while(--p);0===i.length&&(i.mode=21);break;case 26:if(0===l)break e;s[o++]=i.length,l--,i.mode=21;break;case 27:if(i.wrap){for(;h<32;){if(0===a)break e;a--,c|=n[r++]<<h,h+=8}if(u-=l,e.total_out+=u,i.total+=u,u&&(e.adler=i.check=i.flags?at(i.check,s,u,o-u):rt(i.check,s,u,o-u)),u=l,(i.flags?c:qi(c))!==i.check){e.msg="incorrect data check",i.mode=Fi;break}c=0,h=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;h<32;){if(0===a)break e;a--,c+=n[r++]<<h,h+=8}if(c!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=Fi;break}c=0,h=0}i.mode=29;case 29:_=Ii;break e;case Fi:_=Mi;break e;case 31:return Ri;default:return Pi}return e.next_out=o,e.avail_out=l,e.next_in=r,e.avail_in=a,i.hold=c,i.bits=h,(i.wsize||u!==e.avail_out&&i.mode<Fi&&(i.mode<27||t!==ji))&&Ji(e,e.output,e.next_out,u-e.avail_out),d-=e.avail_in,u-=e.avail_out,e.total_in+=d,e.total_out+=u,i.total+=u,i.wrap&&u&&(e.adler=i.check=i.flags?at(i.check,s,u,e.next_out-u):rt(i.check,s,u,e.next_out-u)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Ni?128:0)+(20===i.mode||15===i.mode?256:0),(0===d&&0===u||t===ji)&&_===Oi&&(_=$i),_},inflateEnd:e=>{if(!e||!e.state)return Pi;let t=e.state;return t.window&&(t.window=null),e.state=null,Oi},inflateGetHeader:(e,t)=>{if(!e||!e.state)return Pi;const i=e.state;return 0==(2&i.wrap)?Pi:(i.head=t,t.done=!1,Oi)},inflateSetDictionary:(e,t)=>{const i=t.length;let n,s,r;return e&&e.state?(n=e.state,0!==n.wrap&&11!==n.mode?Pi:11===n.mode&&(s=1,s=rt(s,t,i,0),s!==n.check)?Mi:(r=Ji(e,t,i,i),r?(n.mode=31,Ri):(n.havedict=1,Oi))):Pi},inflateInfo:"pako inflate (from Nodeca project)"},en=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const tn=Object.prototype.toString,{Z_NO_FLUSH:nn,Z_FINISH:sn,Z_OK:rn,Z_STREAM_END:on,Z_NEED_DICT:an,Z_STREAM_ERROR:ln,Z_DATA_ERROR:cn,Z_MEM_ERROR:hn}=ct;function dn(e){this.options=ri.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ci,this.strm.avail_out=0;let i=Qi.inflateInit2(this.strm,t.windowBits);if(i!==rn)throw new Error(lt[i]);if(this.header=new en,Qi.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=li.string2buf(t.dictionary):"[object ArrayBuffer]"===tn.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=Qi.inflateSetDictionary(this.strm,t.dictionary),i!==rn)))throw new Error(lt[i])}function un(e,t){const i=new dn(t);if(i.push(e),i.err)throw i.msg||lt[i.err];return i.result}dn.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(o=t===~~t?t:!0===t?sn:nn,"[object ArrayBuffer]"===tn.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),r=Qi.inflate(i,o),r===an&&s&&(r=Qi.inflateSetDictionary(i,s),r===rn?r=Qi.inflate(i,o):r===cn&&(r=an));i.avail_in>0&&r===on&&i.state.wrap>0&&0!==e[i.next_in];)Qi.inflateReset(i),r=Qi.inflate(i,o);switch(r){case ln:case cn:case an:case hn:return this.onEnd(r),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||r===on))if("string"===this.options.to){let e=li.utf8border(i.output,i.next_out),t=i.next_out-e,s=li.buf2string(i.output,e);i.next_out=t,i.avail_out=n-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(s)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==rn||0!==a){if(r===on)return r=Qi.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},dn.prototype.onData=function(e){this.chunks.push(e)},dn.prototype.onEnd=function(e){e===rn&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ri.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var pn={Inflate:dn,inflate:un,inflateRaw:function(e,t){return(t=t||{}).raw=!0,un(e,t)},ungzip:un,constants:ct};const{Deflate:mn,deflate:gn,deflateRaw:fn,gzip:vn}=xi,{Inflate:yn,inflate:bn,inflateRaw:wn,ungzip:kn}=pn,xn={Deflate:mn,deflate:gn,deflateRaw:fn,gzip:vn,Inflate:yn,inflate:bn,inflateRaw:wn,ungzip:kn,constants:ct};Object.assign(window,{unzip:(e,t={to:"string"})=>xn.inflate(e,t),zip(e){let t=e;return"string"==typeof e&&(t=new TextEncoder("utf-8").encode(e)),xn.deflate(t)}}),__webpack_require__(830);var _n={maxCacheSize:100,maxCacheTime:864e5,warnIfItemPurgedBeforeTime:5e3,opLimit:200,scanLimit:50};function Cn(){return Cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},Cn.apply(this,arguments)}var En=Object.create,Sn=Object.assign,An=Object.prototype.hasOwnProperty,Tn=Date.now,jn=function(e){return Math.max(e,0)||0},Ln=function(e){return Sn(e,{maxCacheSize:jn(e.maxCacheSize),maxCacheTime:jn(e.maxCacheTime),opLimit:jn(e.opLimit)}),e},Dn=function(e){return!!e&&!!e.limitedCacheMetaVersion},On=function(e){if(!Dn(e))throw new Error("Limited-cache metadata is missing: please check your usage");2!==e.limitedCacheMetaVersion&&(console.warn("Limited-cache metadata is from an incompatible version (1). It must be reset."),e.limitedCacheMetaVersion=2,Fn(e))},In=function(e,t){return On(e),Ln(Sn(e.options,t))},zn=function(e,t){var i=e.options.maxCacheTime,n=e.keyInfo[t];if(!n)return 0;var s=n[0];return n[1]||s+(i||31536e6)},Pn=function(e,t,i){return zn(e,t)<i},Mn=function(e){On(e);var t=e.cache,i=e.keyList,n=e.keyInfo,s=Tn(),r=i.reduce((function(i,r){var o=i[0],a=i[1],l=i[2];return Pn(e,r,s)||(o[r]=t[r],a.push(r),l[r]=n[r]),i}),[{},[],En(null)]),o=r[0],a=r[1],l=r[2];return Sn(e,{cache:o,keyList:a,keyInfo:l,opsLeft:e.options.opLimit})},Rn=function(e,t,i){var n=e.cache,s=e.keyList,r=e.keyInfo,o=t,a=s[t],l=s.length;do{n[a]=r[a]=void 0,a=s[++o]}while(o<l&&Pn(e,a,i));s.splice(t,o-t)},$n=function(e,t){On(e);var i=e.cache;if(An.call(i,t)&&void 0!==i[t]){if(!Pn(e,t,Tn()))return!0;i[t]=void 0}return!1},Bn=function(e,t){if(On(e),$n(e,t))return e.cache[t]},Nn=function(e){return On(e),Mn(e),e.cache},Fn=function(e){return On(e),Sn(e,{cache:{},keyList:[],keyInfo:En(null),opsLeft:e.options.opLimit})},qn=function(e,t){return e.bind(null,t)},Hn=(__webpack_require__(753),/Mac/.test(navigator.platform)),Un={toggleBold:Qn,toggleItalic:es,drawLink:us,toggleHeadingSmaller:ss,toggleHeadingBigger:rs,drawImage:ps,toggleBlockquote:ns,toggleOrderedList:hs,toggleUnorderedList:cs,toggleCodeBlock:is,togglePreview:ws,toggleStrikethrough:ts,toggleHeading1:os,toggleHeading2:as,toggleHeading3:ls,cleanBlock:ds,drawTable:ms,drawHorizontalRule:gs,undo:vs,redo:ys,toggleSideBySide:bs,toggleFullScreen:Jn},Vn={toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeadingSmaller:"Cmd-H",toggleHeadingBigger:"Shift-Cmd-H",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleBlockquote:"Cmd-'",toggleOrderedList:"Cmd-Alt-L",toggleUnorderedList:"Cmd-L",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11"},Wn=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t};function Yn(e){return Hn?e.replace("Ctrl","Cmd"):e.replace("Cmd","Ctrl")}function Xn(e,t,i){e=e||{};var n=document.createElement("a");return t=null==t||t,e.title&&t&&(n.title=function(e,t,i){var n,s=e;return t&&i[n=function(e){for(var t in Un)if(Un[t]===e)return t;return null}(t)]&&(s+=" ("+Yn(i[n])+")"),s}(e.title,e.action,i),Hn&&(n.title=n.title.replace("Ctrl","⌘"),n.title=n.title.replace("Alt","⌥"))),n.tabIndex=-1,n.className=e.className,n}function Zn(){var e=document.createElement("i");return e.className="separator",e.innerHTML="|",e}function Kn(e,t){t=t||e.getCursor("start");var i=e.getTokenAt(t);if(!i.type)return{};for(var n,s,r=i.type.split(" "),o={},a=0;a<r.length;a++)"strong"===(n=r[a])?o.bold=!0:"variable-2"===n?(s=e.getLine(t.line),/^\s*\d+\.\s/.test(s)?o["ordered-list"]=!0:o["unordered-list"]=!0):"atom"===n?o.quote=!0:"em"===n?o.italic=!0:"quote"===n?o.quote=!0:"strikethrough"===n?o.strikethrough=!0:"comment"===n?o.code=!0:"link"===n?o.link=!0:"tag"===n?o.image=!0:n.match(/^header(\-[1-6])?$/)&&(o[n.replace("header","heading")]=!0);return o}var Gn="";function Jn(e){var t=e.codemirror;t.setOption("fullScreen",!t.getOption("fullScreen")),t.getOption("fullScreen")?(Gn=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=Gn;var i=t.getWrapperElement();/fullscreen/.test(i.previousSibling.className)?i.previousSibling.className=i.previousSibling.className.replace(/\s*fullscreen\b/,""):i.previousSibling.className+=" fullscreen";var n=e.toolbarElements.fullscreen;/active/.test(n.className)?n.className=n.className.replace(/\s*active\s*/g,""):n.className+=" active";var s=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(s.className)&&bs(e)}function Qn(e){Cs(e,"bold",e.options.blockStyles.bold)}function es(e){Cs(e,"italic",e.options.blockStyles.italic)}function ts(e){Cs(e,"strikethrough","~~")}function is(e){var t=e.options.blockStyles.code;function i(e){if("object"!=typeof e)throw"fencing_line() takes a 'line' object (not a line number, or line text).  Got: "+typeof e+": "+e;return e.styles&&e.styles[2]&&-1!==e.styles[2].indexOf("formatting-code-block")}function n(e){return e.state.base.base||e.state.base}function s(e,t,s,r,o){s=s||e.getLineHandle(t),r=r||e.getTokenAt({line:t,ch:1}),o=o||!!s.text&&e.getTokenAt({line:t,ch:s.text.length-1});var a=r.type?r.type.split(" "):[];return o&&n(o).indentedCode?"indented":-1!==a.indexOf("comment")&&(n(r).fencedChars||n(o).fencedChars||i(s)?"fenced":"single")}var r,o,a,l=e.codemirror,c=l.getCursor("start"),h=l.getCursor("end"),d=l.getTokenAt({line:c.line,ch:c.ch||1}),u=l.getLineHandle(c.line),p=s(l,c.line,u,d);if("single"===p){var m=u.text.slice(0,c.ch).replace("`",""),g=u.text.slice(c.ch).replace("`","");l.replaceRange(m+g,{line:c.line,ch:0},{line:c.line,ch:99999999999999}),c.ch--,c!==h&&h.ch--,l.setSelection(c,h),l.focus()}else if("fenced"===p)if(c.line!==h.line||c.ch!==h.ch){for(r=c.line;r>=0&&!i(u=l.getLineHandle(r));r--);var f,v,y,b,w=n(l.getTokenAt({line:r,ch:1})).fencedChars;i(l.getLineHandle(c.line))?(f="",v=c.line):i(l.getLineHandle(c.line-1))?(f="",v=c.line-1):(f=w+"\n",v=c.line),i(l.getLineHandle(h.line))?(y="",b=h.line,0===h.ch&&(b+=1)):0!==h.ch&&i(l.getLineHandle(h.line+1))?(y="",b=h.line+1):(y=w+"\n",b=h.line+1),0===h.ch&&(b-=1),l.operation((function(){l.replaceRange(y,{line:b,ch:0},{line:b+(y?0:1),ch:0}),l.replaceRange(f,{line:v,ch:0},{line:v+(f?0:1),ch:0})})),l.setSelection({line:v+(f?1:0),ch:0},{line:b+(f?1:-1),ch:0}),l.focus()}else{var k=c.line;if(i(l.getLineHandle(c.line))&&("fenced"===s(l,c.line+1)?(r=c.line,k=c.line+1):(o=c.line,k=c.line-1)),void 0===r)for(r=k;r>=0&&!i(u=l.getLineHandle(r));r--);if(void 0===o)for(a=l.lineCount(),o=k;o<a&&!i(u=l.getLineHandle(o));o++);l.operation((function(){l.replaceRange("",{line:r,ch:0},{line:r+1,ch:0}),l.replaceRange("",{line:o-1,ch:0},{line:o,ch:0})})),l.focus()}else if("indented"===p){if(c.line!==h.line||c.ch!==h.ch)r=c.line,o=h.line,0===h.ch&&o--;else{for(r=c.line;r>=0;r--)if(!(u=l.getLineHandle(r)).text.match(/^\s*$/)&&"indented"!==s(l,r,u)){r+=1;break}for(a=l.lineCount(),o=c.line;o<a;o++)if(!(u=l.getLineHandle(o)).text.match(/^\s*$/)&&"indented"!==s(l,o,u)){o-=1;break}}var x=l.getLineHandle(o+1),_=x&&l.getTokenAt({line:o+1,ch:x.text.length-1});_&&n(_).indentedCode&&l.replaceRange("\n",{line:o+1,ch:0});for(var C=r;C<=o;C++)l.indentLine(C,"subtract");l.focus()}else{var E=c.line===h.line&&c.ch===h.ch&&0===c.ch,S=c.line!==h.line;E||S?function(e,t,i,n){var s=t.line+1,r=i.line+1,o=t.line!==i.line,a=n+"\n",l="\n"+n;o&&r++,o&&0===i.ch&&(l=n+"\n",r--),ks(e,!1,[a,l]),e.setSelection({line:s,ch:0},{line:r,ch:0})}(l,c,h,t):ks(l,!1,["`","`"])}}function ns(e){_s(e.codemirror,"quote")}function ss(e){xs(e.codemirror,"smaller")}function rs(e){xs(e.codemirror,"bigger")}function os(e){xs(e.codemirror,void 0,1)}function as(e){xs(e.codemirror,void 0,2)}function ls(e){xs(e.codemirror,void 0,3)}function cs(e){_s(e.codemirror,"unordered-list")}function hs(e){_s(e.codemirror,"ordered-list")}function ds(e){!function(e){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className))for(var t,i=e.getCursor("start"),n=e.getCursor("end"),s=i.line;s<=n.line;s++)t=(t=e.getLine(s)).replace(/^[ ]*([# ]+|\*|\-|[> ]+|[0-9]+(.|\)))[ ]*/,""),e.replaceRange(t,{line:s,ch:0},{line:s,ch:99999999999999})}(e.codemirror)}function us(e){var t=e.codemirror,i=Kn(t),n=e.options,s="http://";if(n.promptURLs&&!(s=prompt(n.promptTexts.link)))return!1;ks(t,i.link,n.insertTexts.link,s)}function ps(e){var t=e.codemirror,i=Kn(t),n=e.options,s="http://";if(n.promptURLs&&!(s=prompt(n.promptTexts.image)))return!1;ks(t,i.image,n.insertTexts.image,s)}function ms(e){var t=e.codemirror,i=Kn(t),n=e.options;ks(t,i.table,n.insertTexts.table)}function gs(e){var t=e.codemirror,i=Kn(t),n=e.options;ks(t,i.image,n.insertTexts.horizontalRule)}function vs(e){var t=e.codemirror;t.undo(),t.focus()}function ys(e){var t=e.codemirror;t.redo(),t.focus()}function bs(e){var t=e.codemirror,i=t.getWrapperElement(),n=i.nextSibling,s=e.toolbarElements["side-by-side"],r=!1;/editor-preview-active-side/.test(n.className)?(n.className=n.className.replace(/\s*editor-preview-active-side\s*/g,""),s.className=s.className.replace(/\s*active\s*/g,""),i.className=i.className.replace(/\s*CodeMirror-sided\s*/g," ")):(setTimeout((function(){t.getOption("fullScreen")||Jn(e),n.className+=" editor-preview-active-side"}),1),s.className+=" active",i.className+=" CodeMirror-sided",r=!0);var o=i.lastChild;if(/editor-preview-active/.test(o.className)){o.className=o.className.replace(/\s*editor-preview-active\s*/g,"");var a=e.toolbarElements.preview,l=i.previousSibling;a.className=a.className.replace(/\s*active\s*/g,""),l.className=l.className.replace(/\s*disabled-for-preview*/g,"")}t.sideBySideRenderingFunction||(t.sideBySideRenderingFunction=function(){n.innerHTML=e.options.previewRender(e.value(),n)}),r?(n.innerHTML=e.options.previewRender(e.value(),n),t.on("update",t.sideBySideRenderingFunction)):t.off("update",t.sideBySideRenderingFunction),t.refresh()}function ws(e){var t=e.codemirror,i=t.getWrapperElement(),n=i.previousSibling,s=!!e.options.toolbar&&e.toolbarElements.preview,r=i.lastChild;r&&/editor-preview/.test(r.className)||((r=document.createElement("div")).className="editor-preview",i.appendChild(r)),/editor-preview-active/.test(r.className)?(r.className=r.className.replace(/\s*editor-preview-active\s*/g,""),s&&(s.className=s.className.replace(/\s*active\s*/g,""),n.className=n.className.replace(/\s*disabled-for-preview*/g,""))):(setTimeout((function(){r.className+=" editor-preview-active"}),1),s&&(s.className+=" active",n.className+=" disabled-for-preview")),r.innerHTML=e.options.previewRender(e.value(),r);var o=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(o.className)&&bs(e)}function ks(e,t,i,n){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var s,r=i[0],o=i[1],a=e.getCursor("start"),l=e.getCursor("end");n&&(o=o.replace("#url#",n)),t?(r=(s=e.getLine(a.line)).slice(0,a.ch),o=s.slice(a.ch),e.replaceRange(r+o,{line:a.line,ch:0})):(s=e.getSelection(),e.replaceSelection(r+s+o),a.ch+=r.length,a!==l&&(l.ch+=r.length)),e.setSelection(a,l),e.focus()}}function xs(e,t,i){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var n=e.getCursor("start"),s=e.getCursor("end"),r=n.line;r<=s.line;r++)!function(n){var s=e.getLine(n),r=s.search(/[^#]/);s=void 0!==t?r<=0?"bigger"==t?"###### "+s:"# "+s:6==r&&"smaller"==t?s.substr(7):1==r&&"bigger"==t?s.substr(2):"bigger"==t?s.substr(1):"#"+s:1==i?r<=0?"# "+s:r==i?s.substr(r+1):"# "+s.substr(r+1):2==i?r<=0?"## "+s:r==i?s.substr(r+1):"## "+s.substr(r+1):r<=0?"### "+s:r==i?s.substr(r+1):"### "+s.substr(r+1),e.replaceRange(s,{line:n,ch:0},{line:n,ch:99999999999999})}(r);e.focus()}}function _s(e,t){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var i=Kn(e),n=e.getCursor("start"),s=e.getCursor("end"),r={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},o={quote:"> ","unordered-list":"* ","ordered-list":"1. "},a=n.line;a<=s.line;a++)!function(n){var s=e.getLine(n);s=i[t]?s.replace(r[t],"$1"):o[t]+s,e.replaceRange(s,{line:n,ch:0},{line:n,ch:99999999999999})}(a);e.focus()}}function Cs(e,t,i,n){if(!/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className)){n=void 0===n?i:n;var s,r=e.codemirror,o=Kn(r),a=i,l=n,c=r.getCursor("start"),h=r.getCursor("end");o[t]?(a=(s=r.getLine(c.line)).slice(0,c.ch),l=s.slice(c.ch),"bold"==t?(a=a.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,""),l=l.replace(/(\*\*|__)/,"")):"italic"==t?(a=a.replace(/(\*|_)(?![\s\S]*(\*|_))/,""),l=l.replace(/(\*|_)/,"")):"strikethrough"==t&&(a=a.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,""),l=l.replace(/(\*\*|~~)/,"")),r.replaceRange(a+l,{line:c.line,ch:0},{line:c.line,ch:99999999999999}),"bold"==t||"strikethrough"==t?(c.ch-=2,c!==h&&(h.ch-=2)):"italic"==t&&(c.ch-=1,c!==h&&(h.ch-=1))):(s=r.getSelection(),"bold"==t?s=(s=s.split("**").join("")).split("__").join(""):"italic"==t?s=(s=s.split("*").join("")).split("_").join(""):"strikethrough"==t&&(s=s.split("~~").join("")),r.replaceSelection(a+s+l),c.ch+=i.length,h.ch=c.ch+s.length),r.setSelection(c,h),r.focus()}}function Es(e,t){for(var i in t)t.hasOwnProperty(i)&&(t[i]instanceof Array?e[i]=t[i].concat(e[i]instanceof Array?e[i]:[]):null!==t[i]&&"object"==typeof t[i]&&t[i].constructor===Object?e[i]=Es(e[i]||{},t[i]):e[i]=t[i]);return e}function Ss(e){for(var t=1;t<arguments.length;t++)e=Es(e,arguments[t]);return e}function As(e){var t=e.match(/[a-zA-Z0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g),i=0;if(null===t)return i;for(var n=0;n<t.length;n++)t[n].charCodeAt(0)>=19968?i+=t[n].length:i+=1;return i}var Ts={bold:{name:"bold",action:Qn,className:"fa fa-bold",title:"Bold",default:!0},italic:{name:"italic",action:es,className:"fa fa-italic",title:"Italic",default:!0},strikethrough:{name:"strikethrough",action:ts,className:"fa fa-strikethrough",title:"Strikethrough"},heading:{name:"heading",action:ss,className:"fa fa-header",title:"Heading",default:!0},"heading-smaller":{name:"heading-smaller",action:ss,className:"fa fa-header fa-header-x fa-header-smaller",title:"Smaller Heading"},"heading-bigger":{name:"heading-bigger",action:rs,className:"fa fa-header fa-header-x fa-header-bigger",title:"Bigger Heading"},"heading-1":{name:"heading-1",action:os,className:"fa fa-header fa-header-x fa-header-1",title:"Big Heading"},"heading-2":{name:"heading-2",action:as,className:"fa fa-header fa-header-x fa-header-2",title:"Medium Heading"},"heading-3":{name:"heading-3",action:ls,className:"fa fa-header fa-header-x fa-header-3",title:"Small Heading"},"separator-1":{name:"separator-1"},code:{name:"code",action:is,className:"fa fa-code",title:"Code",default:!0},quote:{name:"quote",action:ns,className:"fa fa-quote-left",title:"Quote",default:!0},"unordered-list":{name:"unordered-list",action:cs,className:"fa fa-list-ul",title:"Generic List",default:!0},"ordered-list":{name:"ordered-list",action:hs,className:"fa fa-list-ol",title:"Numbered List",default:!0},"clean-block":{name:"clean-block",action:ds,className:"fa fa-eraser fa-clean-block",title:"Clean block"},link:{name:"link",action:us,className:"fa fa-link",title:"Create Link",default:!0},image:{name:"image",action:ps,className:"fa fa-picture-o",title:"Insert Image",default:!1},table:{name:"table",action:ms,className:"fa fa-table",title:"Insert Table"},"horizontal-rule":{name:"horizontal-rule",action:gs,className:"fa fa-minus",title:"Insert Horizontal Line"},"separator-3":{name:"separator-3"},preview:{name:"preview",action:ws,className:"fa fa-eye no-disable",title:"Toggle Preview",default:!0},"side-by-side":{name:"side-by-side",action:bs,className:"fa fa-columns no-disable no-mobile",title:"Toggle Side by Side",default:!1},fullscreen:{name:"fullscreen",action:Jn,className:"fa fa-arrows-alt no-disable no-mobile",title:"Toggle Fullscreen",default:!1},"separator-4":{name:"separator-4"},guide:{name:"guide",action:"https://simplemde.com/markdown-guide",className:"fa fa-question-circle",title:"Markdown Guide",default:!1},"separator-5":{name:"separator-5"},undo:{name:"undo",action:vs,className:"fa fa-undo no-disable",title:"Undo"},redo:{name:"redo",action:ys,className:"fa fa-repeat no-disable",title:"Redo"}},js={link:["[","](#url#)"],image:["![](","#url#)"],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text     | Text     |\n\n"],horizontalRule:["","\n\n-----\n\n"]},Ls={link:"URL for the link:",image:"URL of the image:"},Ds={bold:"**",code:"```",italic:"*"};function Os(e){(e=e||{}).parent=this;var t=!0;if(!1===e.autoDownloadFontAwesome&&(t=!1),!0!==e.autoDownloadFontAwesome)for(var i=document.styleSheets,n=0;n<i.length;n++)i[n].href&&i[n].href.indexOf("//maxcdn.bootstrapcdn.com/font-awesome/")>-1&&(t=!1);if(t){var s=document.createElement("link");s.rel="stylesheet",s.href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(s)}if(e.element)this.element=e.element;else if(null===e.element)return void console.log("SimpleMDE: Error. No element was found.");if(void 0===e.toolbar)for(var r in e.toolbar=[],Ts)Ts.hasOwnProperty(r)&&(-1!=r.indexOf("separator-")&&e.toolbar.push("|"),(!0===Ts[r].default||e.showIcons&&e.showIcons.constructor===Array&&-1!=e.showIcons.indexOf(r))&&e.toolbar.push(r));e.hasOwnProperty("status")||(e.status=["autosave","lines","words","cursor"]),e.previewRender||(e.previewRender=function(e){return this.parent.markdown(e)}),e.parsingConfig=Ss({highlightFormatting:!0},e.parsingConfig||{}),e.insertTexts=Ss({},js,e.insertTexts||{}),e.promptTexts=Ls,e.blockStyles=Ss({},Ds,e.blockStyles||{}),e.shortcuts=Ss({},Vn,e.shortcuts||{}),null!=e.autosave&&null!=e.autosave.unique_id&&""!=e.autosave.unique_id&&(e.autosave.uniqueId=e.autosave.unique_id),this.options=e,this.render(),!e.initialValue||this.options.autosave&&!0===this.options.autosave.foundSavedValue||this.value(e.initialValue)}function Is(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("smde_localStorage",1),localStorage.removeItem("smde_localStorage")}catch(e){return!1}return!0}Os.prototype.markdown=function(e){if(t){var i={headerIds:!1};return this.options&&this.options.renderingConfig&&!1===this.options.renderingConfig.singleLineBreaks?i.breaks=!1:i.breaks=!0,this.options&&this.options.renderingConfig&&!0===this.options.renderingConfig.codeSyntaxHighlighting&&window.hljs&&(i.highlight=function(e){return window.hljs.highlightAuto(e).value}),q(i),N(e)}},Os.prototype.render=function(e){if(e||(e=this.element||document.getElementsByTagName("textarea")[0]),!this._rendered||this._rendered!==e){this.element=e;var t,i,n=this.options,s=this,r={};for(var o in n.shortcuts)null!==n.shortcuts[o]&&null!==Un[o]&&function(e){r[Yn(n.shortcuts[e])]=function(){Un[e](s)}}(o);if(r.Enter="newlineAndIndentContinueMarkdownList",r.Tab="tabAndIndentMarkdownList",r["Shift-Tab"]="shiftTabAndUnindentMarkdownList",r.Esc=function(e){e.getOption("fullScreen")&&Jn(s)},document.addEventListener("keydown",(function(e){27==(e=e||window.event).keyCode&&s.codemirror.getOption("fullScreen")&&Jn(s)}),!1),!1!==n.spellChecker?(t="spell-checker",(i=n.parsingConfig).name="gfm",i.gitHubSpice=!1):((t=n.parsingConfig).name="gfm",t.gitHubSpice=!1),this.codemirror=CodeMirror.fromTextArea(e,{mode:t,backdrop:i,theme:"paper",tabSize:null!=n.tabSize?n.tabSize:2,indentUnit:null!=n.tabSize?n.tabSize:2,indentWithTabs:!1!==n.indentWithTabs,lineNumbers:!1,autofocus:!0===n.autofocus,extraKeys:r,lineWrapping:!1!==n.lineWrapping,allowDropFileTypes:["text/plain"],placeholder:n.placeholder||e.getAttribute("placeholder")||"",styleSelectedText:null==n.styleSelectedText||n.styleSelectedText}),!0===n.forceSync){var a=this.codemirror;a.on("change",(function(){a.save()}))}this.gui={},!1!==n.toolbar&&(this.gui.toolbar=this.createToolbar()),!1!==n.status&&(this.gui.statusbar=this.createStatusbar()),null!=n.autosave&&!0===n.autosave.enabled&&this.autosave(),this.gui.sideBySide=this.createSideBySide(),this._rendered=this.element;var l=this.codemirror;setTimeout(function(){l.refresh()}.bind(l),0)}},Os.prototype.autosave=function(){if(Is()){var e=this;if(null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("SimpleMDE: You must set a uniqueId to use the autosave feature");null!=e.element.form&&null!=e.element.form&&e.element.form.addEventListener("submit",(function(){localStorage.removeItem("smde_"+e.options.autosave.uniqueId)})),!0!==this.options.autosave.loaded&&("string"==typeof localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&""!=localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&(this.codemirror.setValue(localStorage.getItem("smde_"+this.options.autosave.uniqueId)),this.options.autosave.foundSavedValue=!0),this.options.autosave.loaded=!0),localStorage.setItem("smde_"+this.options.autosave.uniqueId,e.value());var t=document.getElementById("autosaved");if(null!=t&&null!=t&&""!=t){var i=new Date,n=i.getHours(),s=i.getMinutes(),r="am",o=n;o>=12&&(o=n-12,r="pm"),0==o&&(o=12),s=s<10?"0"+s:s,t.innerHTML="Autosaved: "+o+":"+s+" "+r}this.autosaveTimeoutId=setTimeout((function(){e.autosave()}),this.options.autosave.delay||1e4)}else console.log("SimpleMDE: localStorage not available, cannot autosave")},Os.prototype.clearAutosavedValue=function(){if(Is()){if(null==this.options.autosave||null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("SimpleMDE: You must set a uniqueId to clear the autosave value");localStorage.removeItem("smde_"+this.options.autosave.uniqueId)}else console.log("SimpleMDE: localStorage not available, cannot autosave")},Os.prototype.createSideBySide=function(){var e=this.codemirror,t=e.getWrapperElement(),i=t.nextSibling;i&&/editor-preview-side/.test(i.className)||((i=document.createElement("div")).className="editor-preview-side",t.parentNode.insertBefore(i,t.nextSibling));var n=!1,s=!1;return e.on("scroll",(function(e){if(n)n=!1;else{s=!0;var t=e.getScrollInfo().height-e.getScrollInfo().clientHeight,r=parseFloat(e.getScrollInfo().top)/t,o=(i.scrollHeight-i.clientHeight)*r;i.scrollTop=o}})),i.onscroll=function(){if(s)s=!1;else{n=!0;var t=i.scrollHeight-i.clientHeight,r=parseFloat(i.scrollTop)/t,o=(e.getScrollInfo().height-e.getScrollInfo().clientHeight)*r;e.scrollTo(0,o)}},i},Os.prototype.createToolbar=function(e){if((e=e||this.options.toolbar)&&0!==e.length){var t;for(t=0;t<e.length;t++)null!=Ts[e[t]]&&(e[t]=Ts[e[t]]);var i=document.createElement("div");i.className="editor-toolbar";var n=this,s={};for(n.toolbar=e,t=0;t<e.length;t++)if(("guide"!=e[t].name||!1!==n.options.toolbarGuideIcon)&&!(n.options.hideIcons&&-1!=n.options.hideIcons.indexOf(e[t].name)||("fullscreen"==e[t].name||"side-by-side"==e[t].name)&&Wn())){if("|"===e[t]){for(var r=!1,o=t+1;o<e.length;o++)"|"===e[o]||n.options.hideIcons&&-1!=n.options.hideIcons.indexOf(e[o].name)||(r=!0);if(!r)continue}!function(e){var t;t="|"===e?Zn():Xn(e,n.options.toolbarTips,n.options.shortcuts),e.action&&("function"==typeof e.action?t.onclick=function(t){t.preventDefault(),e.action(n)}:"string"==typeof e.action&&(t.href=e.action,t.target="_blank")),s[e.name||e]=t,i.appendChild(t)}(e[t])}n.toolbarElements=s;var a=this.codemirror;a.on("cursorActivity",(function(){var e=Kn(a);for(var t in s)!function(t){var i=s[t];e[t]?i.className+=" active":"fullscreen"!=t&&"side-by-side"!=t&&(i.className=i.className.replace(/\s*active\s*/g,""))}(t)}));var l=a.getWrapperElement();return l.parentNode.insertBefore(i,l),i}},Os.prototype.createStatusbar=function(e){e=e||this.options.status;var t=this.options,i=this.codemirror;if(e&&0!==e.length){var n,s,r,o=[];for(n=0;n<e.length;n++)if(s=void 0,r=void 0,"object"==typeof e[n])o.push({className:e[n].className,defaultValue:e[n].defaultValue,onUpdate:e[n].onUpdate});else{var a=e[n];"words"===a?(r=function(e){e.innerHTML=As(i.getValue())},s=function(e){e.innerHTML=As(i.getValue())}):"lines"===a?(r=function(e){e.innerHTML=i.lineCount()},s=function(e){e.innerHTML=i.lineCount()}):"cursor"===a?(r=function(e){e.innerHTML="0:0"},s=function(e){var t=i.getCursor();e.innerHTML=t.line+":"+t.ch}):"autosave"===a&&(r=function(e){null!=t.autosave&&!0===t.autosave.enabled&&e.setAttribute("id","autosaved")}),o.push({className:a,defaultValue:r,onUpdate:s})}var l=document.createElement("div");for(l.className="editor-statusbar",n=0;n<o.length;n++){var c=o[n],h=document.createElement("span");h.className=c.className,"function"==typeof c.defaultValue&&c.defaultValue(h),"function"==typeof c.onUpdate&&this.codemirror.on("update",function(e,t){return function(){t.onUpdate(e)}}(h,c)),l.appendChild(h)}var d=this.codemirror.getWrapperElement();return d.parentNode.insertBefore(l,d.nextSibling),l}},Os.prototype.value=function(e){return void 0===e?this.codemirror.getValue():(this.codemirror.getDoc().setValue(e),this)},Os.toggleBold=Qn,Os.toggleItalic=es,Os.toggleStrikethrough=ts,Os.toggleBlockquote=ns,Os.toggleHeadingSmaller=ss,Os.toggleHeadingBigger=rs,Os.toggleHeading1=os,Os.toggleHeading2=as,Os.toggleHeading3=ls,Os.toggleCodeBlock=is,Os.toggleUnorderedList=cs,Os.toggleOrderedList=hs,Os.cleanBlock=ds,Os.drawLink=us,Os.drawImage=ps,Os.drawTable=ms,Os.drawHorizontalRule=gs,Os.undo=vs,Os.redo=ys,Os.togglePreview=ws,Os.toggleSideBySide=bs,Os.toggleFullScreen=Jn,Os.prototype.toggleBold=function(){Qn(this)},Os.prototype.toggleItalic=function(){es(this)},Os.prototype.toggleStrikethrough=function(){ts(this)},Os.prototype.toggleBlockquote=function(){ns(this)},Os.prototype.toggleHeadingSmaller=function(){ss(this)},Os.prototype.toggleHeadingBigger=function(){rs(this)},Os.prototype.toggleHeading1=function(){os(this)},Os.prototype.toggleHeading2=function(){as(this)},Os.prototype.toggleHeading3=function(){ls(this)},Os.prototype.toggleCodeBlock=function(){is(this)},Os.prototype.toggleUnorderedList=function(){cs(this)},Os.prototype.toggleOrderedList=function(){hs(this)},Os.prototype.cleanBlock=function(){ds(this)},Os.prototype.drawLink=function(){us(this)},Os.prototype.drawImage=function(){ps(this)},Os.prototype.drawTable=function(){ms(this)},Os.prototype.drawHorizontalRule=function(){gs(this)},Os.prototype.undo=function(){vs(this)},Os.prototype.redo=function(){ys(this)},Os.prototype.togglePreview=function(){ws(this)},Os.prototype.toggleSideBySide=function(){bs(this)},Os.prototype.toggleFullScreen=function(){Jn(this)},Os.prototype.isPreviewActive=function(){var e=this.codemirror.getWrapperElement().lastChild;return/editor-preview-active/.test(e.className)},Os.prototype.isSideBySideActive=function(){var e=this.codemirror.getWrapperElement().nextSibling;return/editor-preview-active-side/.test(e.className)},Os.prototype.isFullscreenActive=function(){return this.codemirror.getOption("fullScreen")},Os.prototype.getState=function(){return Kn(this.codemirror)},Os.prototype.toTextArea=function(){var e=this.codemirror,t=e.getWrapperElement();t.parentNode&&(this.gui.toolbar&&t.parentNode.removeChild(this.gui.toolbar),this.gui.statusbar&&t.parentNode.removeChild(this.gui.statusbar),this.gui.sideBySide&&t.parentNode.removeChild(this.gui.sideBySide));var i=e.getTextArea();return e.toTextArea(),this.autosaveTimeoutId&&(clearTimeout(this.autosaveTimeoutId),this.autosaveTimeoutId=void 0,this.clearAutosavedValue()),i};const zs=Ps({label:"UTILS"});function Ps(e={}){const t=[`color: ${e.color||"#fff"}`,`background-color: ${e.bgcolor||"#87CEEB"}`,"padding: 2px 4px","border-radius: 2px"].join(";"),i=e.label||"",n=window.console;return{log(...s){Ms(n.log,!!e.time,i,t,...s)},error(...s){Ms(n.error,!!e.time,i,t,...s)},debug(...s){Ms(n.debug,!!e.time,i,t,...s)}}}function Ms(e,t,i,n,...s){t?e(`${(new Date).toLocaleTimeString()} %c${i}`,n,...s):e(`%c${i}`,n,...s)}Os.wrap=function(e){return new Os({element:e,spellChecker:!1,autoDownloadFontAwesome:!1})};const Rs="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";Object.assign(window,{download:function(e,t,i){var n=document.createElement("a"),s=new Blob([e],{type:t}),r=URL.createObjectURL(s);n.setAttribute("href",r),n.setAttribute("download",i),n.click()},loadImage:async function(e,t=200,i=t){zs.debug("Load image begin ...");const{url:n,width:s,height:r}=await function(e,t=200,i=t){return new Promise(((n,s)=>{const r=dom.createElement("img","obj"),o=fileX.getExtension(e),a=fileX.getMimeType(o);"string"==typeof e||e instanceof Blob||(r.file=e);const l=new FileReader;var c;l.onload=(c=r,e=>{c.onload=()=>{var e=dom.createElement("canvas","photo"),s=e.getContext("2d");let r=c.width,o=c.height;r>o?r>t&&(o*=t/r,r=t):o>i&&(r*=i/o,o=i),e.width=r,e.height=o,s.drawImage(c,0,0,r,o),n({url:e.toDataURL(a),width:r,height:o})},c.src=e.target.result}),l.readAsDataURL(e)}))}(e,t,i),o=new Image;return o.src=n,o.width=s,o.height=r,zs.debug("Load image DONE!!!"),o},loadImageUrl:function(e,t=200,i=t){const n=dom.createElement("img","obj"),s=fileX.getExtension(e),r=fileX.getMimeType(s);return"string"==typeof e||e instanceof Blob||(n.file=e),new Promise(((s,o)=>{n.onerror=o,n.onload=()=>{var e=dom.createElement("canvas","photo"),o=e.getContext("2d");let a=n.width,l=n.height;a>l?a>t&&(l*=t/a,a=t):l>i&&(a*=i/l,l=i),e.width=a,e.height=l,o.drawImage(n,0,0,a,l),URL.revokeObjectURL(n.src),s({url:e.toDataURL(r),width:a,height:l})};const a=new FileReader;a.onerror=o,a.onload=()=>n.src=a.result,a.readAsDataURL(e)}))},loadVideoThumb:function(e,t=640,i=t){return zs.log("LOADING VIDEO"),new Promise(((n,s)=>{var r=dom.createElement("canvas","video"),o=r.getContext("2d");const a=URL.createObjectURL(e),l=dom.createElement("video");l.autoplay=!0,l.src=a,l.createTime=5,l.muted=!0;let c,h,d=!1;l.onloadedmetadata=e=>{zs.log("VIDEO metadata loaded",l.videoWidth,"x",l.height),zs.log(e),c=l.videoWidth,h=l.videoHeight,c>h?c>t&&(h*=t/c,c=t):h>i&&(c*=i/h,h=i),r.width=c,r.height=h},l.oncanplay=()=>{zs.log("VIDEO can play",l.width,"x",l.height),d||(l.currentTime=10,d=!0)},l.onseeked=()=>{o.drawImage(l,0,0,c,h);const e=new Image;e.src=r.toDataURL("image/jpeg"),e.width=c,e.height=h,l.pause(),n(e)},l.onerror=()=>s("Unable to load video")}))},parseMagnetURI:function(e){const t=e.match(/magnet:\?xt=urn:[a-z0-9]+:([a-z0-9]{40})(.+)/),i=t[1],n=t[2].slice(1).split("&"),s={uri:e,hash:i};for(const[e,t]of n.map((e=>e.split("=")))){const i=decodeURIComponent(t);s[e]?Array.isArray(s[e])?s[e].push(i):s[e]=[s[e],i]:s[e]=i}return s},generatePushID:function(e,t=Date.seconds()){for(var i="string"==typeof e?e.hashCode():e,n=1e3*t+i%1e3,s=(i^n)>>>0,r=new Array(8),o=7;o>=0;o--)r[o]=Rs.charAt(n%64),n=Math.floor(n/64);var a=r.join(""),l=Rs.slice(o=s%64)+Rs.slice(0,o);for(o=7;o>=0;o--)r[o]=l.charAt(s%64),s=Math.floor(s/64);return a+r.join("")},createConsole:Ps,CacheMap:function(e){var t=function(e){if(Dn(e)){var t=e;return On(t),t}var i=Ln(Cn({},_n,e));return Fn({limitedCacheMetaVersion:2,options:i})}(e);return{get:qn(Bn,t),getAll:qn(Nn,t),has:qn($n,t),set:function(e,i){return function(e,t,i){On(e);var n,s=e.options.maxCacheSize,r=e.keyList,o=e.keyInfo,a=Tn(),l=!o[t];e.cache[t]!==i&&(e.cache=Cn({},e.cache,((n={})[t]=i,n))),o[t]=[a,0],l&&(r.push(t),e.opsLeft--,e.opsLeft<=0&&Mn(e),s&&e.keyList.length>s&&function(e,t){var i=e.options,n=i.scanLimit,s=(i.warnIfItemPurgedBeforeTime,e.cache,e.keyList),r=(e.keyInfo,0),o=zn(e,s[0]);if(o>t)for(var a=0,l=Math.min(s.length,n);a<l;){var c=s[a],h=zn(e,c);if(h<t){r=a,o=0;break}h<o&&(r=a,o=h),a+=1}Rn(e,r,t)}(e,a)),Pn(e,r[0],a)&&Rn(e,0,a)}(t,e,i),i},remove:function(e){return function(e,t){On(e);var i,n=e.cache,s=e.keyInfo;s[t]&&(void 0!==n[t]&&(e.cache=Cn({},n,((i={})[t]=void 0,i))),s[t]=void 0)}(t,e),!0},reset:qn(Fn,t),getCacheMeta:function(){return t},getOptions:function(){return t.options},setOptions:qn(In,t),doMaintenance:qn(Mn,t),values(){return Object.values(this.getAll())}}},MDE:Os,le:(e,t)=>e<t,leq:(e,t)=>e<=t,gt:(e,t)=>e>t,gte:(e,t)=>e>=t});const $s={append(e,t=!1){t?this.area.insertBefore(e,this.area.firstElementChild):this.area.appendChild(e)},appendTemplate(e,t,i="div",...n){const s=dom.renderTemplate(e,t,i,[...n]);return this.append(s),s},removeContent(){dom.removeChilds(this.area)},querySelector(e){return this.area.querySelector(e)},querySelectorAll(e){return this.area.querySelectorAll(e)},getLastElement(){return this.area.lastElementChild},getFirstElement(){return this.area.firstElementChild},moveTop(e,t=!1){t?dom.moveAfterTop(e):dom.moveTop(e)},insertTop(e){dom.insertTop(e,this.area)},addStyle(...e){this.area.classList.add(...e)},removeStyle(...e){this.area.classList.remove(...e)},removeSelf(){dom.removeElement(this.area)},getViewport(){return this.area.getBoundingClientRect()},showSelf(e){const t=e?this.area.parentElement:this.area;dom.showElement(t)},hideSelf(e){const t=e?this.area.parentElement:this.area;dom.hideElement(t)},childCount(){return this.area.childElementCount}};class Bs{#e;#t;#i;get area(){return this.#t}get viewport(){return this.#e.getBoundingClientRect()}set bottom(e){this.alignBottom=e,this.posY=1}get sliderMaxY(){return this.height-this.sliderHeight}get sliderPosY(){return this.sliderMaxY*this.posY}get containerElement(){return this.#e}get parentElement(){return this.#e.parentElement}get firstElement(){return this.#e.firstElement}get Y(){return this.posY}set Y(e){this.posY=e,this.#n(),this.#s()}get offsetY(){return Math.floor(this.posY*this.totalHeight)}set offsetY(e){if(this.totalHeight>0){const t=Math.abs(e/this.totalHeight);this.Y=t<=1?t:1}}constructor(e){this.height=e.getBoundingClientRect().height,this.scroller=e.querySelector("div.v-scroller"),this.slider=this.scroller.querySelector("div.slider"),this.#t=e.querySelector("div.content");const t=this.area.getBoundingClientRect();this.totalHeight=t.height,this.#i=t.width,this.posY=0,this.alignBottom=!1,this.scrolling=!1,this.#t.hasAttribute("bottom")&&(this.bottom=!0),this.#e=e,this.#r(),this.resizeObserver=new ResizeObserver((t=>{const i=Math.floor(e.getBoundingClientRect().height);i>0&&(this.height=i,this.#o())})),this.resizeAreaObserver=new ResizeObserver((()=>{const e=this.#t.getBoundingClientRect(),t=Math.ceil(e.height);if(Math.abs(this.#i-e.width)>20){this.#i=e.width;const t=this.area.querySelectorAll(".marquee-container > .marquee");for(const e of t){const t=e.clientWidth,i=e.parentElement.clientWidth;let n=i/100*1.2;t>i?n+=t/i:n-=i/t,n=Math.floor(n),n<4&&(n=4),e.style.animationDuration=`${n}s`}}if(t>0){const e=this.alignBottom?this.totalHeight-this.offsetY:this.offsetY,i=this.totalHeight;this.totalHeight=t,this.#r(),this.offsetY=this.alignBottom?t-e:e,this.onHeightChange(i,t,this.height)}}))}registerEvents(){this.resizeObserver.observe(this.#e),this.resizeAreaObserver.observe(this.area),this.#e.addEventListener("wheel",this,{passive:!0}),this.#e.addEventListener("keyup",this),this.registerSliderEvents()}unregisterEvents(){this.resizeObserver.unobserve(this.#e),this.resizeAreaObserver.unobserve(this.area),this.#e.removeEventListener("wheel",this),this.#e.removeEventListener("keyup",this),this.unregisterSliderEvents()}registerSliderEvents(){this.slider.addEventListener("mouseup",this),this.slider.addEventListener("mousedown",this),this.slider.addEventListener("mouseleave",this),this.slider.addEventListener("mousemove",this)}unregisterSliderEvents(){this.slider.removeEventListener("mouseup",this),this.slider.removeEventListener("mousedown",this),this.slider.removeEventListener("mouseleave",this),this.slider.removeEventListener("mousemove",this)}handleEvent(e){switch(e.type){case"wheel":if(this.totalHeight>this.height){if(this.posY<=0&&e.deltaY<0)return;if(this.posY>=1&&e.deltaY>0)return;const t=e.deltaY;let i=this.posY+t/this.totalHeight;i>1?i=1:i<0&&(i=0),this.posY=i,this.#a()}return!0;case"keyup":if(this.totalHeight>this.height){const t=this.height/this.totalHeight;33==e.keyCode?this.posY>0&&(this.posY-=t,this.posY<0&&(this.posY=0),this.#a()):34==e.keyCode&&this.posY<1&&(this.posY+=t,this.posY>1&&(this.posY=1),this.#a())}return!0;case"mousedown":e.stopPropagation(),this.scrolling=!0,this.sliderY=e.offsetY;break;case"mouseup":e.stopPropagation(),this.scrolling=!1;break;case"mousemove":if(this.scrolling){e.stopPropagation();const t=e.offsetY-this.sliderY,i=this.sliderPosY;if(i<=0){if(t<=0)return;this.posY=t/this.sliderMaxY}else this.posY*=(i+t)/i;this.posY>1?this.posY=1:this.posY<0&&(this.posY=0),this.#a()}break;case"mouseleave":this.scrolling=!1,e.stopPropagation()}return!1}setFocus(){this.#e.focus()}scrollTo(e){const t=e.getBoundingClientRect().top;if(t<=10)return void(this.Y=0);const i=this.totalHeight;i>0&&(console.log("###",t,i),this.Y=t/i)}scrollBottom(){this.posY=1,this.#a(),this.alignBottom&&this.totalHeight<this.height&&(this.area.style.top=this.height-this.totalHeight+"px")}onScrollY(){}onHeightChange(){}#a(){this.#n(),this.#s();const e=Math.floor(this.posY*this.totalHeight);this.onScrollY(e,this.totalHeight)}#r(){this.#o(),this.#s()}#o(){if(0!=this.totalHeight)if(this.totalHeight<=this.height)this.scroller.style.display="none";else{this.scroller.style.display="block",this.scroller.style.height=`${this.height}px`;const e=this.height/this.totalHeight;let t=this.height*e;t<20&&(t=20),this.slider.style.height=`${t}px`,this.sliderHeight=t,this.#n()}else this.scroller.style.display="none"}#n(){const e=Math.floor((this.height-this.sliderHeight)*this.posY);this.slider.style.top=`${e}px`}#s(){if(this.totalHeight<=this.height)return void(this.alignBottom?this.area.style.top=this.height-this.totalHeight+"px":this.area.style.top="0px");const e=this.totalHeight-this.height,t=Math.ceil(this.posY*e);this.area.style.top=-t+"px"}static createContent(e){const t=dom.createElement("div","slider"),i=dom.createElement("div","v-scroller");i.appendChild(t);const n=dom.createElement("div","shadow"),s=dom.createElement("div","content");s.setAttribute("tabindex","0");const r=dom.createElement("div","area");r.appendChild(n),r.appendChild(s),e.appendChild(i),e.appendChild(r),e.classList.add("scrollable")}static create(e){return Bs.createContent(e),new Bs(e)}static createElement(e){const t=dom.renderTemplate("scrollable");return e&&e.appendChild(t),t}static createMixin(e){return{area:e,...$s}}}Object.assign(Bs.prototype,$s);const Ns="hidden";class Fs{constructor(e){let t="string"==typeof e?document.getElementById(e):e;"TEMPLATE"==t.tagName&&(t=dom.renderTemplate(t.id)),this.container=t}set id(e){this.container.dataset.id=e}get id(){return this.container.dataset.id||this.container.id}get headerElement(){return this.container.querySelector(":scope > .header")}get editorElement(){return this.container.querySelector(".editor")}get active(){return!this.container.classList.contains(Ns)}get viewport(){return this.container.getBoundingClientRect()}set mode(e){e?this.container.setAttribute("mode",e):this.container.removeAttribute("mode")}onAction(){}onCommand(){}onEditorAction(){}onInput(){}onChange(){}onFilter(){}onKeyPress(){}onClick(){}onLinkClick(){}onElementClick(){}onResize(){}loadAutocomplete(){}static createHeader(e){const t=dom.createElement("div","header");return e.appendChild(t),t}static createEditor(e){const t=dom.createElement("div","editor");return e.appendChild(t),t}}const qs={hide(){this.container.classList.add(Ns)},show(){this.container.classList.remove(Ns)},getElementByClass(e){return this.container.querySelector(`:scope > .${e}`)},getButton(e){return this.container.querySelector(`button[name="${e}"]`)},showLoading(){const e=dom.createElement("div","loader");return this.container.appendChild(e),e},query(e){return this.container.querySelector(e)},appendChild(e,t=!1){t&&this.container.firstElementChild?dom.insertBefore(e,this.container.firstElementChild):this.container.appendChild(e)},removeChilds(){dom.removeChilds(this.container)},clearContent(){this.container.innerHTML=""},removeSelf(){dom.removeElement(this.container)},updateTimes(e=Date.now()){dom.updateElapsed(this.container,e)},addStyle(...e){this.container.classList.add(...e)},toggleLoading(e="loading3"){return this.container.classList.toggle(e)},addTemplate(e,t,i="div",...n){const s=dom.renderTemplate(e,t,i,...n);return this.container.appendChild(s),s},queryElement(e){return this.container.querySelector(e)},querySelector(e){return this.container.querySelector(e)},querySelectorAll(e){return this.container.querySelectorAll(e)}};Object.assign(Fs.prototype,qs);class Hs extends Fs{get sashElement(){return this.container.querySelector("div.v-sash")}get sidebarElement(){return this.container.querySelector("div.sidebar")}get meta(){return{}}static createMixin(e){return{container:e,...qs}}}class Us{constructor(){this.pages=new Map,this.current=null}get currentPage(){return this.pages.get(this.current)}}const Vs={addPage(e,t){let i=t;if("string"==typeof t){const n=document.getElementById(t);return i=new Hs(n),i.hide(),void this.pages.set(e,i)}return t.hide(),this.pages.set(e,t),i},switchTo(e){if(this.current==e)return this.pages.get(e);this.current&&this.pages.get(this.current).hide();const t=this.pages.get(e);return t&&(t.show(),this.current=e),t},getPage(e){return this.pages.get(e)},getCurrentPage(){return this.pages.get(this.current)},remove(e){let t;"string"==typeof e?(t=e,e=this.pages.get(t)):t=e.id;const i=e.container;dom.removeElement(i),this.pages.delete(t)}};Object.assign(Us.prototype,Vs);const Ws=Object.assign({addItem(e,t=!1){const i=e.create();return e.render(i),this.append(i),t&&this.area.insertBefore(i,this.area.firstElementChild),i},addItemTemplate(e,t,i=!1,...n){const s=this.elementTag||"div";let r=[];n.length>0&&Array.isArray(n[0])&&(r=n.shift());const o=dom.renderTemplate(e,t,s,...r);if(o.classList.add("item"),!o.dataset.id&&t.id&&(o.dataset.id=t.id),n.length>0&&o.classList.add(...n),this.append(o),i){let e=this.area.firstElementChild;"li"===s&&e&&"LH"==e.tagName&&(e=e.nextElementSibling),this.area.insertBefore(o,e)}return o},addGroup(e={},t=!1){return Ys.createGroup(this.area,e,t)},addContent(e={}){const t=Object.assign({template:"list-group-content",item:"list-base-item",hide:!1,empty:!1,draggable:!1,visible:-1>>>0},e),i=dom.renderTemplate(t.template,t);return t.name&&i.setAttribute("name",t.name),t.id&&(i.dataset.id=t.id),top?this.area.insertBefore(i,this.area.firstElementChild):this.area.appendChild(i),Xs(i,t)},wrapGroup(e,t){const i="string"==typeof e?this.area.querySelector(`[group="${e}"]`):e;return Ys.wrapGroup(i,t)},open(e){if(!e)return;const t=this.getElement(e);t&&!t.hasAttribute("selected")&&(this.clearSelection(),t.setAttribute("selected",""))},clearSelection(e){if(e){const t=this.getElement(e);t&&t.removeAttribute("selected")}else Ys.clearSelection(this.area)},getSelected(){return this.querySelector(".item[selected]")},selectItem(e){const t=this.getSelected();if(t){if(t.dataset.id==e)return;t.removeAttribute("selected")}const i=this.getElement(e);return i&&i.setAttribute("selected",""),i},delete(e){const t=this.getElement(e);return t&&t.parentElement.removeChild(t),t},getElement(e){return this.area.querySelector(`.item[data-id="${e}"]`)},getElements(e){const t=e?`.item[data-id="${e}"]`:".item[data-id]";return Array.from(this.querySelectorAll(t))},getLastElement(){return this.area.lastElementChild},getElementBy(e,t){return this.area.querySelector(`.item[data-${e}="${t}"]`)},getElementsBy(e,t){return this.area.querySelectorAll(`.item[data-${e}="${t}"]`)},getElementByClass(e){return this.area.querySelector(`.item.${e}`)},getElementIds(){return this.getElements().map((e=>e.dataset.id))},getItem(e){return this.area.querySelector(`:scope > .item[data-id="${e}"]`)},getItems(e,t,i=":scope > .item"){return e&&(i+=t?`[data-${e}="${t}"]`:`[data-${e}]`),this.area.querySelectorAll(i)},queryItems(e){const t=`:scope > .item ${e}`;return this.area.querySelectorAll(t)},registerClickHandlers(){this.area.onclick=e=>{const t=e.target;if(!Ys.handleClick(t,this)&&"BUTTON"===t.tagName){let e,i=t.closest(".item[data-id]");if(i)e=i.dataset.id;else{let i,n=t.closest(".group");i=n?n.querySelector("[group]"):t.closest("[group]"),i&&(e=i.getAttribute("group"))}this.onAction(t.name,e,t)}}},filter(e,t=".item"){if(!e||""==e)return void this.clearFilter();const i=new RegExp(e,"i"),n=this.getItems("name",null,t);for(const e of n){const t=e.dataset.name;i.test(t)?e.classList.remove("filter"):e.classList.add("filter")}},filterFields(e,...t){if(!e||""==e)return void this.clearFilter();const i=new RegExp(e,"i"),n=this.getItems();let s,r;for(const e of n){s=!1;for(const n of t)if(r=e.querySelector(`[role="${n}"]`),r&&i.test(r.innerText)){s=!0;break}s?e.classList.remove("filter"):e.classList.add("filter")}},clearFilter(){const e=this.querySelectorAll(".item.filter");for(const t of e)t.classList.remove("filter")},filterDelay(e,t,i=[".name"]){const n=()=>{const e=this.getItems();for(const t of e)dom.showElement(t)};console.debug("Filter:",e),this._filter=e.toLowerCase(),e.length<3?n():(this._filterTimeout&&clearTimeout(this._filterTimeout),this._filterTimeout=setTimeout((async()=>{if(this._filter.length<3)n();else{this.toggleLoading(),t.disabled=!0,await sleep(800),t.disabled=!1,t.focus(),this.toggleLoading();const e=this.getItems();for(const t of e){let e=!1;for(const n of i)if(-1!=t.querySelector(n).innerText.toLowerCase().search(this._filter)){e=!0;break}e?dom.showElement(t):dom.hideElement(t)}}delete this._filter,delete this._filterTimeout}),1e3))},sort(e){const t=this.getItems(),i=[].slice.call(t).sort(e);for(const e of i)this.area.appendChild(e)},clear(){const e=this.getElements();for(const t of e)dom.removeElement(t)},toggleLoading(){return dom.toggleLoading(this.area)},async loadGroups(){const e=this.area.querySelectorAll("[group][ds]");for(const t of e)await Ys.loadGroup(t)}},$s);class Ys extends Bs{set hover(e){e?this.containerElement.removeAttribute("nohover"):this.containerElement.setAttribute("nohover","")}scrollToItem(e){const t=this.getElement(e);t&&(this.scrollTo(t),dom.highlightElement(t))}static create(e){const t=Ys.createElement(e);return new Ys(t)}static createElement(e){const t=Bs.createElement(e);return t.classList.add("list2"),t.tabIndex=0,t}static createItemElement(e){const t=document.createElement("div");return t.classList.add("item",...e.template.split(" ")),e.id&&(t.dataset.id=e.id),e.draggable&&(t.draggable=!0,t.addEventListener("dragstart",(t=>e.setDraggableData(t.dataTransfer)))),t}static clearSelection(e){const t=e.querySelectorAll(".item[selected]");for(const e of t)e.removeAttribute("selected")}static createMixin(e,t="div"){return{area:e,elementTag:t,...Ws}}static createPageMixin(e,t="div"){return{container:e,area:e,elementTag:t,...qs,...Ws}}static createGroup(e,t,i=!1){const n=Object.assign({template:"list-group",item:"list-base-item",badge:!1,collapse:!0,hide:!1,empty:!1,draggable:!1,visible:-1>>>0},t);let s,r;if(n.template?(s=dom.renderTemplate(n.template,n),r=s.querySelector(".content")):(s=dom.createElement("div","list"),r=s),n.classes&&s.classList.add(...Array.isArray(n.classes)?n.classes:n.classes.split(" ")),n.badge&&s.classList.add("badge"),n.name&&s.setAttribute("name",n.name),n.id&&(s.dataset.id=n.id),i?e.insertBefore(s,e.firstElementChild):e.appendChild(s),n.help){const e=dom.renderTemplate(n.help);r.classList.add("help"),r.appendChild(e)}return Xs(r,n)}static wrapGroup(e,t){const i=Ys.createMixin(e),n=t||e.getAttribute("template")||"list-base-item",s=parseInt(e.getAttribute("visible")||5);return e.dataset.count||(e.dataset.count=s),i.add=function(t,i=!1,...s){const r=this.addItemTemplate(n,t,i,...s);if(this.childCount()>parseInt(e.dataset.count))if(i);else{dom.hideElement(r);const t=e.closest(".group");if(t){const e=t.querySelector('[name="_more"]');e&&dom.showElement(e)}}return r},i.get=function(e){return this.getItem(e)},i.load=async function(e){const t=await e.ls();for(const e of t)this.add(e)},i.push=function(...e){for(const t of e)this.add(t)},i}static async loadGroup(e){const t=Ys.wrapGroup(e),i=app.ds(e.getAttribute("ds"));let n,s,r;t.toggleLoading(),n=await delayResolve(i.load(t),1200),t.toggleLoading(),r=e.closest(".group"),r&&(s=r.querySelector('[name="_more"]'),s&&(n?dom.showElement(s):dom.hideElement(s)))}static handleClick(e,t){if("BUTTON"==e.tagName)switch(e.name){case"_less":{const t=e.parentElement.nextElementSibling,i=parseInt(t.getAttribute("visible")),n=Zs(t).reverse(),s=n.length-i>=i?i:n.length-i;for(let e=0;e<s;++e)dom.hideElement(n[e]);t.classList.add("more"),n.length-s<=i&&t.parentElement.classList.remove("less")}return!0;case"_up":{const t=e.closest(".group");if(t){let e;for(;e=t.previousElementSibling,e&&e.classList.contains("group")&&(dom.moveUp(t),!dom.isElementVisible(e)););}}return!0;case"rm":{const t=e.closest(".item");if(t){const e=t.closest("[group]");if(e){const t=e.querySelector(":scope > .item.hidden");t&&dom.showElement(t),e.closest(".group")}dom.removeElement(t)}}}else if("A"==e.tagName)switch(e.name){case"_more":{const t=e.closest(".group");if(t){const i=t.querySelector("[group]");if(i){const t=parseInt(i.getAttribute("visible")||5),n=parseInt(i.dataset.count||t);i.dataset.count=n+t;const s=Zs(i,!1).slice(0,t);for(const e of s)dom.showElement(e);s.length<t&&(dom.hideElement(e),i.hasAttribute("ds")&&Ys.loadGroup(i))}const n=t.querySelector('[name="_less"]');n&&dom.showElement(n)}}return!0;case"_less":{const t=e.closest(".group");if(t){const i=t.querySelector("[group]");if(i){const t=parseInt(i.getAttribute("visible")||5),n=parseInt(i.dataset.count||t),s=n-t;i.dataset.count=s;const r=Zs(i),o=t-(n-r.length);for(const e of r.reverse().slice(0,o))dom.hideElement(e);s==t&&dom.hideElement(e)}const n=t.querySelector('[name="_more"]');n&&dom.showElement(n)}}return!0}else{if(e.hasAttribute("grouphdr"))return e.parentElement.classList.toggle("collapsed"),!0;if(e.hasAttribute("group")&&e.classList.contains("more")){const t=parseInt(e.getAttribute("visible")),i=e.querySelectorAll(":scope > .item.hidden"),n=Math.min(i.length,t);for(let e=0;e<n;++e)dom.showElement(i[e]);return i.length<=t&&e.classList.remove("more"),e.parentElement.classList.add("less"),!0}}if(t&&e.classList.contains("item")){const i=e.dataset.id;t.onClick(i,e)}}}function Xs(e,t){return t.hide&&e.classList.add("hidable"),t.empty&&e.classList.add("show-empty"),t.count&&e.classList.add("count"),t.hideFirst&&e.classList.add("hide-first"),t.cmd&&e.setAttribute("cmd",t.cmd),t.ds&&e.setAttribute("ds",t.ds),t.item&&e.setAttribute("template",t.item),{count:0,...Ys.createMixin(e),addTemplate(i,n,s=!1,r=[],...o){let a=!1;if(t.visible){const i=t.visible;a=!s,this.count>i?e.classList.add("more"):this.count<i&&(a=!1)}++this.count;const l=this.addItemTemplate(i,n,s,r,...o);return t.draggable&&(l.draggable=!0),a&&dom.hideElement(l),l},add(...e){return this.addTemplate(t.item,...e)},get(e){return this.getItem(e)},async load(e,t){const i=await e.ls();t&&i.sort(t);for(const e of i)this.add(e)},push(...e){for(const t of e)this.add(t)}}}function Zs(e,t=!0){const i=t?":not(.hidden)":".hidden";return Array.from(e.querySelectorAll(":scope > .item"+i))}Object.assign(Ys.prototype,Ws);class Ks extends Hs{get scrollableElement(){return this.query(".editor .scrollable")}get scrollableContent(){return this.query(".editor .scrollable > .area > .content")}set bottom(e){this.area.setAttribute("bottom","")}get height(){return this.scrollableElement.getBoundingClientRect().height}constructor(e,t={}){let i;i=e?"string"==typeof e?document.getElementById(e):e:dom.renderTemplate("editor-base",t,"div","editor-header-grid","editor-scrollable"),i.querySelector("div.header")||Ks.createHeader(i);let n=i.querySelector("div.editor");n||(n=Ks.createEditor(i));let s=n.querySelector(".scrollable");s||(s=Bs.createElement(n)),super(i),this.area=s.querySelector(".content")}onScrollY(){}onResize(){}registerEvents(){}}Object.assign(Ks.prototype,$s);class Gs extends Ks{constructor(e){super(e),this.scrollableElement.classList.add("list2")}}Object.assign(Gs.prototype,Ws);class Js extends Gs{onFilter(e){1!=e.length&&this.filter(e)}}class Qs extends Js{pages=new Map;get currentPage(){return this.pages.get(this.current)}}Object.assign(Qs.prototype,Vs),window.UX={Scrollable:Bs,ScrollableMixin:$s,List:Ys,ListMixin:Ws,ListItem:class{constructor(e){this.info=e}get template(){return"column"}get id(){return this.info.id}get draggable(){return!1}create(){return Ys.createItemElement(this)}render(){}},Page:Hs,PageController:Us,PageControllerMixin:Vs,ScrollablePage:Ks,ListPage:Js,ListPageController:Qs};class er{#l=!1;get name(){return"app"}get version(){return 1}get isSetup(){return this.#l}async init(){if(!window.indexedDB)throw console.log("Your browser doesn't support IndexedDB"),new Error("IndexDB is not supported");this.db=await this.#c(),this.isSetup&&await this.setup()}needSetup(e){return 0==e}setup(){}ls(e,t=!1,i=0,n=100){return this.#h(nr(e),t,i,n)}tail(e,t=0,i=50){return this.#h(nr(e),!0,t,i)}lsByIndex(e,t,i,n=!1,s=30,r=0){return this.#d(nr(e),t,i,r,s,n)}lsByRating(e,t,i){return this.#u(nr(e),"rating",t,i,!0)}lsByRange(e,t,i,n,s=!1,r=50){return this.#p(nr(e),t,i,n,s,r)}latest(e,t=0,i=100){return this.#d(nr(e),"ts",Date.seconds(),t,i,!0)}count(e){return this.#m(nr(e))}put(e,t){return er.put(this.db,nr(e),t)}update(e,...t){return this.#a(nr(e),...t)}updateByIndex(e,...t){return this.#g(nr(e),...t)}push(e,...t){return this.#f(nr(e),...t)}get(e,t){return this.#v(nr(e),t)}rm(e,t){return this.#y(nr(e),t)}rmByIndex(e,t,i){return this.#b(nr(e),t,i)}pushValue(e,t,i,n){return this.#w(nr(e),t,i,n)}pushValueByIndex(e,t,i,n,s){return this.#k(nr(e),t,i,n,s)}deleteValue(e,...t){return this.#x(nr(e),...t)}deleteValueByIndex(e,...t){return this.#_(nr(e),...t)}add(e,t){return this.#C(nr(e),t)}getById(e){return this.#v(kContact,e)}getByEmail(e){return this.#E(kContact,"email",e)}getByIndex(e,t,i){return this.#E(e,t,i)}#c(){const e=this.name,t=this.version;return new Promise(((i,n)=>{const s=indexedDB.open(e,t);s.onerror=e=>{console.error(`Database error: ${e.target.errorCode}`),n(e.target.errorCode)},s.onsuccess=e=>{const t=e.target.result;i(t)},s.onupgradeneeded=e=>{const t=e.target.result,i=e.target.transaction,n=e.oldVersion;this.onUpgrade(t,i,n),this.needSetup(n)&&(this.#l=!0)}}))}#d(e,t,i,n=0,s=50,r=!1){return new Promise(((o,a)=>{const l=this.db.transaction(e,"readonly").objectStore(e),c=i?IDBKeyRange.only(i):IDBKeyRange.lowerBound(0),h=l.index(t).openCursor(c,r?"prev":"next");let d=0==n,u=0;const p=[];h.onsuccess=e=>{const t=e.target.result;if(t)if(d){const e=t.value;p.push(e),u++,u<s?t.continue():o(p)}else d=!0,t.advance(n);else o(p)},h.onerror=e=>{a(e)}}))}addOne(e,t){return new Promise(((i,n)=>{let s=this.db.transaction(e,"readwrite").objectStore(e).add(t);s.onsuccess=i,s.onerror=n}))}#y(e,t){return new Promise(((i,n)=>{const s=this.db.transaction(e,"readwrite").objectStore(e);let r=t?s.delete(t):s.clear();r.onsuccess=function(e){i()},r.onerror=function(e){console.log(e.target.errorCode),n(e.target.errorCode)}}))}#b(e,t,i){return new Promise(((n,s)=>{const r=this.db.transaction(e,"readwrite").objectStore(e).index(t).openCursor(i);r.onerror=n,r.onsuccess=e=>{const t=e.target.result;t?(t.delete(),t.continue()):n()}}))}#C(e,t){const i=this.db.transaction(e,"readwrite").objectStore(e);Array.isArray(t)||(t=[t]),console.log("IndexDB: adding new entries =>",e,"\n",t.map((e=>e.id)));const n=[];for(const e of t)n.push(new Promise(((t,n)=>{let s=i.add(e);s.onsuccess=function(e){t()},s.onerror=n})));return Promise.all(n)}#a(e,t,i,n={}){return new Promise(((s,r)=>{const o=this.db.transaction(e,"readwrite").objectStore(e),a=o.openCursor(IDBKeyRange.only(t));a.onsuccess=e=>{const a=e.target.result;let l;if(a){const e=Object.assign(a.value,i);Object.deleteUndefined(e),l=a.update(e)}else{const e={id:t,...n,...i};l=o.add(e)}l.onsuccess=function(e){s()},l.onerror=r},a.onerror=r}))}#g(e,t,i,n,s={}){return new Promise(((r,o)=>{const a=this.db.transaction(e,"readwrite").objectStore(e),l=a.index(t).openCursor(i);l.onsuccess=e=>{const t=e.target.result;let i;if(t){const e=Object.assign(t.value,n);Object.deleteUndefined(e),i=t.update(e)}else{const e={...s,...n};i=a.add(e)}i.onsuccess=function(e){r()},i.onerror=o},l.onerror=o}))}#w(e,t,i,n){return new Promise(((s,r)=>{const o=this.db.transaction(e,"readwrite").objectStore(e).openCursor(IDBKeyRange.only(t));tr(i,n,o,s,r)}))}#k(e,t,i,n,s){return new Promise(((r,o)=>{const a=this.db.transaction(e,"readwrite").objectStore(e).index(t).openCursor(i);tr(n,s,a,r,o)}))}#x(e,t,i,n){return new Promise(((s,r)=>{const o=this.db.transaction(e,"readwrite").objectStore(e).openCursor(IDBKeyRange.only(t));ir(i,n,o,s,r)}))}#_(e,t,i,n,s){return new Promise(((r,o)=>{const a=this.db.transaction(e,"readwrite").objectStore(e).index(t).openCursor(i);ir(n,s,a,r,o)}))}#f(e,t,i,n){return new Promise(((s,r)=>{const o=this.db.transaction(e,"readwrite").objectStore(e).openCursor(IDBKeyRange.only(t));o.onsuccess=e=>{const t=e.target.result;let o;if(!t)return r("Appending to non-existing record");const a=t.value;a[i]?a[i].push(n):a[i]=[n],a.ts&&(a.ts=Date.seconds()),o=t.update(a),o.onsuccess=function(e){console.log(e),s()},o.onerror=function(e){console.log(e.target.errorCode),r(e.target.errorCode)}},o.onerror=r}))}#v(e,t){return new Promise(((i,n)=>{let s=this.db.transaction(e,"readonly").objectStore(e).get(t);s.onsuccess=e=>{e.target.result?i(e.target.result):i(null)},s.onerror=n}))}#E(e,t,i){return new Promise(((n,s)=>{let r=this.db.transaction(e,"readonly").objectStore(e).index(t).get(i);r.onsuccess=e=>{n(r.result)},r.onerror=s}))}#h(e,t,i,n){return new Promise(((i,s)=>{const r=this.db.transaction(e,"readonly").objectStore(e),o=[],a=r.openCursor(null,t?"prev":"next");let l=0;a.onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;o.push(e),++l<n?t.continue():i(o)}else i(o)},a.onerror=s}))}#u(e,t,i=0,n=50,s=!1){return new Promise(((r,o)=>{const a=this.db.transaction(e,"readonly").objectStore(e),l=IDBKeyRange.lowerBound(0),c=a.index(t).openCursor(l,s?"prev":"next");let h=0==i,d=0;const u=[];c.onsuccess=e=>{const t=e.target.result;if(t)if(h){const e=t.value;u.push(e),d++,d<n?t.continue():r(u)}else h=!0,t.advance(i);else r(u)},c.onerror=o}))}#p(e,t,i,n,s=!1,r=50){return new Promise(((o,a)=>{const l=this.db.transaction(e,"readonly").objectStore(e);let c;c=i?n?IDBKeyRange.bound(i,n,!1,!0):IDBKeyRange.lowerBound(i):IDBKeyRange.upperBound(n,!0);const h=l.index(t).openCursor(c,s?"prev":"next"),d=[];let u=0;h.onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;d.push(e),++u<r?t.continue():o(d)}else o(d)},h.onerror=a}))}#m(e){return new Promise(((t,i)=>{const n=this.db.transaction(e,"readonly").objectStore(e).count();n.onsuccess=e=>{const i=e.target.result;t(i)},n.onerror=i}))}#S(e){return new Promise(((t,i)=>{const n=this.db.transaction(e,"readonly").objectStore(e).clear();n.onsuccess=()=>t(),n.onerror=i}))}delete(e,t,i,n){return new Promise(((s,r)=>{const o=this.db.transaction(e,"readwrite").objectStore(e);let a,l;t?(a=i==n?IDBKeyRange.only(i):i?n?IDBKeyRange.bound(i,n,!1,!0):IDBKeyRange.lowerBound(i):IDBKeyRange.upperBound(n,!0),l=o.index(t).openCursor(a)):l=o.openCursor(),l.onsuccess=e=>{let t=e.target.result;t?(t.delete(),t.continue()):s()},l.onerror=r}))}static put(e,t,i){const n=e.transaction(t,"readwrite").objectStore(t);Array.isArray(i)||(i=[i]);const s=[];for(const e of i)s.push(new Promise(((t,i)=>{let s=n.put(e);s.onsuccess=function(e){t()},s.onerror=i})));return Promise.all(s)}static addTable=sr;static addIndex=or;static deleteTable=rr;static deleteIndex=ar}function tr(e,t,i,n,s){i.onsuccess=i=>{const r=i.target.result;let o;if(r){const i=r.value;i[e]||(i[e]=[]),Array.isArray(t)?i[e].push(...t):i[e].push(t),o=r.update(i),o.onsuccess=n,o.onerror=s}else n()},i.onerror=s}function ir(e,t,i,n,s){i.onsuccess=i=>{const r=i.target.result;let o;if(r){const i=r.value,a=i[e];Array.isArray(a)&&t?i[e]=a.filter((e=>e!=t)):delete i[e],o=r.update(i),o.onsuccess=function(e){n()},o.onerror=s}else n()},i.onerror=s}function nr(e){return"article"===e?"news":e}function sr(e,t,i=!1,n="id"){const s={keyPath:n,autoIncrement:i};e.createObjectStore(t,s)}function rr(e,t){e.deleteObjectStore(t)}function or(e,t,i,n=!1,s=t){i.objectStore(e).createIndex(s,t,{unique:n})}function ar(e,t,i){i.objectStore(e).deleteIndex(t)}class lr{#A;#T="stopped";#j="player";#L=[];#D=[];#O;#I;#z=!1;#P=[];#M;#R={repeat:!1,shuffle:!1};get queueCount(){return this.#L.length}get recent(){return this.#D.reverse()}get videoElement(){return this.#A}get isPlaying(){return"playing"==this.#T}get current(){return this.#O}get currentTime(){return this.#A.currentTime}get duration(){return this.#A.duration}get repeat(){return this.#R.repeat}get shuffle(){return this.#R.shuffle}constructor(){const e=function(){const e=dom.createElement("video");return e.controls=!0,e.disablePictureInPicture=!0,e.disableRemotePlayback=!0,e.setAttribute("controlslist","nodownload"),e}();e.onplaying=()=>this.#$(),e.onended=()=>this.#B(),e.onpause=()=>this.#N(),e.onloadedmetadata=e=>{console.log("METADATA loaded",e)},getSettings("player",this.#R),this.#A=e,this.#F()}wrapProgress(e){this.#P.push(e)}registerEvents(){app.on("call",(e=>this.#q(e.detail))),app.on("hangup",(e=>this.#H(e.detail)))}pause(){console.log("PLAYER: pausing track"),this.#U(),this.#T="paused"}resume(){console.log("PLAYER: resuming track"),this.#A.play()}playYoutube(e){const t=e.dataset.id;if(console.debug("Player: loading yt =>",t),this.#I){this.#I.stopVideo();const e=document.getElementById("player"),t=e.previousElementSibling;dom.showElement(t),dom.removeElement(e)}dom.hideElement(e);const i=dom.createElement("div");i.id="player",dom.insertAfter(i,e),this.#I=new YT.Player("player",{videoId:t,events:{onReady:function(e){console.debug("YT on ready"),e.target.playVideo()}}})}onYoutubeStateChange(){console.debug("YT player state change")}onYoutubeError(e){console.error("YT player on error",e)}playFile(e,t=!1){if(!t||!(this.#L.length>0||"stopped"!=this.#T))return this.#V(e);this.#L.includes(e)||(this.#L.push(e),app.emit("trackqueued",e))}playNext(){if(0==this.#L.length)return;let e;if(this.shuffle){const t=Math.floor(Math.random()*this.#L.length);[e]=this.#L.splice(t,1)}else e=this.#L.shift();return this.#V(e)}playPrev(){if(this.#D.length<2)return;const e=this.#D[this.#D.length-2];return this.#V(e.id)}clear(){this.#D=[]}remove(e){const t=this.#L.indexOf(e);-1!=t&&this.#L.splice(t,1)}seek(e){if("playing"!=this.#T)return;const t=e/100,i=Math.floor(this.duration*t);console.debug("# Player on seek:",i),this.#A.currentTime=i}playRadio(e,t){console.debug("Play radio request:",e,t),this.#W(e,t)}toggleRepeat(){return this.#R.repeat=!this.#R.repeat,this.#Y(),this.repeat}toggleShuffle(){return this.#R.shuffle=!this.#R.shuffle,this.#Y(),this.shuffle}#Y(){localStorage.setItem("player",JSON.stringify(this.#R))}async#F(){try{this.#D=await app.db.latest("audio")}catch(e){console.error("Player failed to load recent")}}#W(e,t){if(this.#z)switch(t){case"play":this.#A.src,this.resume();break;case"pause":this.pause()}else this.pause(),this.#z=!0,this.#A.src="http://127.0.0.1:8000/test",this.resume()}async#V(e){let t;this.#D.length>50&&this.#D.shift(),"object"==typeof e&&(t=e,e=t.id);const i=this.#D.findIndex((t=>t.id==e));-1!=i?(t=this.#D[i],this.#D.splice(i,1)):t||(t=await app.db.get("audio",e)),t.rating++,await app.db.update("audio",e,{rating:t.rating,ts:Date.seconds()}),this.#O=t,this.#D.push(t);const n=this.#A.src;n&&!n.startsWith("http")&&URL.revokeObjectURL(n);const s=URL.createObjectURL(t.file);this.#A.src=s,this.#A.play()}#q(){"playing"===this.#T&&this.#U()}#H(){"playing"===this.#T&&this.#X()}#U(){this.#A.pause()}#X(){this.#A.play()}#Z(e){}async#$(){if(console.log("Player: on playing, radio:",this.#z),this.#T="playing",this.#z)return;const e=Math.round(this.duration);this.#K();let t=!0;this.#O.meta?this.#O.meta.duration?t=!1:this.#O.meta.duration=e:this.#O.meta={duration:e},t&&await app.db.update("audio",this.#O.id,{meta:this.#O.meta});const{id:i,rating:n,file:s,type:r}=this.#O,o={id:i,rating:n,file:s,type:r,duration:e},a=this.#O.meta;a&&(o.meta=a,o.title=fileX.getTitleFromMeta(o),o.desc=fileX.getDescriptionFromMeta(o)),app.addRecent("player",o),app.emit("trackchange",o)}#N(){console.log("Player: on paused"),this.#G(),app.emit("trackpause")}#B(){console.log("Player: on end"),this.#L.length>0?this.playNext():this.repeat?(this.#L=[...this.#D],app.emit("trackqueued",this.#L),this.playNext()):(this.#G(),this.#T="stopped",app.emit("trackstop"))}#K(){if(!this.#M){for(const e of this.#P)e.resume();this.#M=setInterval((()=>{const e=this.currentTime,t=this.duration;for(const i of this.#P)i.update(e,t);app.emit("trackprogress",{sec:e,total:t})}),1e3)}}#G(){if(this.#M){clearInterval(this.#M),this.#M=null;for(const e of this.#P)e.pause()}}}const cr="base16-dark";async function hr(){}function dr(e){const t={js:"javascript",md:{name:"markdown",highlightFormatting:!0},html:"htmlmixed",css:"css"}[e];if(!t)throw new Error("Unsupported code editor mode:",e);return t}function ur(e={mode:"js"}){return Object.assign({keyMap:"vim",lineNumbers:!0,autoRefresh:!0,lineWrapping:!0,scrollbarStyle:"overlay",foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{"Ctrl-Space":"autocomplete"},autoCloseTags:!0,matchBrackets:!0,autoCloseBrackets:!0},e)}const pr=class{static createTextArea(e){const t=document.createElement("textarea");return e.appendChild(t),CodeMirror.fromTextArea(t,{mode:"javascript",keyMap:"vim",lineNumbers:!0,autoRefresh:!0,lineWrapping:!0,scrollbarStyle:"overlay",foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]})}static async create(e,t="js",i=!1){const n=dr(t);await hr();const s=ur({mode:n});return i&&(s.theme=cr),console.log("Creating CodeMirror editor",s),CodeMirror(e,s)}static async bind(e,t="js",i=!1){const n=dr(t);await hr();const s=ur({mode:n,height:"auto",viewportMargin:1/0});return i&&(s.theme=cr),console.log("Binding CodeMirror editor",s),CodeMirror.fromTextArea(e,s)}};function mr(e,t){var i;function n(e){if(!e)return!1;!function(e){for(var t=0;t<e.length;t++)e[t].classList.remove("autocomplete-active")}(e),i>=e.length&&(i=0),i<0&&(i=e.length-1),e[i].classList.add("autocomplete-active")}function s(t){for(var i=document.getElementsByClassName("autocomplete-items"),n=0;n<i.length;n++)t!=i[n]&&t!=e&&i[n].parentNode.removeChild(i[n])}console.log("Autocompleteenabled for:",e.name),e.addEventListener("input",(function(n){console.log("Autocomplete input: input");var r,o,a,l=this.value;if(s(),delete this.dataset.id,!l)return!1;i=-1;const c=[];for(const e of t)(a="string"==typeof e?e:e.name).substr(0,l.length).toUpperCase()==l.toUpperCase()&&c.push(e);if(0==c.length)return;(r=dom.createElement("div","autocomplete-items")).setAttribute("id",this.id+"autocomplete-list"),console.log("Setting width: ",this.getBoundingClientRect().width),r.style.maxWidth=`${this.getBoundingClientRect().width}px`;const h=Bs.create(r);this.parentNode.appendChild(r);for(const t of c){o=dom.createElement("div","item");const i="object"==typeof t;let n="";i?(t.photo?n+=`<img src="${t.photo}" class="photo">`:t.icon,n+=`<i class="${t.icon}"></i>`,a=t.name):a=t,n+="<strong>"+a.substr(0,l.length)+"</strong>",n+=a.substr(l.length),i&&t.id?n+=`<input type="hidden" value="${a}" data-id="${t.id}">`:n+="<input type='hidden' value='"+a+"'>",o.innerHTML=n,o.addEventListener("click",(function(t){const i=this.getElementsByTagName("input")[0];e.value=i.value,i.dataset.id&&(e.dataset.id=i.dataset.id),s()})),h.append(o)}h.registerEvents()})),e.addEventListener("keydown",(function(e){console.log("KeyDown",this.id);var t=document.getElementById(this.id+"autocomplete-list");t&&(t=t.getElementsByClassName("item")),40==e.keyCode?(i++,n(t)):38==e.keyCode?(i--,n(t)):13==e.keyCode&&(e.preventDefault(),i>-1&&t&&t[i].click())})),document.addEventListener("click",(function(e){s(e.target)}))}function gr(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))}function fr(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)}function vr(e,t,i,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,i):s?s.value=i:t.set(e,i),i}async function yr(e,t={}){const{local:i=!1,version:n="latest",cdnUrl:s,...r}=t,o=function(e,t,i){let n=`https://cdn.jsdelivr.net/npm/emojibase-data@${t}/${e}`;return"function"==typeof i?n=i(e,t):"string"==typeof i&&(n=`${i}/${e}`),n}(e,n,s),a=i?localStorage:sessionStorage,l=`emojibase/${n}/${e}`,c=a.getItem(l);if(c)return Promise.resolve(JSON.parse(c));const h=await fetch(o,{credentials:"omit",mode:"cors",redirect:"error",...r});if(!h.ok)throw new Error("Failed to load Emojibase dataset.");const d=await h.json();try{a.setItem(l,JSON.stringify(d))}catch{}return d}const br={discord:"joypixels",slack:"iamcal"};async function wr(e,t,i){var n;return yr(`${e}/shortcodes/${null!==(n=br[t])&&void 0!==n?n:t}.json`,i)}function kr(e,t){if(0===t.length)return e;const i=new Set(e.shortcodes);return t.forEach((t=>{const n=t[e.hexcode];Array.isArray(n)?n.forEach((e=>i.add(e))):n&&i.add(n)})),e.shortcodes=[...i],e.skins&&e.skins.forEach((e=>{kr(e,t)})),e}async function xr(e,t={}){const{compact:i=!1,flat:n=!1,shortcodes:s=[],...r}=t,o=await yr(`${e}/${i?"compact":"data"}.json`,r);let a=[];return s.length>0&&(a=await Promise.all(s.map((t=>{let i;if(t.includes("/")){const[e,n]=t.split("/");i=wr(e,n,r)}else i=wr(e,t,r);return i.catch((()=>({})))})))),n?function(e,t=[]){const i=[];return e.forEach((e=>{if(e.skins){const{skins:n,...s}=e;i.push(kr(s,t)),n.forEach((e=>{const n={...e};s.tags&&(n.tags=[...s.tags]),i.push(kr(n,t))}))}else i.push(kr(e,t))})),i}(o,a):function(e,t){return 0===t.length||e.forEach((e=>{kr(e,t)})),e}(o,a)}async function _r(e,t){return yr(`${e}/messages.json`,t)}function Cr(e,t){const i=e.target.closest("[data-emoji]");if(i){const e=t.find((e=>e.emoji===i.dataset.emoji));if(e)return e}return null}function Er(e){var t;const i=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"(prefers-reduced-motion: reduce)");return e.animate&&!(null==i?void 0:i.matches)}function Sr(e,t){return e.toLowerCase().includes(t.toLowerCase())}function Ar(e,t,i,n){return Er(n)&&e.animate?e.animate(t,i).finished:Promise.resolve()}function Tr(e){var t;const i=document.createElement("template");return i.innerHTML=e,null===(t=i.content)||void 0===t?void 0:t.firstElementChild}function jr(e){return gr(this,void 0,void 0,(function*(){try{return(yield fetch(e,{method:"HEAD"})).headers.get("etag")}catch(e){return null}}))}function Lr(e,t,i){return gr(this,void 0,void 0,(function*(){const n=i||t(e);return yield n.open(),n}))}function Dr(e,t,i,n,s){return gr(this,void 0,void 0,(function*(){return i&&n?function(e,t,i,n,s){return gr(this,void 0,void 0,(function*(){const r=yield Lr(e,t,s),o=yield function(e){return gr(this,void 0,void 0,(function*(){const t=(new TextEncoder).encode(e),i=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map((e=>e.toString(16).padStart(2,"0"))).join("")}))}(n);return(yield r.isPopulated())&&!(yield function(e,t){return gr(this,void 0,void 0,(function*(){const i=yield e.getHash();return t!==i}))}(r,o))||(yield r.populate({groups:i.groups,emojis:n,hash:o})),r}))}(e,t,i,n,s):function(e,t,i){return gr(this,void 0,void 0,(function*(){const n=yield Lr(e,t,i),[s,r]=yield function(e){const{emojisUrl:t,messagesUrl:i}=function(e,t){const i="/ui/lib/picmo";return{emojisUrl:`${i}/data.json`,messagesUrl:`${i}/messages.json`}}();try{return Promise.all([jr(t),jr(i)])}catch(e){return Promise.all([null,null])}}();if(yield n.isPopulated())s&&r&&(yield function(e,t,i){return gr(this,void 0,void 0,(function*(){let n;try{n=yield e.getEtags()}catch(e){n={}}const{storedEmojisEtag:s,storedMessagesEtag:r}=n;if(i!==r||t!==s){const[n,s]=yield Promise.all([_r(e.locale),xr(e.locale)]);yield e.populate({groups:n.groups,emojis:s,emojisEtag:t,messagesEtag:i})}}))}(n,s,r));else{const[t,i]=yield Promise.all([_r(e),xr(e)]);yield n.populate({groups:t.groups,emojis:i,emojisEtag:s,messagesEtag:r})}return n}))}(e,t,s)}))}var Or,Ir,zr,Pr;class Mr{constructor(){Or.add(this),Ir.set(this,new Map)}on(e,t,i){fr(this,Or,"m",Pr).call(this,e,t,i)}once(e,t,i){fr(this,Or,"m",Pr).call(this,e,t,i,!0)}off(e,t){const i=fr(this,Or,"m",zr).call(this,e);fr(this,Ir,"f").set(e,i.filter((e=>e.handler!==t)))}emit(e,...t){fr(this,Or,"m",zr).call(this,e).forEach((i=>{i.handler.apply(i.context,t),i.once&&this.off(e,i.handler)}))}removeAll(){fr(this,Ir,"f").clear()}}Ir=new WeakMap,Or=new WeakSet,zr=function(e){return fr(this,Ir,"f").has(e)||fr(this,Ir,"f").set(e,[]),fr(this,Ir,"f").get(e)},Pr=function(e,t,i,n=!1){fr(this,Or,"m",zr).call(this,e).push({context:i,handler:t,once:n})};class Rr extends Mr{}class $r extends Mr{}class Br{constructor({template:e,classes:t,parent:i}){this.isDestroyed=!1,this.appEvents={},this.uiEvents=[],this.uiElements={},this.ui={},this.template=e,this.classes=t,this.parent=i,this.keyBindingHandler=this.keyBindingHandler.bind(this)}initialize(){this.bindAppEvents()}setCustomEmojis(e){this.customEmojis=e}setEvents(e){this.events=e}setPickerId(e){this.pickerId=e}emit(e,...t){this.events.emit(e,...t)}setI18n(e){this.i18n=e}setRenderer(e){this.renderer=e}setEmojiData(e){this.emojiDataPromise=e,e.then((e=>{this.emojiData=e}))}updateEmojiData(e){this.emojiData=e,this.emojiDataPromise=Promise.resolve(e)}setOptions(e){this.options=e}renderSync(e={}){return this.el=this.template.renderSync(Object.assign({classes:this.classes,i18n:this.i18n,pickerId:this.pickerId},e)),this.postRender(),this.el}render(e={}){return gr(this,void 0,void 0,(function*(){return yield this.emojiDataPromise,this.el=yield this.template.renderAsync(Object.assign({classes:this.classes,i18n:this.i18n,pickerId:this.pickerId},e)),this.postRender(),this.el}))}postRender(){this.bindUIElements(),this.bindKeyBindings(),this.bindUIEvents(),this.scheduleShowAnimation()}bindAppEvents(){Object.keys(this.appEvents).forEach((e=>{this.events.on(e,this.appEvents[e],this)})),this.events.on("data:ready",this.updateEmojiData,this)}unbindAppEvents(){Object.keys(this.appEvents).forEach((e=>{this.events.off(e,this.appEvents[e])})),this.events.off("data:ready",this.updateEmojiData)}keyBindingHandler(e){const t=this.keyBindings[e.key];t&&t.call(this,e)}bindKeyBindings(){this.keyBindings&&this.el.addEventListener("keydown",this.keyBindingHandler)}unbindKeyBindings(){this.keyBindings&&this.el.removeEventListener("keydown",this.keyBindingHandler)}bindUIElements(){this.ui=Object.keys(this.uiElements).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.el.querySelector(this.uiElements[t])})),{})}bindUIEvents(){this.uiEvents.forEach((e=>{e.handler=e.handler.bind(this),(e.target?this.ui[e.target]:this.el).addEventListener(e.event,e.handler,e.options)}))}unbindUIEvents(){this.uiEvents.forEach((e=>{(e.target?this.ui[e.target]:this.el).removeEventListener(e.event,e.handler)}))}destroy(){this.unbindAppEvents(),this.unbindUIEvents(),this.unbindKeyBindings(),this.el.remove(),this.isDestroyed=!0}scheduleShowAnimation(){if(this.parent){const e=new MutationObserver((t=>{const[i]=t;"childList"===i.type&&i.addedNodes[0]===this.el&&(Er(this.options)&&this.animateShow&&this.animateShow(),e.disconnect)}));e.observe(this.parent,{childList:!0})}}static childEvent(e,t,i,n={}){return{target:e,event:t,handler:i,options:n}}static uiEvent(e,t,i={}){return{event:e,handler:t,options:i}}static byClass(e){return`.${e}`}}var Nr={emojiCategory:"EmojiCategory_emojiCategory__7G3mq",categoryName:"EmojiCategory_categoryName__zHcOq",noRecents:"EmojiCategory_noRecents__Pk1Ys",recentEmojis:"EmojiCategory_recentEmojis__CybhN"};class Fr extends Br{constructor({template:e,category:t,showVariants:i,lazyLoader:n}){super({template:e,classes:Nr}),this.baseUIElements={categoryName:Br.byClass(Nr.categoryName)},this.category=t,this.showVariants=i,this.lazyLoader=n}setActive(e,t,i){this.emojiContainer.setActive(e,t,i)}}var qr={icon:"icons_icon__YUQ3S","icon-small":"icons_icon-small__fEcU6","icon-medium":"icons_icon-medium__e5lKJ","icon-large":"icons_icon-large__t5mwg","icon-2x":"icons_icon-2x__on8is","icon-3x":"icons_icon-3x__RBDYg","icon-4x":"icons_icon-4x__UjvXP","icon-5x":"icons_icon-5x__zRG9K","icon-8x":"icons_icon-8x__PsCPS","icon-10x":"icons_icon-10x__WLjku"};const Hr={clock:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512zM232 256C232 264 236 271.5 242.7 275.1L338.7 339.1C349.7 347.3 364.6 344.3 371.1 333.3C379.3 322.3 376.3 307.4 365.3 300L280 243.2V120C280 106.7 269.3 96 255.1 96C242.7 96 231.1 106.7 231.1 120L232 256z"/></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M64 496C64 504.8 56.75 512 48 512h-32C7.25 512 0 504.8 0 496V32c0-17.75 14.25-32 32-32s32 14.25 32 32V496zM476.3 0c-6.365 0-13.01 1.35-19.34 4.233c-45.69 20.86-79.56 27.94-107.8 27.94c-59.96 0-94.81-31.86-163.9-31.87C160.9 .3055 131.6 4.867 96 15.75v350.5c32-9.984 59.87-14.1 84.85-14.1c73.63 0 124.9 31.78 198.6 31.78c31.91 0 68.02-5.971 111.1-23.09C504.1 355.9 512 344.4 512 332.1V30.73C512 11.1 495.3 0 476.3 0z"/></svg>',frown:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240zM336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176zM259.9 369.4C288.8 369.4 316.2 375.2 340.6 385.5C352.9 390.7 366.7 381.3 361.4 369.1C344.8 330.9 305.6 303.1 259.9 303.1C214.3 303.1 175.1 330.8 158.4 369.1C153.1 381.3 166.1 390.6 179.3 385.4C203.7 375.1 231 369.4 259.9 369.4L259.9 369.4z"/></svg>',gamepad:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M448 64H192C85.96 64 0 149.1 0 256s85.96 192 192 192h256c106 0 192-85.96 192-192S554 64 448 64zM247.1 280h-32v32c0 13.2-10.78 24-23.98 24c-13.2 0-24.02-10.8-24.02-24v-32L136 279.1C122.8 279.1 111.1 269.2 111.1 256c0-13.2 10.85-24.01 24.05-24.01L167.1 232v-32c0-13.2 10.82-24 24.02-24c13.2 0 23.98 10.8 23.98 24v32h32c13.2 0 24.02 10.8 24.02 24C271.1 269.2 261.2 280 247.1 280zM431.1 344c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40s39.1 17.88 39.1 40S454.1 344 431.1 344zM495.1 248c-22.12 0-39.1-17.87-39.1-39.1s17.87-40 39.1-40c22.12 0 39.1 17.88 39.1 40S518.1 248 495.1 248z"/></svg>',lightbulb:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M112.1 454.3c0 6.297 1.816 12.44 5.284 17.69l17.14 25.69c5.25 7.875 17.17 14.28 26.64 14.28h61.67c9.438 0 21.36-6.401 26.61-14.28l17.08-25.68c2.938-4.438 5.348-12.37 5.348-17.7L272 415.1h-160L112.1 454.3zM191.4 .0132C89.44 .3257 16 82.97 16 175.1c0 44.38 16.44 84.84 43.56 115.8c16.53 18.84 42.34 58.23 52.22 91.45c.0313 .25 .0938 .5166 .125 .7823h160.2c.0313-.2656 .0938-.5166 .125-.7823c9.875-33.22 35.69-72.61 52.22-91.45C351.6 260.8 368 220.4 368 175.1C368 78.61 288.9-.2837 191.4 .0132zM192 96.01c-44.13 0-80 35.89-80 79.1C112 184.8 104.8 192 96 192S80 184.8 80 176c0-61.76 50.25-111.1 112-111.1c8.844 0 16 7.159 16 16S200.8 96.01 192 96.01z"/></svg>',mug:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M512 32H120c-13.25 0-24 10.75-24 24L96.01 288c0 53 43 96 96 96h192C437 384 480 341 480 288h32c70.63 0 128-57.38 128-128S582.6 32 512 32zM512 224h-32V96h32c35.25 0 64 28.75 64 64S547.3 224 512 224zM560 416h-544C7.164 416 0 423.2 0 432C0 458.5 21.49 480 48 480h480c26.51 0 48-21.49 48-48C576 423.2 568.8 416 560 416z"/></svg>',plane:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M482.3 192C516.5 192 576 221 576 256C576 292 516.5 320 482.3 320H365.7L265.2 495.9C259.5 505.8 248.9 512 237.4 512H181.2C170.6 512 162.9 501.8 165.8 491.6L214.9 320H112L68.8 377.6C65.78 381.6 61.04 384 56 384H14.03C6.284 384 0 377.7 0 369.1C0 368.7 .1818 367.4 .5398 366.1L32 256L.5398 145.9C.1818 144.6 0 143.3 0 142C0 134.3 6.284 128 14.03 128H56C61.04 128 65.78 130.4 68.8 134.4L112 192H214.9L165.8 20.4C162.9 10.17 170.6 0 181.2 0H237.4C248.9 0 259.5 6.153 265.2 16.12L365.7 192H482.3z"/></svg>',robot:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M9.375 233.4C3.375 239.4 0 247.5 0 256v128c0 8.5 3.375 16.62 9.375 22.62S23.5 416 32 416h32V224H32C23.5 224 15.38 227.4 9.375 233.4zM464 96H352V32c0-17.62-14.38-32-32-32S288 14.38 288 32v64H176C131.8 96 96 131.8 96 176V448c0 35.38 28.62 64 64 64h320c35.38 0 64-28.62 64-64V176C544 131.8 508.3 96 464 96zM256 416H192v-32h64V416zM224 296C201.9 296 184 278.1 184 256S201.9 216 224 216S264 233.9 264 256S246.1 296 224 296zM352 416H288v-32h64V416zM448 416h-64v-32h64V416zM416 296c-22.12 0-40-17.88-40-40S393.9 216 416 216S456 233.9 456 256S438.1 296 416 296zM630.6 233.4C624.6 227.4 616.5 224 608 224h-32v192h32c8.5 0 16.62-3.375 22.62-9.375S640 392.5 640 384V256C640 247.5 636.6 239.4 630.6 233.4z"/></svg>',sad:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n  <defs>\n    <radialGradient gradientUnits="userSpaceOnUse" cy="10%" id="gradient-0">\n      <stop offset="0" style="stop-color: hsl(50, 100%, 50%);"/>\n      <stop offset="1" style="stop-color: hsl(50, 100%, 60%);"/>\n    </radialGradient>\n  </defs>\n  \x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e\n  <ellipse style="stroke: rgb(0, 0, 0); fill: rgba(0, 0, 0, 0.59);" cx="172.586" cy="207.006" rx="39.974" ry="39.974"/>\n  <ellipse style="stroke: rgb(0, 0, 0); fill: rgba(0, 0, 0, 0.59);" cx="334.523" cy="207.481" rx="39.974" ry="39.974"/>\n  <ellipse style="stroke: rgb(0, 0, 0); fill: rgba(0, 0, 0, 0.59);" cx="313.325" cy="356.208" rx="91.497" ry="59.893"/>\n  <path style="fill: rgb(85, 167, 255);" d="M 159.427 274.06 L 102.158 363.286 L 124.366 417.011 L 160.476 423.338 L 196.937 414.736 L 218.502 375.214"></path>\n  <path style="fill: url(#gradient-0);" d="M256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0zM256 352C290.9 352 323.2 367.8 348.3 394.9C354.3 401.4 364.4 401.7 370.9 395.7C377.4 389.7 377.7 379.6 371.7 373.1C341.6 340.5 301 320 256 320C247.2 320 240 327.2 240 336C240 344.8 247.2 352 256 352H256zM208 369C208 349 179.6 308.6 166.4 291.3C163.2 286.9 156.8 286.9 153.6 291.3C140.6 308.6 112 349 112 369C112 395 133.5 416 160 416C186.5 416 208 395 208 369H208zM303.6 208C303.6 225.7 317.1 240 335.6 240C353.3 240 367.6 225.7 367.6 208C367.6 190.3 353.3 176 335.6 176C317.1 176 303.6 190.3 303.6 208zM207.6 208C207.6 190.3 193.3 176 175.6 176C157.1 176 143.6 190.3 143.6 208C143.6 225.7 157.1 240 175.6 240C193.3 240 207.6 225.7 207.6 208z" />\n</svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 443.7l-119.7-119.7c27.22-40.41 40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2 1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64 86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236 144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57 0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1 208c0-70.58 57.42-128 128-128s128 57.42 128 128c0 70.58-57.42 128-128 128S79.1 278.6 79.1 208z"/></svg>',smiley:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM256.3 331.8C208.9 331.8 164.1 324.9 124.5 312.8C112.2 309 100.2 319.7 105.2 331.5C130.1 390.6 188.4 432 256.3 432C324.2 432 382.4 390.6 407.4 331.5C412.4 319.7 400.4 309 388.1 312.8C348.4 324.9 303.7 331.8 256.3 331.8H256.3zM176.4 176C158.7 176 144.4 190.3 144.4 208C144.4 225.7 158.7 240 176.4 240C194 240 208.4 225.7 208.4 208C208.4 190.3 194 176 176.4 176zM336.4 240C354 240 368.4 225.7 368.4 208C368.4 190.3 354 176 336.4 176C318.7 176 304.4 190.3 304.4 208C304.4 225.7 318.7 240 336.4 240z"/></svg>',symbols:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M500.3 7.251C507.7 13.33 512 22.41 512 31.1V175.1C512 202.5 483.3 223.1 447.1 223.1C412.7 223.1 383.1 202.5 383.1 175.1C383.1 149.5 412.7 127.1 447.1 127.1V71.03L351.1 90.23V207.1C351.1 234.5 323.3 255.1 287.1 255.1C252.7 255.1 223.1 234.5 223.1 207.1C223.1 181.5 252.7 159.1 287.1 159.1V63.1C287.1 48.74 298.8 35.61 313.7 32.62L473.7 .6198C483.1-1.261 492.9 1.173 500.3 7.251H500.3zM74.66 303.1L86.5 286.2C92.43 277.3 102.4 271.1 113.1 271.1H174.9C185.6 271.1 195.6 277.3 201.5 286.2L213.3 303.1H239.1C266.5 303.1 287.1 325.5 287.1 351.1V463.1C287.1 490.5 266.5 511.1 239.1 511.1H47.1C21.49 511.1-.0019 490.5-.0019 463.1V351.1C-.0019 325.5 21.49 303.1 47.1 303.1H74.66zM143.1 359.1C117.5 359.1 95.1 381.5 95.1 407.1C95.1 434.5 117.5 455.1 143.1 455.1C170.5 455.1 191.1 434.5 191.1 407.1C191.1 381.5 170.5 359.1 143.1 359.1zM440.3 367.1H496C502.7 367.1 508.6 372.1 510.1 378.4C513.3 384.6 511.6 391.7 506.5 396L378.5 508C372.9 512.1 364.6 513.3 358.6 508.9C352.6 504.6 350.3 496.6 353.3 489.7L391.7 399.1H336C329.3 399.1 323.4 395.9 321 389.6C318.7 383.4 320.4 376.3 325.5 371.1L453.5 259.1C459.1 255 467.4 254.7 473.4 259.1C479.4 263.4 481.6 271.4 478.7 278.3L440.3 367.1zM116.7 219.1L19.85 119.2C-8.112 90.26-6.614 42.31 24.85 15.34C51.82-8.137 93.26-3.642 118.2 21.83L128.2 32.32L137.7 21.83C162.7-3.642 203.6-8.137 231.6 15.34C262.6 42.31 264.1 90.26 236.1 119.2L139.7 219.1C133.2 225.6 122.7 225.6 116.7 219.1H116.7z"/></svg>',tree:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M413.8 447.1L256 448l0 31.99C256 497.7 241.8 512 224.1 512c-17.67 0-32.1-14.32-32.1-31.99l0-31.99l-158.9-.0099c-28.5 0-43.69-34.49-24.69-56.4l68.98-79.59H62.22c-25.41 0-39.15-29.8-22.67-49.13l60.41-70.85H89.21c-21.28 0-32.87-22.5-19.28-37.31l134.8-146.5c10.4-11.3 28.22-11.3 38.62-.0033l134.9 146.5c13.62 14.81 2.001 37.31-19.28 37.31h-10.77l60.35 70.86c16.46 19.34 2.716 49.12-22.68 49.12h-15.2l68.98 79.59C458.7 413.7 443.1 447.1 413.8 447.1z"/></svg>',users:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M224 256c70.7 0 128-57.31 128-128S294.7 0 224 0C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3c-95.73 0-173.3 77.6-173.3 173.3C0 496.5 15.52 512 34.66 512H413.3C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304zM479.1 320h-73.85C451.2 357.7 480 414.1 480 477.3C480 490.1 476.2 501.9 470 512h138C625.7 512 640 497.6 640 479.1C640 391.6 568.4 320 479.1 320zM432 256C493.9 256 544 205.9 544 144S493.9 32 432 32c-25.11 0-48.04 8.555-66.72 22.51C376.8 76.63 384 101.4 384 128c0 35.52-11.93 68.14-31.59 94.71C372.7 243.2 400.8 256 432 256z"/></svg>',warning:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n  <defs>\n    <radialGradient id="radial" cy="85%">\n      <stop offset="20%" stop-color="var(--color-secondary)" />\n      <stop offset="100%" stop-color="var(--color-primary)" />\n    </radialGradient>\n  </defs>\n  \x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e\n  <path fill="url(\'#radial\')" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z" />\n</svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>'},Ur={recents:"clock","smileys-emotion":"smiley","people-body":"users","animals-nature":"tree","food-drink":"mug",activities:"gamepad","travel-places":"plane",objects:"lightbulb",symbols:"symbols",flags:"flag",custom:"robot"};function Vr(e,t){if(!(e in Hr))return console.warn(`Unknown icon: "${e}"`),document.createElement("div");const i=function(e,t){const i=Tr(t);return i.dataset.icon=e,i.classList.add(qr.icon),i}(e,Hr[e]);return t&&i.classList.add(qr[`icon-${t}`]),i}var Wr,Yr,Xr,Zr,Kr,Gr;class Jr{constructor(e,t={}){Wr.add(this),Yr.set(this,void 0),Xr.set(this,void 0),vr(this,Yr,e,"f"),vr(this,Xr,t.mode||"sync","f")}renderSync(e={}){const t=Tr(fr(this,Yr,"f").call(this,e));return fr(this,Wr,"m",Gr).call(this,t,e),fr(this,Wr,"m",Kr).call(this,t),fr(this,Wr,"m",Zr).call(this,t,e),t}renderAsync(e={}){return gr(this,void 0,void 0,(function*(){const t=Tr(fr(this,Yr,"f").call(this,e));return fr(this,Wr,"m",Gr).call(this,t,e),fr(this,Wr,"m",Kr).call(this,t),yield fr(this,Wr,"m",Zr).call(this,t,e),t}))}render(e){return"sync"===fr(this,Xr,"f")?this.renderSync(e):this.renderAsync(e)}}Yr=new WeakMap,Xr=new WeakMap,Wr=new WeakSet,Zr=function(e,t){return gr(this,void 0,void 0,(function*(){const i=e.querySelectorAll("[data-view]"),n=[];for(const e of i){const i=t[e.dataset.view];i?"sync"!==e.dataset.render?n.push(i.render().then((t=>(e.replaceWith(t),t)))):e.replaceWith(i.renderSync()):e.remove()}return Promise.all(n)}))},Kr=function(e){e.querySelectorAll("i[data-icon]").forEach((e=>{const{icon:t,size:i}=e.dataset;e.replaceWith(Vr(t,i))}))},Gr=function(e,t){return e.querySelectorAll("[data-placeholder]").forEach((e=>{const i=e.dataset.placeholder;if(i&&t[i]){const n=t[i];e.replaceWith(...[n].flat())}else console.warn(`Missing placeholder element for key "${i}"`)})),e};var Qr=new Jr((({classes:e,emoji:t})=>`\n  <button\n    class="${e.emoji}"\n    title="${t.label}"\n    data-emoji="${t.emoji}"\n    tabindex="-1">\n    <div data-placeholder="emojiContent"></div>\n  </button>\n`)),eo={emoji:"Emoji_emoji__iKc1G"};class to extends Br{constructor({emoji:e,lazyLoader:t,category:i}){super({template:Qr,classes:eo}),this.emoji=e,this.lazyLoader=t,this.category=i}initialize(){this.uiEvents=[Br.uiEvent("focus",this.handleFocus)],super.initialize()}handleFocus(){this.category&&this.events.emit("focus:change",this.category)}activateFocus(e){this.el.tabIndex=0,e&&this.el.focus()}deactivateFocus(){this.el.tabIndex=-1}renderSync(){return super.renderSync({emoji:this.emoji,emojiContent:this.renderer.doRender(this.emoji,this.lazyLoader)})}}class io{constructor(e,t,i=0,n=0,s=!1){this.events=new Mr,this.keyHandlers={ArrowLeft:this.focusPrevious.bind(this),ArrowRight:this.focusNext.bind(this),ArrowUp:this.focusUp.bind(this),ArrowDown:this.focusDown.bind(this)},this.rowCount=Math.ceil(t/e),this.columnCount=e,this.focusedRow=i,this.focusedColumn=n,this.emojiCount=t,this.wrap=s,this.handleKeyDown=this.handleKeyDown.bind(this)}destroy(){this.events.removeAll()}on(e,t){this.events.on(e,t)}handleKeyDown(e){e.key in this.keyHandlers&&(e.preventDefault(),this.keyHandlers[e.key]())}setCell(e,t,i=!0){const n=this.getIndex();this.focusedRow=e,void 0!==t&&(this.focusedColumn=Math.min(this.columnCount,t)),(this.focusedRow>=this.rowCount||this.getIndex()>=this.emojiCount)&&(this.focusedRow=this.rowCount-1,this.focusedColumn=this.emojiCount%this.columnCount-1),this.events.emit("focus:change",{from:n,to:this.getIndex(),performFocus:i})}setFocusedIndex(e,t=!0){const i=Math.floor(e/this.columnCount),n=e%this.columnCount;this.setCell(i,n,t)}focusNext(){this.focusedColumn<this.columnCount-1&&this.getIndex()<this.emojiCount-1?this.setCell(this.focusedRow,this.focusedColumn+1):this.focusedRow<this.rowCount-1?this.setCell(this.focusedRow+1,0):this.wrap?this.setCell(0,0):this.events.emit("focus:overflow",0)}focusPrevious(){this.focusedColumn>0?this.setCell(this.focusedRow,this.focusedColumn-1):this.focusedRow>0?this.setCell(this.focusedRow-1,this.columnCount-1):this.wrap?this.setCell(this.rowCount-1,this.columnCount-1):this.events.emit("focus:underflow",this.columnCount-1)}focusUp(){this.focusedRow>0?this.setCell(this.focusedRow-1,this.focusedColumn):this.events.emit("focus:underflow",this.focusedColumn)}focusDown(){this.focusedRow<this.rowCount-1?this.setCell(this.focusedRow+1,this.focusedColumn):this.events.emit("focus:overflow",this.focusedColumn)}focusToIndex(e){this.setCell(Math.floor(e/this.columnCount),e%this.columnCount)}getIndex(){return this.focusedRow*this.columnCount+this.focusedColumn}getCell(){return{row:this.focusedRow,column:this.focusedColumn}}getRowCount(){return this.rowCount}}var no=new Jr((({classes:e})=>`\n  <div class="${e.emojiContainer}">\n    <div data-placeholder="emojis"></div>\n  </div>\n`)),so={emojiContainer:"EmojiContainer_emojiContainer__4SPb5"};class ro extends Br{constructor({emojis:e,showVariants:t,preview:i=!0,lazyLoader:n,category:s,fullHeight:r=!1}){super({template:no,classes:so}),this.fullHeight=!1,this.showVariants=t,this.lazyLoader=n,this.preview=i,this.emojis=e,this.category=s,this.fullHeight=r,this.setFocus=this.setFocus.bind(this),this.triggerNextCategory=this.triggerNextCategory.bind(this),this.triggerPreviousCategory=this.triggerPreviousCategory.bind(this)}initialize(){this.grid=new io(this.options.emojisPerRow,this.emojiCount,0,0,!this.category),this.grid.on("focus:change",this.setFocus),this.grid.on("focus:overflow",this.triggerNextCategory),this.grid.on("focus:underflow",this.triggerPreviousCategory),this.uiEvents=[Br.uiEvent("click",this.selectEmoji),Br.uiEvent("keydown",this.grid.handleKeyDown)],this.preview&&this.uiEvents.push(Br.uiEvent("mouseover",this.showPreview),Br.uiEvent("mouseout",this.hidePreview),Br.uiEvent("focus",this.showPreview,{capture:!0}),Br.uiEvent("blur",this.hidePreview,{capture:!0})),super.initialize()}setFocusedView(e,t){if(e)if("string"==typeof e){const t=this.emojis.findIndex((t=>t.emoji===e));this.grid.setFocusedIndex(t,!1),setTimeout((()=>{var e,i,n,s;const r=this.emojiViews[t].el;r.scrollIntoView();const o=null===(e=r.parentElement)||void 0===e?void 0:e.previousElementSibling;(null===(n=null===(i=r.parentElement)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.parentElement).scrollTop-=null!==(s=null==o?void 0:o.offsetHeight)&&void 0!==s?s:0}))}else"first"===e.row||0===e.row?this.grid.setCell(0,e.offset,t):"last"===e.row&&this.grid.setCell(this.grid.getRowCount()-1,e.offset,t)}setActive(e,t,i){var n;e?this.setFocusedView(t,i):null===(n=this.emojiViews[this.grid.getIndex()])||void 0===n||n.deactivateFocus()}renderSync(){return this.emojiViews=this.emojis.map((e=>this.viewFactory.create(to,{emoji:e,category:this.category,lazyLoader:this.lazyLoader,renderer:this.renderer}))),this.emojiElements=this.emojiViews.map((e=>e.renderSync())),super.renderSync({emojis:this.emojiElements,i18n:this.i18n})}destroy(){super.destroy(),this.emojiViews.forEach((e=>e.destroy())),this.grid.destroy()}triggerPreviousCategory(e){this.events.emit("category:previous",e)}triggerNextCategory(e){this.category&&this.events.emit("category:next",e)}setFocus({from:e,to:t,performFocus:i}){var n,s;null===(n=this.emojiViews[e])||void 0===n||n.deactivateFocus(),null===(s=this.emojiViews[t])||void 0===s||s.activateFocus(i)}selectEmoji(e){const t=Cr(e,this.emojis);t&&this.events.emit("emoji:select",{emoji:t,showVariants:this.showVariants})}showPreview(e){const t=e.target.closest("button"),i=null==t?void 0:t.firstElementChild,n=Cr(e,this.emojis);n&&this.events.emit("preview:show",n,null==i?void 0:i.cloneNode(!0))}hidePreview(e){Cr(e,this.emojis)&&this.events.emit("preview:hide")}get emojiCount(){return this.emojis.length}}var oo=new Jr((({classes:e,category:t,pickerId:i,icon:n,i18n:s})=>`\n  <section class="${e.emojiCategory}" role="tabpanel" aria-labelledby="${i}-category-${t.key}">\n    <h3 data-category="${t.key}" class="${e.categoryName}">\n      <i data-icon="${n}"></i>\n      ${s.get(`categories.${t.key}`,t.message||t.key)}\n    </h3>\n    <div data-view="emojis" data-render="sync"></div>\n  </section>\n`));class ao extends Fr{constructor({category:e,showVariants:t,lazyLoader:i,emojiVersion:n}){super({category:e,showVariants:t,lazyLoader:i,template:oo}),this.showVariants=t,this.lazyLoader=i,this.emojiVersion=n}initialize(){this.uiElements=Object.assign({},this.baseUIElements),super.initialize()}render(){const e=Object.create(null,{render:{get:()=>super.render}});return gr(this,void 0,void 0,(function*(){yield this.emojiDataPromise;const t=yield this.emojiData.getEmojis(this.category,this.emojiVersion);return this.emojiContainer=this.viewFactory.create(ro,{emojis:t,showVariants:this.showVariants,lazyLoader:this.lazyLoader,category:this.category.key}),e.render.call(this,{category:this.category,emojis:this.emojiContainer,emojiCount:t.length,icon:Ur[this.category.key]})}))}}class lo extends ro{constructor({category:e,emojis:t,preview:i=!0,lazyLoader:n}){super({category:e,emojis:t,showVariants:!1,preview:i,lazyLoader:n})}addOrUpdate(e){return gr(this,void 0,void 0,(function*(){const t=this.el.querySelector(`[data-emoji="${e.emoji}"]`);t&&(this.el.removeChild(t),this.emojis=this.emojis.filter((t=>t!==e)));const i=this.viewFactory.create(to,{emoji:e});if(this.el.insertBefore(i.renderSync(),this.el.firstChild),this.emojis=[e,...this.emojis.filter((t=>t!==e))],this.emojis.length>this.options.maxRecents){this.emojis=this.emojis.slice(0,this.options.maxRecents);const e=this.el.childElementCount-this.options.maxRecents;for(let t=0;t<e;t++)this.el.lastElementChild&&this.el.removeChild(this.el.lastElementChild)}}))}}const co="PicMo:recents";function ho(e){var t;try{return JSON.parse(null!==(t=localStorage.getItem(co))&&void 0!==t?t:"[]").slice(0,e)}catch(e){return[]}}var uo=new Jr((({emojiCount:e,classes:t,category:i,pickerId:n,icon:s,i18n:r})=>`\n  <section class="${t.emojiCategory}" role="tabpanel" aria-labelledby="${n}-category-${i.key}">\n  <h3 data-category="${i.key}" class="${t.categoryName}">\n    <i data-icon="${s}"></i>\n    ${r.get(`categories.${i.key}`,i.message||i.key)}\n  </h3>\n  <div data-empty="${0===e}" class="${t.recentEmojis}">\n    <div data-view="emojis" data-render="sync"></div>\n  </div>\n  <div class="${t.noRecents}">\n    ${r.get("recents.none")}\n  </div>\n</section>\n`),{mode:"async"}),po=new Jr((({classes:e,category:t,pickerId:i,icon:n,i18n:s})=>`\n  <section class="${e.emojiCategory}" role="tabpanel" aria-labelledby="${i}-category-${t.key}">\n    <h3 data-category="${t.key}" class="${e.categoryName}">\n      <i data-icon="${n}"></i>\n      ${s.get(`categories.${t.key}`,t.message||t.key)}\n    </h3>\n    <div data-view="emojis" data-render="sync"></div>\n  </section>\n`));class mo{constructor(){this.elements=new Map}lazyLoad(e,t){return this.elements.set(e,t),e}observe(e){if(window.IntersectionObserver){const t=new IntersectionObserver((e=>{e.filter((e=>e.intersectionRatio>0)).map((e=>e.target)).forEach((e=>{const i=this.elements.get(e);null==i||i(),t.unobserve(e)}))}),{root:e});this.elements.forEach(((e,i)=>{t.observe(i)}))}else this.elements.forEach((e=>{e()}))}}var go={emojis:"EmojiArea_emojis__L4mMq"};const fo=new Jr((({classes:e})=>`\n  <div class="${e.emojis}">\n    <div data-placeholder="emojis"></div>\n  </div>\n`),{mode:"async"}),vo={recents:class extends Fr{constructor({category:e,lazyLoader:t}){super({category:e,showVariants:!1,lazyLoader:t,template:uo})}initialize(){this.uiElements=Object.assign(Object.assign({},this.baseUIElements),{recents:Br.byClass(Nr.recentEmojis)}),this.appEvents={"recent:add":this.addRecent},super.initialize()}addRecent(e){return gr(this,void 0,void 0,(function*(){yield this.emojiContainer.addOrUpdate(e),this.ui.recents.dataset.empty="false"}))}render(){const e=Object.create(null,{render:{get:()=>super.render}});return gr(this,void 0,void 0,(function*(){const t=ho(this.options.maxRecents);return this.emojiContainer=this.viewFactory.create(lo,{emojis:t,showVariants:!1,lazyLoader:this.lazyLoader,category:this.category.key}),yield e.render.call(this,{category:this.category,emojis:this.emojiContainer,emojiCount:t.length,icon:Ur[this.category.key]}),this.el}))}},custom:class extends Fr{constructor({category:e,lazyLoader:t}){super({template:po,showVariants:!1,lazyLoader:t,category:e})}initialize(){this.uiElements=Object.assign({},this.baseUIElements),super.initialize()}render(){const e=Object.create(null,{render:{get:()=>super.render}});return gr(this,void 0,void 0,(function*(){return this.emojiContainer=this.viewFactory.create(ro,{emojis:this.customEmojis,showVariants:this.showVariants,lazyLoader:this.lazyLoader,category:this.category.key}),e.render.call(this,{category:this.category,emojis:this.emojiContainer,emojiCount:this.customEmojis.length,icon:Ur[this.category.key]})}))}}};class yo extends Br{constructor({categoryTabs:e,categories:t,emojiVersion:i}){super({template:fo,classes:go}),this.selectedCategory=0,this.scrollListenerState="active",this.lazyLoader=new mo,this.categoryTabs=e,this.categories=t,this.emojiVersion=i,this.handleScroll=function(e,t){let i=null;return()=>{i||(i=window.setTimeout((()=>{e(),i=null}),100))}}(this.handleScroll.bind(this))}initialize(){this.appEvents={"category:select":this.handleCategorySelect,"category:previous":this.focusPreviousCategory,"category:next":this.focusNextCategory,"focus:change":this.updateFocusedCategory},this.uiElements={emojis:Br.byClass(go.emojis)},this.uiEvents=[Br.uiEvent("scroll",this.handleScroll)],super.initialize()}get focusableEmoji(){return this.el.querySelector('[tabindex="0"]')}render(){const e=Object.create(null,{render:{get:()=>super.render}});return gr(this,void 0,void 0,(function*(){this.emojiCategories=this.categories.map(this.createCategory,this);const t={};return this.categories.forEach(((e,i)=>{t[`emojis-${e.key}`]=this.emojiCategories[i]})),yield e.render.call(this,{emojis:yield Promise.all(this.emojiCategories.map((e=>e.render())))}),this.lazyLoader.observe(this.el),window.ResizeObserver&&(this.observer=new ResizeObserver((()=>{const e=this.el.scrollHeight-this.scrollHeight;0==this.el.scrollTop-this.scrollTop&&e>0&&(this.el.scrollTop+=e),this.scrollHeight=this.el.scrollHeight,this.scrollTop=this.el.scrollTop})),this.emojiCategories.forEach((e=>{this.observer.observe(e.el)}))),this.el}))}destroy(){super.destroy(),this.emojiCategories.forEach((e=>{var t;null===(t=this.observer)||void 0===t||t.unobserve(e.el),e.destroy()}))}handleCategorySelect(e,t){this.selectCategory(e,t)}createCategory(e){const t=function(e){return vo[e.key]||ao}(e);return this.viewFactory.create(t,{category:e,showVariants:!0,lazyLoader:this.lazyLoader,emojiVersion:this.emojiVersion})}determineInitialCategory(){var e;return this.options.initialCategory&&this.categories.find((e=>e.key===this.options.initialCategory))?this.options.initialCategory:null===(e=this.categories.find((e=>"recents"!==e.key)))||void 0===e?void 0:e.key}determineFocusTarget(e){const t=this.emojiCategories.find((t=>t.category.key===e));return this.options.initialEmoji&&(null==t?void 0:t.el.querySelector(`[data-emoji="${this.options.initialEmoji}"]`))?this.options.initialEmoji:"button"}reset(){this.events.emit("preview:hide");const e=this.determineInitialCategory();e&&(this.selectCategory(e,{focus:this.determineFocusTarget(e),performFocus:!0,scroll:"jump"}),this.selectedCategory=this.getCategoryIndex(e))}getCategoryIndex(e){return this.categories.findIndex((t=>t.key===e))}focusPreviousCategory(e){this.selectedCategory>0&&this.focusCategory(this.selectedCategory-1,{row:"last",offset:null!=e?e:this.options.emojisPerRow})}focusNextCategory(e){this.selectedCategory<this.categories.length-1&&this.focusCategory(this.selectedCategory+1,{row:"first",offset:null!=e?e:0})}focusCategory(e,t){this.selectCategory(e,{focus:t,performFocus:!0})}selectCategory(e,t={}){var i;return gr(this,void 0,void 0,(function*(){this.scrollListenerState="suspend";const{focus:n,performFocus:s,scroll:r}=Object.assign({performFocus:!1},t);this.emojiCategories[this.selectedCategory].setActive(!1);const o=this.selectedCategory="number"==typeof e?e:this.getCategoryIndex(e);null===(i=this.categoryTabs)||void 0===i||i.setActiveTab(this.selectedCategory,s,"button"===n);const a=this.emojiCategories[o].el.offsetTop;this.emojiCategories[o].setActive(!0,function(e){return e&&"button"!==e?e:{row:"first",offset:0}}(n),"button"!==n&&s),r&&(this.el.scrollTop=a),this.scrollListenerState="resume"}))}updateFocusedCategory(e){var t;this.categories[this.selectedCategory].key!==e&&(this.scrollListenerState="suspend",this.selectedCategory=this.getCategoryIndex(e),null===(t=this.categoryTabs)||void 0===t||t.setActiveTab(this.selectedCategory,!1),this.scrollListenerState="resume")}handleScroll(){if("suspend"===this.scrollListenerState||!this.categoryTabs)return;if("resume"===this.scrollListenerState)return void(this.scrollListenerState="active");const e=this.el.scrollTop,t=this.el.scrollHeight-this.el.offsetHeight,i=this.emojiCategories.findIndex(((t,i)=>{var n;return e<(null===(n=this.emojiCategories[i+1])||void 0===n?void 0:n.el.offsetTop)}));0===e?this.categoryTabs.setActiveTab(0,!1):Math.floor(e)===Math.floor(t)||i<0?this.categoryTabs.setActiveTab(this.categories.length-1,!1):this.categoryTabs.setActiveTab(i,!1)}}var bo=new Jr((({classList:e,classes:t,icon:i,message:n})=>`\n<div class="${e}" role="alert">\n  <div class="${t.icon}"><i data-size="10x" data-icon="${i}"></i></div>\n  <h3 class="${t.title}">${n}</h3>\n</div>\n`)),wo={error:"ErrorMessage_error__7I7y1",icon:"ErrorMessage_icon__4---V","appear-grow":"ErrorMessage_appear-grow__oBenJ",title:"ErrorMessage_title__shDDT",appear:"ErrorMessage_appear__kry-R"};class ko extends Br{constructor({message:e,icon:t="warning",template:i=bo,className:n}){super({template:i,classes:wo}),this.message=e,this.icon=t,this.className=n}renderSync(){const e=[wo.error,this.className].join(" ").trim();return super.renderSync({message:this.message,icon:this.icon,classList:e})}}var xo=new Jr((({classList:e,classes:t,icon:i,i18n:n,message:s})=>`\n  <div class="${e}">\n    <div class="${t.icon}"><i data-size="10x" data-icon="${i}"></i></div>\n    <h3 class="${t.title}">${s}</h3>\n    <button>${n.get("retry")}</button>\n  </div>\n`));class _o extends ko{constructor({message:e}){super({message:e,template:xo,className:"DataError_dataError__jyJ0H"})}initialize(){this.uiElements={retryButton:"button"},this.uiEvents=[Br.childEvent("retryButton","click",this.onRetry)],super.initialize()}onRetry(){return gr(this,void 0,void 0,(function*(){this.emojiData?yield this.emojiData.delete():yield this.options.dataStore.deleteDatabase(this.options.locale),this.events.emit("reinitialize");const e=yield Dr(this.options.locale,this.options.dataStore,this.options.messages,this.options.emojiData,this.emojiData);this.viewFactory.setEmojiData(e),this.events.emit("data:ready",e)}))}}var Co={preview:"Preview_preview__HcFH6",previewEmoji:"Preview_previewEmoji__vjUki",previewName:"Preview_previewName__C79nL",tagList:"Preview_tagList__DielP",tag:"Preview_tag__aUSTM"};const Eo=new Jr((({classes:e,tag:t})=>`\n  <li class="${e.tag}">${t}</li>\n`)),So=new Jr((({classes:e})=>`\n  <div class="${e.preview}">\n    <div class="${e.previewEmoji}"></div>\n    <div class="${e.previewName}"></div>\n    <ul class="${e.tagList}"></ul>\n  </div>\n`));class Ao extends Br{constructor(){super({template:So,classes:Co})}initialize(){this.uiElements={emoji:Br.byClass(Co.previewEmoji),name:Br.byClass(Co.previewName),tagList:Br.byClass(Co.tagList)},this.appEvents={"preview:show":this.showPreview,"preview:hide":this.hidePreview},super.initialize()}showPreview(e,t){if(this.ui.emoji.replaceChildren(t),this.ui.name.textContent=e.label,e.tags){this.ui.tagList.style.display="flex";const t=e.tags.map((e=>Eo.renderSync({tag:e,classes:Co})));this.ui.tagList.replaceChildren(...t)}}hidePreview(){this.ui.emoji.replaceChildren(),this.ui.name.textContent="",this.ui.tagList.replaceChildren()}}var To={searchContainer:"Search_searchContainer__aJW7V",searchField:"Search_searchField__tENKn",clearButton:"Search_clearButton__oFTEY",searchAccessory:"Search_searchAccessory__0rdYO",clearSearchButton:"Search_clearSearchButton__AoDtB",notFound:"Search_notFound__rOdr1"};const jo=new Jr((({classes:e,i18n:t})=>`\n  <button title="${t.get("search.clear")}" class="${e.clearSearchButton}">\n    <i data-icon="xmark"></i>\n  </button>\n`)),Lo=new Jr((({classes:e,i18n:t})=>`\n<div class="${e.searchContainer}">\n  <input class="${e.searchField}" placeholder="${t.get("search")}">\n  <span class="${e.searchAccessory}"></span>\n</div>\n`),{mode:"async"});class Do extends Br{constructor({categories:e,emojiVersion:t}){super({template:Lo,classes:To}),this.categories=e.filter((e=>"recents"!==e.key)),this.emojiVersion=t,this.search=function(e,t){let i=null;return(...t)=>{i&&window.clearTimeout(i),i=window.setTimeout((()=>{e(...t),i=null}),100)}}(this.search.bind(this))}initialize(){this.uiElements={searchField:Br.byClass(To.searchField),searchAccessory:Br.byClass(To.searchAccessory)},this.uiEvents=[Br.childEvent("searchField","keydown",this.onKeyDown),Br.childEvent("searchField","input",this.onSearchInput)],super.initialize()}render(){const e=Object.create(null,{render:{get:()=>super.render}});return gr(this,void 0,void 0,(function*(){return yield e.render.call(this),this.searchIcon=Vr("search"),this.notFoundMessage=this.viewFactory.create(ko,{message:this.i18n.get("search.notFound"),className:To.notFound,icon:"sad"}),this.notFoundMessage.renderSync(),this.errorMessage=this.viewFactory.create(ko,{message:this.i18n.get("search.error")}),this.errorMessage.renderSync(),this.clearSearchButton=jo.render({classes:To,i18n:this.i18n}),this.clearSearchButton.addEventListener("click",(e=>this.onClearSearch(e))),this.searchField=this.ui.searchField,this.showSearchIcon(),this.el}))}showSearchIcon(){this.showSearchAccessory(this.searchIcon)}showClearSearchButton(){this.showSearchAccessory(this.clearSearchButton)}showSearchAccessory(e){this.ui.searchAccessory.replaceChildren(e)}clear(){this.searchField.value="",this.showSearchIcon()}focus(){this.searchField.focus()}onClearSearch(e){var t;e.stopPropagation(),this.searchField.value="",null===(t=this.resultsContainer)||void 0===t||t.destroy(),this.resultsContainer=null,this.showSearchIcon(),this.events.emit("content:show"),this.searchField.focus()}handleResultsKeydown(e){this.resultsContainer&&"Escape"===e.key&&this.onClearSearch(e)}onKeyDown(e){var t;"Escape"===e.key&&this.searchField.value?this.onClearSearch(e):"Enter"!==e.key&&"ArrowDown"!==e.key||!this.resultsContainer||(e.preventDefault(),null===(t=this.resultsContainer.el.querySelector('[tabindex="0"]'))||void 0===t||t.focus())}onSearchInput(e){this.searchField.value?(this.showClearSearchButton(),this.search()):this.onClearSearch(e)}search(){var e;return gr(this,void 0,void 0,(function*(){if(this.searchField.value)try{const t=yield this.emojiData.searchEmojis(this.searchField.value,this.customEmojis,this.emojiVersion,this.categories);if(this.events.emit("preview:hide"),t.length){const i=new mo;this.resultsContainer=this.viewFactory.create(ro,{emojis:t,fullHeight:!0,showVariants:!0,lazyLoader:i}),this.resultsContainer.renderSync(),(null===(e=this.resultsContainer)||void 0===e?void 0:e.el)&&(i.observe(this.resultsContainer.el),this.resultsContainer.setActive(!0,{row:0,offset:0},!1),this.resultsContainer.el.addEventListener("keydown",(e=>this.handleResultsKeydown(e))),this.events.emit("content:show",this.resultsContainer))}else this.events.emit("content:show",this.notFoundMessage)}catch(e){this.events.emit("content:show",this.errorMessage)}}))}}class Oo{constructor(){this.handleKeyDown=this.handleKeyDown.bind(this)}activate(e){this.rootElement=e,this.rootElement.addEventListener("keydown",this.handleKeyDown)}deactivate(){var e;null===(e=this.rootElement)||void 0===e||e.removeEventListener("keydown",this.handleKeyDown)}get focusableElements(){return this.rootElement.querySelectorAll('input, [tabindex="0"]')}get lastFocusableElement(){return this.focusableElements[this.focusableElements.length-1]}get firstFocusableElement(){return this.focusableElements[0]}checkFocus(e,t,i){e.target===t&&(i.focus(),e.preventDefault())}handleKeyDown(e){"Tab"===e.key&&this.checkFocus(e,e.shiftKey?this.firstFocusableElement:this.lastFocusableElement,e.shiftKey?this.lastFocusableElement:this.firstFocusableElement)}}var Io=new Jr((({classes:e})=>`\n  <div class="${e.variantOverlay}">\n    <div class="${e.variantPopup}">\n      <div data-view="emojis" data-render="sync"></div>\n    </div>\n  </div>\n`)),zo={variantOverlay:"VariantPopup_variantOverlay__gGwue",variantPopup:"VariantPopup_variantPopup__c2pHF"};const Po={easing:"ease-in-out",duration:250,fill:"both"},Mo={opacity:[0,1]},Ro={opacity:[0,1],transform:["scale3d(0.8, 0.8, 0.8)","scale3d(1, 1, 1)"]};class $o extends Br{constructor({emoji:e,parent:t}){super({template:Io,classes:zo,parent:t}),this.focusedEmojiIndex=0,this.focusTrap=new Oo,this.animateShow=()=>Promise.all([Ar(this.el,Mo,Po,this.options),Ar(this.ui.popup,Ro,Po,this.options)]),this.emoji=e}initialize(){this.uiElements={popup:Br.byClass(zo.variantPopup)},this.uiEvents=[Br.uiEvent("click",this.handleClick),Br.uiEvent("keydown",this.handleKeydown)],super.initialize()}animateHide(){const e=Object.assign(Object.assign({},Po),{direction:"reverse"});return Promise.all([Ar(this.el,Mo,e,this.options),Ar(this.ui.popup,Ro,e,this.options)])}hide(){return gr(this,void 0,void 0,(function*(){yield this.animateHide(),this.events.emit("variantPopup:hide")}))}handleKeydown(e){"Escape"===e.key&&(this.hide(),e.stopPropagation())}handleClick(e){this.ui.popup.contains(e.target)||this.hide()}getEmoji(e){return this.renderedEmojis[e]}setFocusedEmoji(e){this.getEmoji(this.focusedEmojiIndex).tabIndex=-1,this.focusedEmojiIndex=e;const t=this.getEmoji(this.focusedEmojiIndex);t.tabIndex=0,t.focus()}destroy(){this.emojiContainer.destroy(),this.focusTrap.deactivate(),super.destroy()}renderSync(){const e=[Object.assign(Object.assign({},this.emoji),{skins:null}),...(this.emoji.skins||[]).map((e=>Object.assign(Object.assign({},e),{label:this.emoji.label,tags:this.emoji.tags})))];return this.emojiContainer=this.viewFactory.create(ro,{emojis:e,preview:!1}),super.renderSync({emojis:this.emojiContainer}),e.length<this.options.emojisPerRow&&this.el.style.setProperty("--emojis-per-row",e.length.toString()),this.el}activate(){this.emojiContainer.setActive(!0,{row:0,offset:0},!0),this.focusTrap.activate(this.el)}}var Bo=new Jr((({classes:e,i18n:t,category:i,pickerId:n,icon:s})=>`\n<li class="${e.categoryTab}">\n  <button\n    aria-selected="false"\n    role="tab"\n    class="${e.categoryButton}"\n    tabindex="-1"\n    title="${t.get(`categories.${i.key}`,i.message||i.key)}"\n    type="button"\n    data-category="${i.key}"\n    id="${n}-category-${i.key}"\n  >\n    <i data-icon="${s}"></i>\n</li>\n`)),No={categoryButtons:"CategoryTabs_categoryButtons__dJVp-",categoryButton:"CategoryTabs_categoryButton__AsR9b",categoryTab:"CategoryTabs_categoryTab__fAgQT",categoryTabActive:"CategoryTabs_categoryTabActive__691be"};class Fo extends Br{constructor({category:e,icon:t}){super({template:Bo,classes:No}),this.isActive=!1,this.category=e,this.icon=t}initialize(){this.uiElements={button:Br.byClass(No.categoryButton)},this.uiEvents=[Br.childEvent("button","click",this.selectCategory)],super.initialize()}renderSync(){return super.renderSync({category:this.category,icon:this.icon}),this.ui.button.ariaSelected="false",this.el}setActive(e,t=!0,i=!1){this.el.classList.toggle(No.categoryTabActive,e),t&&this.setFocused(e,i),this.isActive=e}setFocused(e,t=!1){this.ui.button.ariaSelected=e.toString(),e?(this.ui.button.tabIndex=0,this.ui.button.focus(),t&&this.events.emit("category:select",this.category.key,{scroll:"animate",focus:"button",performFocus:!1})):this.ui.button.tabIndex=-1}selectCategory(){this.isActive||this.events.emit("category:select",this.category.key,{scroll:"animate",focus:"button",performFocus:!0})}}var qo=new Jr((({classes:e})=>`\n  <ul role="tablist" class="${e.categoryButtons}">\n    <div data-placeholder="tabs"></div>\n  </ul>\n`));class Ho extends Br{constructor({categories:e}){super({template:qo,classes:No}),this.activeCategoryIndex=0,this.categories=e}initialize(){this.keyBindings={ArrowLeft:this.stepSelectedTab(-1),ArrowRight:this.stepSelectedTab(1)},super.initialize()}renderSync(){return this.tabViews=this.categories.map((e=>this.viewFactory.create(Fo,{category:e,icon:Ur[e.key]}))),super.renderSync({tabs:this.tabViews.map((e=>e.renderSync()))}),this.currentTabView.setActive(!0),this.el}get currentCategory(){return this.categories[this.activeCategoryIndex]}get currentTabView(){return this.tabViews[this.activeCategoryIndex]}setActiveTab(e,t=!0,i=!0){if(e===this.activeCategoryIndex)return;const n=this.currentTabView,s=this.tabViews[e];n.setActive(!1,t),s.setActive(!0,t,i),this.activeCategoryIndex=e}getTargetCategory(e){return e<0?this.categories.length-1:e>=this.categories.length?0:e}stepSelectedTab(e){return()=>{const t=this.activeCategoryIndex+e;this.setActiveTab(this.getTargetCategory(t))}}}const Uo=[{version:15,emoji:String.fromCodePoint(129768)},{version:14,emoji:String.fromCodePoint(128733)},{version:13,emoji:String.fromCodePoint(129729)},{version:12,emoji:String.fromCodePoint(129449)},{version:11,emoji:String.fromCodePoint(129463)},{version:5,emoji:String.fromCodePoint(129322)},{version:4,emoji:String.fromCodePoint(9877)},{version:3,emoji:String.fromCodePoint(129314)},{version:2,emoji:String.fromCodePoint(128488)},{version:1,emoji:String.fromCodePoint(128512)}];function Vo(e,t){return Array.from({length:e},(()=>t)).join("")}var Wo=new Jr((e=>e.isLoaded?function(e){const{classes:t,theme:i,className:n=""}=e;return`\n    <div class="${t.picker} ${i} ${n}">\n      ${function({showHeader:e,classes:t}){return e?`\n    <header class="${t.header}">\n      <div data-view="search"></div>\n      <div data-view="categoryTabs" data-render="sync"></div>\n    </header>\n  `:""}(e)}\n      <div class="${t.content}">\n        <div data-view="emojiArea"></div>\n      </div>\n      <div data-view="preview"></div>\n    </div>\n  `}(e):function(e){const{emojiCount:t,classes:i,theme:n,className:s}=e;return`\n    <div class="${i.skeleton} ${i.picker} ${n} ${s}">\n      ${(({showHeader:t,classes:i})=>t?`\n    <header class="${i.header}">\n      ${(({showSearch:e,classes:t})=>e?`\n    <div class="${t.searchSkeleton}">\n      <div class="${t.searchInput} ${t.placeholder}"></div>\n    </div>\n  `:"")(e)}\n      ${(({showCategoryTabs:e,classes:t})=>e?`\n    <div class="${t.categoryTabsSkeleton}">\n      ${Vo(10,`<div class="${t.placeholder} ${t.categoryTab}"></div>`)}\n    </div>\n  `:"")(e)}\n    </header>\n  `:"")(e)}\n      <div class="${i.contentSkeleton}">\n        <div class="${i.placeholder} ${i.categoryName}"></div>\n        <div class="${i.emojiGrid}">\n          ${Vo(t,`<div class="${i.placeholder} ${i.emoji}"></div>`)}\n        </div>\n      </div>\n      ${(({showPreview:e,classes:t})=>e?`\n    <div class="${t.previewSkeleton}">\n      <div class="${t.placeholder} ${t.previewEmoji}"></div>\n      <div class="${t.placeholder} ${t.previewName}"></div>\n      <ul class="${t.tagList}">\n        ${Vo(3,`<li class="${t.placeholder} ${t.tag}"></li>`)}\n      </ul>\n    </div>\n  `:"")(e)}\n    </div>\n  `}(e))),Yo={picker:"EmojiPicker_picker__19Vln",skeleton:"EmojiPicker_skeleton__M1a2g",placeholder:"EmojiPicker_placeholder__YDJn-",shine:"EmojiPicker_shine__s-vEs",searchSkeleton:"EmojiPicker_searchSkeleton__gNgdU",searchInput:"EmojiPicker_searchInput__tpaBs",categoryTabsSkeleton:"EmojiPicker_categoryTabsSkeleton__2dISl",categoryTab:"EmojiPicker_categoryTab__mmSVF",contentSkeleton:"EmojiPicker_contentSkeleton__UWfQu",categoryName:"EmojiPicker_categoryName__d2-Ed",emojiGrid:"EmojiPicker_emojiGrid__WnoCI",emoji:"EmojiPicker_emoji__jaN-w",previewSkeleton:"EmojiPicker_previewSkeleton__Bjqkm",previewEmoji:"EmojiPicker_previewEmoji__uOLbA",previewName:"EmojiPicker_previewName__QJ47d",tagList:"EmojiPicker_tagList__tc6nv",tag:"EmojiPicker_tag__gAU6B",overlay:"EmojiPicker_overlay__kDT99",content:"EmojiPicker_content__xT6Kl",fullHeight:"EmojiPicker_fullHeight__7kz2H",pluginContainer:"EmojiPicker_pluginContainer__Gz3yT",header:"EmojiPicker_header__eDZPD"};const Xo={emojisPerRow:"--emojis-per-row",visibleRows:"--row-count",emojiSize:"--emoji-size"};class Zo extends Br{constructor(){super({template:Wo,classes:Yo}),this.pickerReady=!1,this.externalEvents=new $r}initialize(){this.uiElements={pickerContent:Br.byClass(Yo.content),header:Br.byClass(Yo.header)},this.uiEvents=[Br.uiEvent("keydown",this.handleKeyDown)],this.appEvents={error:this.onError,reinitialize:this.reinitialize,"data:ready":this.onDataReady,"content:show":this.showContent,"variantPopup:hide":this.hideVariantPopup,"emoji:select":this.selectEmoji},super.initialize()}destroy(){var e,t;super.destroy(),null===(e=this.search)||void 0===e||e.destroy(),this.emojiArea.destroy(),null===(t=this.categoryTabs)||void 0===t||t.destroy(),this.events.removeAll(),this.externalEvents.removeAll()}addEventListener(e,t){this.externalEvents.on(e,t)}removeEventListener(e,t){this.externalEvents.off(e,t)}initializePickerView(){this.pickerReady&&(this.showContent(),this.emojiArea.reset())}handleKeyDown(e){const t=e.ctrlKey||e.metaKey;"s"===e.key&&t&&this.search&&(e.preventDefault(),this.search.focus())}buildChildViews(){return this.options.showPreview&&(this.preview=this.viewFactory.create(Ao)),this.options.showSearch&&(this.search=this.viewFactory.create(Do,{categories:this.categories,emojiVersion:this.emojiVersion})),this.options.showCategoryTabs&&(this.categoryTabs=this.viewFactory.create(Ho,{categories:this.categories})),this.currentView=this.emojiArea=this.viewFactory.create(yo,{categoryTabs:this.categoryTabs,categories:this.categories,emojiVersion:this.emojiVersion}),[this.preview,this.search,this.emojiArea,this.categoryTabs]}setStyleProperties(){this.options.showSearch||this.el.style.setProperty("--search-height-full","0px"),this.options.showCategoryTabs||(this.el.style.setProperty("--category-tabs-height","0px"),this.el.style.setProperty("--category-tabs-offset","0px")),this.options.showPreview||this.el.style.setProperty("--emoji-preview-height-full","0px"),Object.keys(Xo).forEach((e=>{this.options[e]&&this.el.style.setProperty(Xo[e],this.options[e].toString())}))}reinitialize(){this.renderSync()}onError(e){const t=this.viewFactory.create(_o,{message:this.i18n.get("error.load")}),i=this.el.offsetHeight||375;throw this.el.style.height=`${i}px`,this.el.replaceChildren(t.renderSync()),e}onDataReady(e){const t=Object.create(null,{render:{get:()=>super.render}});return gr(this,void 0,void 0,(function*(){const i=this.el;try{e?this.emojiData=e:yield this.emojiDataPromise,"auto"===this.options.emojiVersion?this.emojiVersion=function(){var e;const t=Uo.find((e=>function(e){const t=document.createElement("canvas").getContext("2d");if(t)return t.textBaseline="top",t.font="32px Arial",t.fillText(e,0,0),0!==t.getImageData(16,16,1,1).data[0]}(e.emoji)));return null!==(e=null==t?void 0:t.version)&&void 0!==e?e:1}()||parseFloat("14.0"):this.emojiVersion=this.options.emojiVersion,this.categories=yield this.emojiData.getCategories(this.options);const[n,s,r,o]=this.buildChildViews();yield t.render.call(this,{isLoaded:!0,search:s,categoryTabs:o,emojiArea:r,preview:n,showHeader:Boolean(this.search||this.categoryTabs),theme:this.options.theme,className:this.options.className}),this.el.style.setProperty("--category-count",this.categories.length.toString()),this.pickerReady=!0,i.replaceWith(this.el),this.setStyleProperties(),this.initializePickerView(),this.setInitialFocus(),this.externalEvents.emit("data:ready")}catch(e){this.events.emit("error",e)}}))}renderSync(){if(super.renderSync({isLoaded:!1,theme:this.options.theme,showSearch:this.options.showSearch,showPreview:this.options.showPreview,showCategoryTabs:this.options.showCategoryTabs,showHeader:this.options.showSearch||this.options.showCategoryTabs,emojiCount:this.options.emojisPerRow*this.options.visibleRows}),!this.options.rootElement)throw new Error("Picker must be given a root element via the rootElement option");return this.options.rootElement.replaceChildren(this.el),this.setStyleProperties(),this.pickerReady&&this.initializePickerView(),this.el}setInitialFocus(){this.pickerReady&&(this.search&&this.options.autoFocusSearch?this.search.focus():this.emojiArea.focusableEmoji.focus())}reset(){this.pickerReady&&(this.emojiArea.reset(),this.showContent(this.emojiArea)),this.search&&this.search.clear()}showContent(e=this.emojiArea){var t,i;e!==this.currentView&&(this.currentView!==this.emojiArea&&(null===(t=this.currentView)||void 0===t||t.destroy()),this.ui.pickerContent.classList.toggle(Yo.fullHeight,e!==this.emojiArea),this.ui.pickerContent.replaceChildren(e.el),this.currentView=e,e===this.emojiArea?(this.emojiArea.reset(),this.categoryTabs&&this.ui.header.appendChild(this.categoryTabs.el)):null===(i=this.categoryTabs)||void 0===i||i.el.remove())}hideVariantPopup(){var e;null===(e=this.variantPopup)||void 0===e||e.destroy()}isPickerClick(e){var t,i;const n=e.target,s=this.el.contains(n),r=null===(i=null===(t=this.variantPopup)||void 0===t?void 0:t.el)||void 0===i?void 0:i.contains(n);return s||r}selectEmoji({emoji:e}){var t,i;return gr(this,void 0,void 0,(function*(){(null===(t=e.skins)||void 0===t?void 0:t.length)&&this.options.showVariants&&!this.isVariantPopupOpen?this.showVariantPopup(e):(yield null===(i=this.variantPopup)||void 0===i?void 0:i.animateHide(),this.events.emit("variantPopup:hide"),yield this.emitEmoji(e))}))}get isVariantPopupOpen(){return this.variantPopup&&!this.variantPopup.isDestroyed}showVariantPopup(e){return gr(this,void 0,void 0,(function*(){const t=document.activeElement;this.events.once("variantPopup:hide",(()=>{null==t||t.focus()})),this.variantPopup=this.viewFactory.create($o,{emoji:e,parent:this.el}),this.el.appendChild(this.variantPopup.renderSync()),this.variantPopup.activate()}))}emitEmoji(e){return gr(this,void 0,void 0,(function*(){this.externalEvents.emit("emoji:select",yield this.renderer.doEmit(e)),function(e,t){const i=[e,...ho(t).filter((t=>t.hexcode!==e.hexcode))].slice(0,t);try{localStorage.setItem(co,JSON.stringify(i))}catch(e){}}(e,this.options.maxRecents),this.events.emit("recent:add",e)}))}}class Ko{constructor({events:e,i18n:t,renderer:i,emojiData:n,options:s,customEmojis:r=[],pickerId:o}){this.events=e,this.i18n=t,this.renderer=i,this.emojiData=n,this.options=s,this.customEmojis=r,this.pickerId=o}setEmojiData(e){this.emojiData=Promise.resolve(e)}create(e,...t){const i=new e(...t);return i.setPickerId(this.pickerId),i.setEvents(this.events),i.setI18n(this.i18n),i.setRenderer(this.renderer),i.setEmojiData(this.emojiData),i.setOptions(this.options),i.setCustomEmojis(this.customEmojis),i.viewFactory=this,i.initialize(),i}}var Go;class Jo{constructor(e={}){Go.set(this,void 0),vr(this,Go,new Map(Object.entries(e)),"f")}get(e,t=e){return fr(this,Go,"f").get(e)||t}}Go=new WeakMap;var Qo={imagePlaceholder:"common_imagePlaceholder__FRWLu",placeholder:"common_placeholder__qe-fo",shine:"common_shine__tUVG2"};const ea=new Jr((({classes:e})=>`\n  <div class="${e.placeholder} ${e.imagePlaceholder}"></div>\n`));class ta extends Br{constructor({classNames:e}={}){super({template:ea,classes:Qo}),this.classNames=e}load(e){const t=document.createElement("img");this.classNames&&(t.className=this.classNames),t.addEventListener("load",(()=>{this.el.replaceWith(t)}),{once:!0}),Promise.resolve(e).then((e=>t.src=e))}renderSync(){return super.renderSync(),this.classNames&&this.classNames.split(" ").forEach((e=>this.el.classList.add(e))),this.el}}var ia={customEmoji:"custom_customEmoji__Kspg6"};class na{renderElement(e){return{content:e}}renderImage(e="",t){const i=new ta({classNames:e});return i.renderSync(),{content:i,resolver:()=>(i.load(t()),i.el)}}doRender(e,t,i){if(e.custom)return this.renderCustom(e,t,i);const{content:n,resolver:s}=this.render(e,i),r=n instanceof HTMLElement?n:n.el;return t&&s?t.lazyLoad(r,s):(s&&s(),r)}doEmit(e){return e.custom?this.emitCustom(e):this.emit(e)}emitCustom({url:e,label:t,emoji:i,data:n}){return{url:e,label:t,emoji:i,data:n}}renderCustom(e,t,i=""){const n=[ia.customEmoji,i].join(" ").trim(),{content:s,resolver:r}=this.renderImage(n,(()=>e.url)),o=s instanceof HTMLElement?s:s.el;return r&&r(),o}}const sa=new Jr((({emoji:e})=>`<span>${e}</span>`)),{autoTheme:ra,lightTheme:oa,darkTheme:aa}={lightTheme:"themes_lightTheme__mMNem",darkTheme:"themes_darkTheme__qgrZP",autoTheme:"themes_autoTheme__tik-v"},la=[(e,t)=>("1F91D"===e.hexcode&&t<14&&(e.skins=[]),e),(e,t)=>(e.skins&&(e.skins=e.skins.filter((e=>!e.version||e.version<=t))),e)];function ca(e,t){return e.filter((e=>null!==function(e,t){return la.some((i=>null===i(e,t)))?null:e}(e,t)))}function ha(e){var t;return{emoji:e.emoji,label:e.label,tags:e.tags,skins:null===(t=e.skins)||void 0===t?void 0:t.map((e=>ha(e))),order:e.order,custom:!1,hexcode:e.hexcode,version:e.version}}function da(e,t,i){var n;return!(i&&!i.some((t=>t.order===e.group)))&&(Sr(e.label,t)||(null===(n=e.tags)||void 0===n?void 0:n.some((e=>Sr(e,t)))))}class ua{constructor(e="en"){this.locale=e}}const pa="PicMo";function ma(e){return new ga(e)}ma.deleteDatabase=e=>new Promise(((t,i)=>{const n=indexedDB.deleteDatabase(`${pa}-${e}`);n.addEventListener("success",t),n.addEventListener("error",i)}));class ga extends ua{open(){return gr(this,void 0,void 0,(function*(){const e=indexedDB.open(`${pa}-${this.locale}`);return new Promise(((t,i)=>{e.addEventListener("success",(e=>{var i;this.db=null===(i=e.target)||void 0===i?void 0:i.result,t()})),e.addEventListener("error",i),e.addEventListener("upgradeneeded",(e=>gr(this,void 0,void 0,(function*(){var t;this.db=null===(t=e.target)||void 0===t?void 0:t.result,this.db.createObjectStore("category",{keyPath:"order"});const i=this.db.createObjectStore("emoji",{keyPath:"emoji"});i.createIndex("category","group"),i.createIndex("version","version"),this.db.createObjectStore("meta")}))))}))}))}delete(){return gr(this,void 0,void 0,(function*(){this.close();const e=indexedDB.deleteDatabase(`${pa}-${this.locale}`);yield this.waitForRequest(e)}))}close(){this.db.close()}getEmojiCount(){return gr(this,void 0,void 0,(function*(){const e=this.db.transaction("emoji","readonly").objectStore("emoji");return(yield this.waitForRequest(e.count())).target.result}))}getEtags(){return gr(this,void 0,void 0,(function*(){const e=this.db.transaction("meta","readonly").objectStore("meta"),[t,i]=yield Promise.all([this.waitForRequest(e.get("emojisEtag")),this.waitForRequest(e.get("messagesEtag"))]);return{storedEmojisEtag:t.target.result,storedMessagesEtag:i.target.result}}))}setMeta(e){return gr(this,void 0,void 0,(function*(){const t=this.db.transaction("meta","readwrite"),i=t.objectStore("meta");return new Promise((n=>{t.oncomplete=n,Object.keys(e).filter(Boolean).forEach((t=>{i.put(e[t],t)}))}))}))}getHash(){return gr(this,void 0,void 0,(function*(){const e=this.db.transaction("meta","readonly").objectStore("meta");return(yield this.waitForRequest(e.get("hash"))).target.result}))}isPopulated(){return gr(this,void 0,void 0,(function*(){const e=this.db.transaction("category","readonly").objectStore("category");return(yield this.waitForRequest(e.count())).target.result>0}))}populate({groups:e,emojis:t,emojisEtag:i,messagesEtag:n,hash:s}){return gr(this,void 0,void 0,(function*(){yield this.removeAllObjects("category","emoji");const r=[this.addObjects("category",e),this.addObjects("emoji",t),this.setMeta({emojisEtag:i,messagesEtag:n,hash:s})];yield Promise.all(r)}))}getCategories(e){var t;return gr(this,void 0,void 0,(function*(){const i=this.db.transaction("category","readonly").objectStore("category");let n=(yield this.waitForRequest(i.getAll())).target.result.filter((e=>"component"!==e.key));if(e.showRecents&&n.unshift({key:"recents",order:-1}),(null===(t=e.custom)||void 0===t?void 0:t.length)&&n.push({key:"custom",order:10}),e.categories){const t=e.categories;n=n.filter((e=>t.includes(e.key))),n.sort(((e,i)=>t.indexOf(e.key)-t.indexOf(i.key)))}else n.sort(((e,t)=>e.order-t.order));return n}))}getEmojis(e,t){return gr(this,void 0,void 0,(function*(){const i=this.db.transaction("emoji","readonly").objectStore("emoji").index("category");return ca((yield this.waitForRequest(i.getAll(e.order))).target.result.filter((e=>e.version<=t)).sort(((e,t)=>null!=e.order&&null!=t.order?e.order-t.order:0)).map(ha),t)}))}searchEmojis(e,t,i,n){return gr(this,void 0,void 0,(function*(){const s=[];return new Promise(((r,o)=>{const a=this.db.transaction("emoji","readonly").objectStore("emoji").openCursor();a.addEventListener("success",(o=>{var a;const l=null===(a=o.target)||void 0===a?void 0:a.result;if(!l)return r([...ca(s,i),...t.filter((t=>da(t,e)))]);const c=l.value;da(c,e,n)&&c.version<=i&&s.push(ha(c)),l.continue()})),a.addEventListener("error",(e=>{o(e)}))}))}))}waitForRequest(e){return gr(this,void 0,void 0,(function*(){return new Promise(((t,i)=>{e.onsuccess=t,e.onerror=i}))}))}withTransaction(e,t="readwrite",i){return new Promise(((n,s)=>{const r=this.db.transaction(e,t);r.oncomplete=n,r.onerror=s,i(r)}))}removeAllObjects(...e){return gr(this,void 0,void 0,(function*(){const t=this.db.transaction(e,"readwrite"),i=e.map((e=>t.objectStore(e)));yield Promise.all(i.map((e=>this.waitForRequest(e.clear()))))}))}addObjects(e,t){return gr(this,void 0,void 0,(function*(){return this.withTransaction(e,"readwrite",(i=>{const n=i.objectStore(e);t.forEach((e=>{n.add(e)}))}))}))}}const fa={renderer:new class extends na{render(e){return this.renderElement(sa.renderSync({emoji:e.emoji}))}emit({emoji:e,hexcode:t,label:i}){return{emoji:e,hexcode:t,label:i}}},dataStore:ma,theme:oa,animate:!0,showSearch:!0,showCategoryTabs:!0,showVariants:!0,showRecents:!0,showPreview:!0,emojisPerRow:8,visibleRows:6,emojiVersion:"auto",maxRecents:50,i18n:{"categories.activities":"Activities","categories.animals-nature":"Animals & Nature","categories.custom":"Custom","categories.flags":"Flags","categories.food-drink":"Food & Drink","categories.objects":"Objects","categories.people-body":"People & Body","categories.recents":"Recently Used","categories.smileys-emotion":"Smileys & Emotion","categories.symbols":"Symbols","categories.travel-places":"Travel & Places","error.load":"Failed to load emojis","recents.clear":"Clear recent emojis","recents.none":"You haven't selected any emojis yet.",retry:"Try again","search.clear":"Clear search","search.error":"Failed to search emojis","search.notFound":"No results found",search:"Search emojis..."},locale:"en",custom:[]};function va(e={}){return Object.assign(Object.assign({},fa),e)}let ya=0;function ba(e){const t=va(e),i=((null==t?void 0:t.custom)||[]).map((e=>Object.assign(Object.assign({},e),{custom:!0,tags:["custom",...e.tags||[]]}))),n=new Rr,s=function(e){return Dr(e.locale,e.dataStore,e.messages,e.emojiData)}(t),r=new Jo(t.i18n);s.then((e=>{n.emit("data:ready",e)})).catch((e=>{n.emit("error",e)}));const o=new Ko({events:n,i18n:r,customEmojis:i,renderer:t.renderer,options:t,emojiData:s,pickerId:`picmo-${Date.now()}-${ya++}`}).create(Zo);return o.renderSync(),o}const wa="undefined"!=typeof window&&void 0!==window.document,ka=wa?window:{},xa=!(!wa||!ka.document.documentElement)&&"ontouchstart"in ka.document.documentElement,_a=!!wa&&"PointerEvent"in ka,Ca="cropper",Ea="all",Sa="crop",Aa="move",Ta="zoom",ja="e",La="w",Da="s",Oa="n",Ia="ne",za="nw",Pa="se",Ma="sw",Ra=`${Ca}-crop`,$a=`${Ca}-disabled`,Ba=`${Ca}-hidden`,Na=`${Ca}-hide`,Fa=`${Ca}-invisible`,qa=`${Ca}-modal`,Ha=`${Ca}-move`,Ua=`${Ca}Action`,Va=`${Ca}Preview`,Wa="crop",Ya="move",Xa="none",Za="crop",Ka="cropend",Ga="cropmove",Ja="cropstart",Qa="dblclick",el=_a?"pointerdown":xa?"touchstart":"mousedown",tl=_a?"pointermove":xa?"touchmove":"mousemove",il=_a?"pointerup pointercancel":xa?"touchend touchcancel":"mouseup",nl="ready",sl="resize",rl="wheel",ol="zoom",al="image/jpeg",ll=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,cl=/^data:/,hl=/^data:image\/jpeg;base64,/,dl=/^img|canvas$/i,ul={viewMode:0,dragMode:Wa,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},pl=Number.isNaN||ka.isNaN;function ml(e){return"number"==typeof e&&!pl(e)}const gl=e=>e>0&&e<1/0;function fl(e){return void 0===e}function vl(e){return"object"==typeof e&&null!==e}const{hasOwnProperty:yl}=Object.prototype;function bl(e){if(!vl(e))return!1;try{const{constructor:t}=e,{prototype:i}=t;return t&&i&&yl.call(i,"isPrototypeOf")}catch(e){return!1}}function wl(e){return"function"==typeof e}const{slice:kl}=Array.prototype;function xl(e){return Array.from?Array.from(e):kl.call(e)}function _l(e,t){return e&&wl(t)&&(Array.isArray(e)||ml(e.length)?xl(e).forEach(((i,n)=>{t.call(e,i,n,e)})):vl(e)&&Object.keys(e).forEach((i=>{t.call(e,e[i],i,e)}))),e}const Cl=Object.assign||function(e,...t){return vl(e)&&t.length>0&&t.forEach((t=>{vl(t)&&Object.keys(t).forEach((i=>{e[i]=t[i]}))})),e},El=/\.\d*(?:0|9){12}\d*$/;function Sl(e,t=1e11){return El.test(e)?Math.round(e*t)/t:e}const Al=/^width|height|left|top|marginLeft|marginTop$/;function Tl(e,t){const{style:i}=e;_l(t,((e,t)=>{Al.test(t)&&ml(e)&&(e=`${e}px`),i[t]=e}))}function jl(e,t){if(!t)return;if(ml(e.length))return void _l(e,(e=>{jl(e,t)}));if(e.classList)return void e.classList.add(t);const i=e.className.trim();i?i.indexOf(t)<0&&(e.className=`${i} ${t}`):e.className=t}function Ll(e,t){t&&(ml(e.length)?_l(e,(e=>{Ll(e,t)})):e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&(e.className=e.className.replace(t,"")))}function Dl(e,t,i){t&&(ml(e.length)?_l(e,(e=>{Dl(e,t,i)})):i?jl(e,t):Ll(e,t))}const Ol=/([a-z\d])([A-Z])/g;function Il(e){return e.replace(Ol,"$1-$2").toLowerCase()}function zl(e,t){return vl(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute(`data-${Il(t)}`)}function Pl(e,t,i){vl(i)?e[t]=i:e.dataset?e.dataset[t]=i:e.setAttribute(`data-${Il(t)}`,i)}const Ml=/\s\s*/,Rl=(()=>{let e=!1;if(wa){let t=!1;const i=()=>{},n=Object.defineProperty({},"once",{get:()=>(e=!0,t),set(e){t=e}});ka.addEventListener("test",i,n),ka.removeEventListener("test",i,n)}return e})();function $l(e,t,i,n={}){let s=i;t.trim().split(Ml).forEach((t=>{if(!Rl){const{listeners:n}=e;n&&n[t]&&n[t][i]&&(s=n[t][i],delete n[t][i],0===Object.keys(n[t]).length&&delete n[t],0===Object.keys(n).length&&delete e.listeners)}e.removeEventListener(t,s,n)}))}function Bl(e,t,i,n={}){let s=i;t.trim().split(Ml).forEach((t=>{if(n.once&&!Rl){const{listeners:r={}}=e;s=(...o)=>{delete r[t][i],e.removeEventListener(t,s,n),i.apply(e,o)},r[t]||(r[t]={}),r[t][i]&&e.removeEventListener(t,r[t][i],n),r[t][i]=s,e.listeners=r}e.addEventListener(t,s,n)}))}function Nl(e,t,i){let n;return wl(Event)&&wl(CustomEvent)?n=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(n=document.createEvent("CustomEvent"),n.initCustomEvent(t,!0,!0,i)),e.dispatchEvent(n)}function Fl(e){const t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}const{location:ql}=ka,Hl=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ul(e){const t=e.match(Hl);return null!==t&&(t[1]!==ql.protocol||t[2]!==ql.hostname||t[3]!==ql.port)}function Vl(e){const t=`timestamp=${(new Date).getTime()}`;return e+(-1===e.indexOf("?")?"?":"&")+t}function Wl({rotate:e,scaleX:t,scaleY:i,translateX:n,translateY:s}){const r=[];ml(n)&&0!==n&&r.push(`translateX(${n}px)`),ml(s)&&0!==s&&r.push(`translateY(${s}px)`),ml(e)&&0!==e&&r.push(`rotate(${e}deg)`),ml(t)&&1!==t&&r.push(`scaleX(${t})`),ml(i)&&1!==i&&r.push(`scaleY(${i})`);const o=r.length?r.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function Yl({pageX:e,pageY:t},i){const n={endX:e,endY:t};return i?n:{startX:e,startY:t,...n}}function Xl({aspectRatio:e,height:t,width:i},n="contain"){const s=gl(i),r=gl(t);if(s&&r){const s=t*e;"contain"===n&&s>i||"cover"===n&&s<i?t=i/e:i=t*e}else s?t=i/e:r&&(i=t*e);return{width:i,height:t}}const{fromCharCode:Zl}=String,Kl=/^data:.*,/;const Gl={render(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer(){const{element:e,options:t,container:i,cropper:n}=this,s=Number(t.minContainerWidth),r=Number(t.minContainerHeight);jl(n,Ba),Ll(e,Ba);const o={width:Math.max(i.offsetWidth,s>=0?s:200),height:Math.max(i.offsetHeight,r>=0?r:100)};this.containerData=o,Tl(n,{width:o.width,height:o.height}),jl(e,Ba),Ll(n,Ba)},initCanvas(){const{containerData:e,imageData:t}=this,{viewMode:i}=this.options,n=Math.abs(t.rotate)%180==90,s=n?t.naturalHeight:t.naturalWidth,r=n?t.naturalWidth:t.naturalHeight,o=s/r;let a=e.width,l=e.height;e.height*o>e.width?3===i?a=e.height*o:l=e.width/o:3===i?l=e.width/o:a=e.height*o;const c={aspectRatio:o,naturalWidth:s,naturalHeight:r,width:a,height:l};this.canvasData=c,this.limited=1===i||2===i,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=Cl({},c)},limitCanvas(e,t){const{options:i,containerData:n,canvasData:s,cropBoxData:r}=this,{viewMode:o}=i,{aspectRatio:a}=s,l=this.cropped&&r;if(e){let e=Number(i.minCanvasWidth)||0,t=Number(i.minCanvasHeight)||0;o>1?(e=Math.max(e,n.width),t=Math.max(t,n.height),3===o&&(t*a>e?e=t*a:t=e/a)):o>0&&(e?e=Math.max(e,l?r.width:0):t?t=Math.max(t,l?r.height:0):l&&(e=r.width,t=r.height,t*a>e?e=t*a:t=e/a)),({width:e,height:t}=Xl({aspectRatio:a,width:e,height:t})),s.minWidth=e,s.minHeight=t,s.maxWidth=1/0,s.maxHeight=1/0}if(t)if(o>(l?0:1)){const e=n.width-s.width,t=n.height-s.height;s.minLeft=Math.min(0,e),s.minTop=Math.min(0,t),s.maxLeft=Math.max(0,e),s.maxTop=Math.max(0,t),l&&this.limited&&(s.minLeft=Math.min(r.left,r.left+(r.width-s.width)),s.minTop=Math.min(r.top,r.top+(r.height-s.height)),s.maxLeft=r.left,s.maxTop=r.top,2===o&&(s.width>=n.width&&(s.minLeft=Math.min(0,e),s.maxLeft=Math.max(0,e)),s.height>=n.height&&(s.minTop=Math.min(0,t),s.maxTop=Math.max(0,t))))}else s.minLeft=-s.width,s.minTop=-s.height,s.maxLeft=n.width,s.maxTop=n.height},renderCanvas(e,t){const{canvasData:i,imageData:n}=this;if(t){const{width:e,height:t}=function({width:e,height:t,degree:i}){if(90==(i=Math.abs(i)%180))return{width:t,height:e};const n=i%90*Math.PI/180,s=Math.sin(n),r=Math.cos(n),o=e*r+t*s,a=e*s+t*r;return i>90?{width:a,height:o}:{width:o,height:a}}({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),s=i.width*(e/i.naturalWidth),r=i.height*(t/i.naturalHeight);i.left-=(s-i.width)/2,i.top-=(r-i.height)/2,i.width=s,i.height=r,i.aspectRatio=e/t,i.naturalWidth=e,i.naturalHeight=t,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,Tl(this.canvas,Cl({width:i.width,height:i.height},Wl({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage(e){const{canvasData:t,imageData:i}=this,n=i.naturalWidth*(t.width/t.naturalWidth),s=i.naturalHeight*(t.height/t.naturalHeight);Cl(i,{width:n,height:s,left:(t.width-n)/2,top:(t.height-s)/2}),Tl(this.image,Cl({width:i.width,height:i.height},Wl(Cl({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox(){const{options:e,canvasData:t}=this,i=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,s={width:t.width,height:t.height};i&&(t.height*i>t.width?s.height=s.width/i:s.width=s.height*i),this.cropBoxData=s,this.limitCropBox(!0,!0),s.width=Math.min(Math.max(s.width,s.minWidth),s.maxWidth),s.height=Math.min(Math.max(s.height,s.minHeight),s.maxHeight),s.width=Math.max(s.minWidth,s.width*n),s.height=Math.max(s.minHeight,s.height*n),s.left=t.left+(t.width-s.width)/2,s.top=t.top+(t.height-s.height)/2,s.oldLeft=s.left,s.oldTop=s.top,this.initialCropBoxData=Cl({},s)},limitCropBox(e,t){const{options:i,containerData:n,canvasData:s,cropBoxData:r,limited:o}=this,{aspectRatio:a}=i;if(e){let e=Number(i.minCropBoxWidth)||0,t=Number(i.minCropBoxHeight)||0,l=o?Math.min(n.width,s.width,s.width+s.left,n.width-s.left):n.width,c=o?Math.min(n.height,s.height,s.height+s.top,n.height-s.top):n.height;e=Math.min(e,n.width),t=Math.min(t,n.height),a&&(e&&t?t*a>e?t=e/a:e=t*a:e?t=e/a:t&&(e=t*a),c*a>l?c=l/a:l=c*a),r.minWidth=Math.min(e,l),r.minHeight=Math.min(t,c),r.maxWidth=l,r.maxHeight=c}t&&(o?(r.minLeft=Math.max(0,s.left),r.minTop=Math.max(0,s.top),r.maxLeft=Math.min(n.width,s.left+s.width)-r.width,r.maxTop=Math.min(n.height,s.top+s.height)-r.height):(r.minLeft=0,r.minTop=0,r.maxLeft=n.width-r.width,r.maxTop=n.height-r.height))},renderCropBox(){const{options:e,containerData:t,cropBoxData:i}=this;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&Pl(this.face,Ua,i.width>=t.width&&i.height>=t.height?Aa:Ea),Tl(this.cropBox,Cl({width:i.width,height:i.height},Wl({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output(){this.preview(),Nl(this.element,Za,this.getData())}},Jl={initPreview(){const{element:e,crossOrigin:t}=this,{preview:i}=this.options,n=t?this.crossOriginUrl:this.url,s=e.alt||"The image to preview",r=document.createElement("img");if(t&&(r.crossOrigin=t),r.src=n,r.alt=s,this.viewBox.appendChild(r),this.viewBoxImage=r,!i)return;let o=i;"string"==typeof i?o=e.ownerDocument.querySelectorAll(i):i.querySelector&&(o=[i]),this.previews=o,_l(o,(e=>{const i=document.createElement("img");Pl(e,Va,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(i.crossOrigin=t),i.src=n,i.alt=s,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(i)}))},resetPreview(){_l(this.previews,(e=>{const t=zl(e,Va);Tl(e,{width:t.width,height:t.height}),e.innerHTML=t.html,function(e,t){if(vl(e[t]))try{delete e[t]}catch(i){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(i){e.dataset[t]=void 0}else e.removeAttribute(`data-${Il(t)}`)}(e,Va)}))},preview(){const{imageData:e,canvasData:t,cropBoxData:i}=this,{width:n,height:s}=i,{width:r,height:o}=e,a=i.left-t.left-e.left,l=i.top-t.top-e.top;this.cropped&&!this.disabled&&(Tl(this.viewBoxImage,Cl({width:r,height:o},Wl(Cl({translateX:-a,translateY:-l},e)))),_l(this.previews,(t=>{const i=zl(t,Va),c=i.width,h=i.height;let d=c,u=h,p=1;n&&(p=c/n,u=s*p),s&&u>h&&(p=h/s,d=n*p,u=h),Tl(t,{width:d,height:u}),Tl(t.getElementsByTagName("img")[0],Cl({width:r*p,height:o*p},Wl(Cl({translateX:-a*p,translateY:-l*p},e))))})))}},Ql={bind(){const{element:e,options:t,cropper:i}=this;wl(t.cropstart)&&Bl(e,Ja,t.cropstart),wl(t.cropmove)&&Bl(e,Ga,t.cropmove),wl(t.cropend)&&Bl(e,Ka,t.cropend),wl(t.crop)&&Bl(e,Za,t.crop),wl(t.zoom)&&Bl(e,ol,t.zoom),Bl(i,el,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&Bl(i,rl,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Bl(i,Qa,this.onDblclick=this.dblclick.bind(this)),Bl(e.ownerDocument,tl,this.onCropMove=this.cropMove.bind(this)),Bl(e.ownerDocument,il,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&Bl(window,sl,this.onResize=this.resize.bind(this))},unbind(){const{element:e,options:t,cropper:i}=this;wl(t.cropstart)&&$l(e,Ja,t.cropstart),wl(t.cropmove)&&$l(e,Ga,t.cropmove),wl(t.cropend)&&$l(e,Ka,t.cropend),wl(t.crop)&&$l(e,Za,t.crop),wl(t.zoom)&&$l(e,ol,t.zoom),$l(i,el,this.onCropStart),t.zoomable&&t.zoomOnWheel&&$l(i,rl,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&$l(i,Qa,this.onDblclick),$l(e.ownerDocument,tl,this.onCropMove),$l(e.ownerDocument,il,this.onCropEnd),t.responsive&&$l(window,sl,this.onResize)}},ec={resize(){if(this.disabled)return;const{options:e,container:t,containerData:i}=this,n=t.offsetWidth/i.width,s=t.offsetHeight/i.height,r=Math.abs(n-1)>Math.abs(s-1)?n:s;if(1!==r){let t,i;e.restore&&(t=this.getCanvasData(),i=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(_l(t,((e,i)=>{t[i]=e*r}))),this.setCropBoxData(_l(i,((e,t)=>{i[t]=e*r}))))}},dblclick(){var e,t;this.disabled||this.options.dragMode===Xa||this.setDragMode((e=this.dragBox,t=Ra,(e.classList?e.classList.contains(t):e.className.indexOf(t)>-1)?Ya:Wa))},wheel(e){const t=Number(this.options.wheelZoomRatio)||.1;let i=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((()=>{this.wheeling=!1}),50),e.deltaY?i=e.deltaY>0?1:-1:e.wheelDelta?i=-e.wheelDelta/120:e.detail&&(i=e.detail>0?1:-1),this.zoom(-i*t,e)))},cropStart(e){const{buttons:t,button:i}=e;if(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(ml(t)&&1!==t||ml(i)&&0!==i||e.ctrlKey))return;const{options:n,pointers:s}=this;let r;e.changedTouches?_l(e.changedTouches,(e=>{s[e.identifier]=Yl(e)})):s[e.pointerId||0]=Yl(e),r=Object.keys(s).length>1&&n.zoomable&&n.zoomOnTouch?Ta:zl(e.target,Ua),ll.test(r)&&!1!==Nl(this.element,Ja,{originalEvent:e,action:r})&&(e.preventDefault(),this.action=r,this.cropping=!1,r===Sa&&(this.cropping=!0,jl(this.dragBox,qa)))},cropMove(e){const{action:t}=this;if(this.disabled||!t)return;const{pointers:i}=this;e.preventDefault(),!1!==Nl(this.element,Ga,{originalEvent:e,action:t})&&(e.changedTouches?_l(e.changedTouches,(e=>{Cl(i[e.identifier]||{},Yl(e,!0))})):Cl(i[e.pointerId||0]||{},Yl(e,!0)),this.change(e))},cropEnd(e){if(this.disabled)return;const{action:t,pointers:i}=this;e.changedTouches?_l(e.changedTouches,(e=>{delete i[e.identifier]})):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,Dl(this.dragBox,qa,this.cropped&&this.options.modal)),Nl(this.element,Ka,{originalEvent:e,action:t}))}},tc={change(e){const{options:t,canvasData:i,containerData:n,cropBoxData:s,pointers:r}=this;let{action:o}=this,{aspectRatio:a}=t,{left:l,top:c,width:h,height:d}=s;const u=l+h,p=c+d;let m,g=0,f=0,v=n.width,y=n.height,b=!0;!a&&e.shiftKey&&(a=h&&d?h/d:1),this.limited&&(({minLeft:g,minTop:f}=s),v=g+Math.min(n.width,i.width,i.left+i.width),y=f+Math.min(n.height,i.height,i.top+i.height));const w=r[Object.keys(r)[0]],k={x:w.endX-w.startX,y:w.endY-w.startY},x=e=>{switch(e){case ja:u+k.x>v&&(k.x=v-u);break;case La:l+k.x<g&&(k.x=g-l);break;case Oa:c+k.y<f&&(k.y=f-c);break;case Da:p+k.y>y&&(k.y=y-p)}};switch(o){case Ea:l+=k.x,c+=k.y;break;case ja:if(k.x>=0&&(u>=v||a&&(c<=f||p>=y))){b=!1;break}x(ja),h+=k.x,h<0&&(o=La,h=-h,l-=h),a&&(d=h/a,c+=(s.height-d)/2);break;case Oa:if(k.y<=0&&(c<=f||a&&(l<=g||u>=v))){b=!1;break}x(Oa),d-=k.y,c+=k.y,d<0&&(o=Da,d=-d,c-=d),a&&(h=d*a,l+=(s.width-h)/2);break;case La:if(k.x<=0&&(l<=g||a&&(c<=f||p>=y))){b=!1;break}x(La),h-=k.x,l+=k.x,h<0&&(o=ja,h=-h,l-=h),a&&(d=h/a,c+=(s.height-d)/2);break;case Da:if(k.y>=0&&(p>=y||a&&(l<=g||u>=v))){b=!1;break}x(Da),d+=k.y,d<0&&(o=Oa,d=-d,c-=d),a&&(h=d*a,l+=(s.width-h)/2);break;case Ia:if(a){if(k.y<=0&&(c<=f||u>=v)){b=!1;break}x(Oa),d-=k.y,c+=k.y,h=d*a}else x(Oa),x(ja),k.x>=0?u<v?h+=k.x:k.y<=0&&c<=f&&(b=!1):h+=k.x,k.y<=0?c>f&&(d-=k.y,c+=k.y):(d-=k.y,c+=k.y);h<0&&d<0?(o=Ma,d=-d,h=-h,c-=d,l-=h):h<0?(o=za,h=-h,l-=h):d<0&&(o=Pa,d=-d,c-=d);break;case za:if(a){if(k.y<=0&&(c<=f||l<=g)){b=!1;break}x(Oa),d-=k.y,c+=k.y,h=d*a,l+=s.width-h}else x(Oa),x(La),k.x<=0?l>g?(h-=k.x,l+=k.x):k.y<=0&&c<=f&&(b=!1):(h-=k.x,l+=k.x),k.y<=0?c>f&&(d-=k.y,c+=k.y):(d-=k.y,c+=k.y);h<0&&d<0?(o=Pa,d=-d,h=-h,c-=d,l-=h):h<0?(o=Ia,h=-h,l-=h):d<0&&(o=Ma,d=-d,c-=d);break;case Ma:if(a){if(k.x<=0&&(l<=g||p>=y)){b=!1;break}x(La),h-=k.x,l+=k.x,d=h/a}else x(Da),x(La),k.x<=0?l>g?(h-=k.x,l+=k.x):k.y>=0&&p>=y&&(b=!1):(h-=k.x,l+=k.x),k.y>=0?p<y&&(d+=k.y):d+=k.y;h<0&&d<0?(o=Ia,d=-d,h=-h,c-=d,l-=h):h<0?(o=Pa,h=-h,l-=h):d<0&&(o=za,d=-d,c-=d);break;case Pa:if(a){if(k.x>=0&&(u>=v||p>=y)){b=!1;break}x(ja),h+=k.x,d=h/a}else x(Da),x(ja),k.x>=0?u<v?h+=k.x:k.y>=0&&p>=y&&(b=!1):h+=k.x,k.y>=0?p<y&&(d+=k.y):d+=k.y;h<0&&d<0?(o=za,d=-d,h=-h,c-=d,l-=h):h<0?(o=Ma,h=-h,l-=h):d<0&&(o=Ia,d=-d,c-=d);break;case Aa:this.move(k.x,k.y),b=!1;break;case Ta:this.zoom(function(e){const t={...e};let i=0;return _l(e,((e,n)=>{delete t[n],_l(t,(t=>{const n=Math.abs(e.startX-t.startX),s=Math.abs(e.startY-t.startY),r=Math.abs(e.endX-t.endX),o=Math.abs(e.endY-t.endY),a=Math.sqrt(n*n+s*s),l=(Math.sqrt(r*r+o*o)-a)/a;Math.abs(l)>Math.abs(i)&&(i=l)}))})),i}(r),e),b=!1;break;case Sa:if(!k.x||!k.y){b=!1;break}m=Fl(this.cropper),l=w.startX-m.left,c=w.startY-m.top,h=s.minWidth,d=s.minHeight,k.x>0?o=k.y>0?Pa:Ia:k.x<0&&(l-=h,o=k.y>0?Ma:za),k.y<0&&(c-=d),this.cropped||(Ll(this.cropBox,Ba),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}b&&(s.width=h,s.height=d,s.left=l,s.top=c,this.action=o,this.renderCropBox()),_l(r,(e=>{e.startX=e.endX,e.startY=e.endY}))}},ic={crop(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&jl(this.dragBox,qa),Ll(this.cropBox,Ba),this.setCropBoxData(this.initialCropBoxData)),this},reset(){return this.ready&&!this.disabled&&(this.imageData=Cl({},this.initialImageData),this.canvasData=Cl({},this.initialCanvasData),this.cropBoxData=Cl({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear(){return this.cropped&&!this.disabled&&(Cl(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Ll(this.dragBox,qa),jl(this.cropBox,Ba)),this},replace(e,t=!1){return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,_l(this.previews,(t=>{t.getElementsByTagName("img")[0].src=e})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable(){return this.ready&&this.disabled&&(this.disabled=!1,Ll(this.cropper,$a)),this},disable(){return this.ready&&!this.disabled&&(this.disabled=!0,jl(this.cropper,$a)),this},destroy(){const{element:e}=this;return e[Ca]?(e[Ca]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move(e,t=e){const{left:i,top:n}=this.canvasData;return this.moveTo(fl(e)?e:i+Number(e),fl(t)?t:n+Number(t))},moveTo(e,t=e){const{canvasData:i}=this;let n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(ml(e)&&(i.left=e,n=!0),ml(t)&&(i.top=t,n=!0),n&&this.renderCanvas(!0)),this},zoom(e,t){const{canvasData:i}=this;return e=(e=Number(e))<0?1/(1-e):1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo(e,t,i){const{options:n,canvasData:s}=this,{width:r,height:o,naturalWidth:a,naturalHeight:l}=s;if((e=Number(e))>=0&&this.ready&&!this.disabled&&n.zoomable){const n=a*e,c=l*e;if(!1===Nl(this.element,ol,{ratio:e,oldRatio:r/a,originalEvent:i}))return this;if(i){const{pointers:e}=this,t=Fl(this.cropper),a=e&&Object.keys(e).length?function(e){let t=0,i=0,n=0;return _l(e,(({startX:e,startY:s})=>{t+=e,i+=s,n+=1})),t/=n,i/=n,{pageX:t,pageY:i}}(e):{pageX:i.pageX,pageY:i.pageY};s.left-=(n-r)*((a.pageX-t.left-s.left)/r),s.top-=(c-o)*((a.pageY-t.top-s.top)/o)}else bl(t)&&ml(t.x)&&ml(t.y)?(s.left-=(n-r)*((t.x-s.left)/r),s.top-=(c-o)*((t.y-s.top)/o)):(s.left-=(n-r)/2,s.top-=(c-o)/2);s.width=n,s.height=c,this.renderCanvas(!0)}return this},rotate(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo(e){return ml(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX(e){const{scaleY:t}=this.imageData;return this.scale(e,ml(t)?t:1)},scaleY(e){const{scaleX:t}=this.imageData;return this.scale(ml(t)?t:1,e)},scale(e,t=e){const{imageData:i}=this;let n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(ml(e)&&(i.scaleX=e,n=!0),ml(t)&&(i.scaleY=t,n=!0),n&&this.renderCanvas(!0,!0)),this},getData(e=!1){const{options:t,imageData:i,canvasData:n,cropBoxData:s}=this;let r;if(this.ready&&this.cropped){r={x:s.left-n.left,y:s.top-n.top,width:s.width,height:s.height};const t=i.width/i.naturalWidth;if(_l(r,((e,i)=>{r[i]=e/t})),e){const e=Math.round(r.y+r.height),t=Math.round(r.x+r.width);r.x=Math.round(r.x),r.y=Math.round(r.y),r.width=t-r.x,r.height=e-r.y}}else r={x:0,y:0,width:0,height:0};return t.rotatable&&(r.rotate=i.rotate||0),t.scalable&&(r.scaleX=i.scaleX||1,r.scaleY=i.scaleY||1),r},setData(e){const{options:t,imageData:i,canvasData:n}=this,s={};if(this.ready&&!this.disabled&&bl(e)){let r=!1;t.rotatable&&ml(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,r=!0),t.scalable&&(ml(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,r=!0),ml(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,r=!0)),r&&this.renderCanvas(!0,!0);const o=i.width/i.naturalWidth;ml(e.x)&&(s.left=e.x*o+n.left),ml(e.y)&&(s.top=e.y*o+n.top),ml(e.width)&&(s.width=e.width*o),ml(e.height)&&(s.height=e.height*o),this.setCropBoxData(s)}return this},getContainerData(){return this.ready?Cl({},this.containerData):{}},getImageData(){return this.sized?Cl({},this.imageData):{}},getCanvasData(){const{canvasData:e}=this,t={};return this.ready&&_l(["left","top","width","height","naturalWidth","naturalHeight"],(i=>{t[i]=e[i]})),t},setCanvasData(e){const{canvasData:t}=this,{aspectRatio:i}=t;return this.ready&&!this.disabled&&bl(e)&&(ml(e.left)&&(t.left=e.left),ml(e.top)&&(t.top=e.top),ml(e.width)?(t.width=e.width,t.height=e.width/i):ml(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData(){const{cropBoxData:e}=this;let t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData(e){const{cropBoxData:t}=this,{aspectRatio:i}=this.options;let n,s;return this.ready&&this.cropped&&!this.disabled&&bl(e)&&(ml(e.left)&&(t.left=e.left),ml(e.top)&&(t.top=e.top),ml(e.width)&&e.width!==t.width&&(n=!0,t.width=e.width),ml(e.height)&&e.height!==t.height&&(s=!0,t.height=e.height),i&&(n?t.height=t.width/i:s&&(t.width=t.height*i)),this.renderCropBox()),this},getCroppedCanvas(e={}){if(!this.ready||!window.HTMLCanvasElement)return null;const{canvasData:t}=this,i=function(e,{aspectRatio:t,naturalWidth:i,naturalHeight:n,rotate:s=0,scaleX:r=1,scaleY:o=1},{aspectRatio:a,naturalWidth:l,naturalHeight:c},{fillColor:h="transparent",imageSmoothingEnabled:d=!0,imageSmoothingQuality:u="low",maxWidth:p=1/0,maxHeight:m=1/0,minWidth:g=0,minHeight:f=0}){const v=document.createElement("canvas"),y=v.getContext("2d"),b=Xl({aspectRatio:a,width:p,height:m}),w=Xl({aspectRatio:a,width:g,height:f},"cover"),k=Math.min(b.width,Math.max(w.width,l)),x=Math.min(b.height,Math.max(w.height,c)),_=Xl({aspectRatio:t,width:p,height:m}),C=Xl({aspectRatio:t,width:g,height:f},"cover"),E=Math.min(_.width,Math.max(C.width,i)),S=Math.min(_.height,Math.max(C.height,n)),A=[-E/2,-S/2,E,S];return v.width=Sl(k),v.height=Sl(x),y.fillStyle=h,y.fillRect(0,0,k,x),y.save(),y.translate(k/2,x/2),y.rotate(s*Math.PI/180),y.scale(r,o),y.imageSmoothingEnabled=d,y.imageSmoothingQuality=u,y.drawImage(e,...A.map((e=>Math.floor(Sl(e))))),y.restore(),v}(this.image,this.imageData,t,e);if(!this.cropped)return i;let{x:n,y:s,width:r,height:o}=this.getData();const a=i.width/Math.floor(t.naturalWidth);1!==a&&(n*=a,s*=a,r*=a,o*=a);const l=r/o,c=Xl({aspectRatio:l,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),h=Xl({aspectRatio:l,width:e.minWidth||0,height:e.minHeight||0},"cover");let{width:d,height:u}=Xl({aspectRatio:l,width:e.width||(1!==a?i.width:r),height:e.height||(1!==a?i.height:o)});d=Math.min(c.width,Math.max(h.width,d)),u=Math.min(c.height,Math.max(h.height,u));const p=document.createElement("canvas"),m=p.getContext("2d");p.width=Sl(d),p.height=Sl(u),m.fillStyle=e.fillColor||"transparent",m.fillRect(0,0,d,u);const{imageSmoothingEnabled:g=!0,imageSmoothingQuality:f}=e;m.imageSmoothingEnabled=g,f&&(m.imageSmoothingQuality=f);const v=i.width,y=i.height;let b,w,k,x,_,C,E=n,S=s;E<=-r||E>v?(E=0,b=0,k=0,_=0):E<=0?(k=-E,E=0,b=Math.min(v,r+E),_=b):E<=v&&(k=0,b=Math.min(r,v-E),_=b),b<=0||S<=-o||S>y?(S=0,w=0,x=0,C=0):S<=0?(x=-S,S=0,w=Math.min(y,o+S),C=w):S<=y&&(x=0,w=Math.min(o,y-S),C=w);const A=[E,S,b,w];if(_>0&&C>0){const e=d/r;A.push(k*e,x*e,_*e,C*e)}return m.drawImage(i,...A.map((e=>Math.floor(Sl(e))))),p},setAspectRatio(e){const{options:t}=this;return this.disabled||fl(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode(e){const{options:t,dragBox:i,face:n}=this;if(this.ready&&!this.disabled){const s=e===Wa,r=t.movable&&e===Ya;e=s||r?e:Xa,t.dragMode=e,Pl(i,Ua,e),Dl(i,Ra,s),Dl(i,Ha,r),t.cropBoxMovable||(Pl(n,Ua,e),Dl(n,Ra,s),Dl(n,Ha,r))}return this}},nc=ka.Cropper;class sc{constructor(e,t={}){if(!e||!dl.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=Cl({},ul,bl(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}init(){const{element:e}=this,t=e.tagName.toLowerCase();let i;if(!e[Ca]){if(e[Ca]=this,"img"===t){if(this.isImg=!0,i=e.getAttribute("src")||"",this.originalUrl=i,!i)return;i=e.src}else"canvas"===t&&window.HTMLCanvasElement&&(i=e.toDataURL());this.load(i)}}load(e){if(!e)return;this.url=e,this.imageData={};const{element:t,options:i}=this;if(i.rotatable||i.scalable||(i.checkOrientation=!1),!i.checkOrientation||!window.ArrayBuffer)return void this.clone();if(cl.test(e))return void(hl.test(e)?this.read(function(e){const t=e.replace(Kl,""),i=atob(t),n=new ArrayBuffer(i.length),s=new Uint8Array(n);return _l(s,((e,t)=>{s[t]=i.charCodeAt(t)})),n}(e)):this.clone());const n=new XMLHttpRequest,s=this.clone.bind(this);this.reloading=!0,this.xhr=n,n.onabort=s,n.onerror=s,n.ontimeout=s,n.onprogress=()=>{n.getResponseHeader("content-type")!==al&&n.abort()},n.onload=()=>{this.read(n.response)},n.onloadend=()=>{this.reloading=!1,this.xhr=null},i.checkCrossOrigin&&Ul(e)&&t.crossOrigin&&(e=Vl(e)),n.open("GET",e,!0),n.responseType="arraybuffer",n.withCredentials="use-credentials"===t.crossOrigin,n.send()}read(e){const{options:t,imageData:i}=this,n=function(e){const t=new DataView(e);let i;try{let e,n,s;if(255===t.getUint8(0)&&216===t.getUint8(1)){const e=t.byteLength;let i=2;for(;i+1<e;){if(255===t.getUint8(i)&&225===t.getUint8(i+1)){n=i;break}i+=1}}if(n){const i=n+10;if("Exif"===function(e,t,i){let n="";i+=t;for(let s=t;s<i;s+=1)n+=Zl(e.getUint8(s));return n}(t,n+4,4)){const n=t.getUint16(i);if(e=18761===n,(e||19789===n)&&42===t.getUint16(i+2,e)){const n=t.getUint32(i+4,e);n>=8&&(s=i+n)}}}if(s){const n=t.getUint16(s,e);let r,o;for(o=0;o<n;o+=1)if(r=s+12*o+2,274===t.getUint16(r,e)){r+=8,i=t.getUint16(r,e),t.setUint16(r,1,e);break}}}catch(e){i=1}return i}(e);let s=0,r=1,o=1;n>1&&(this.url=function(e,t){const i=[];let n=new Uint8Array(e);for(;n.length>0;)i.push(Zl.apply(null,xl(n.subarray(0,8192)))),n=n.subarray(8192);return`data:${t};base64,${btoa(i.join(""))}`}(e,al),({rotate:s,scaleX:r,scaleY:o}=function(e){let t=0,i=1,n=1;switch(e){case 2:i=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:n}}(n))),t.rotatable&&(i.rotate=s),t.scalable&&(i.scaleX=r,i.scaleY=o),this.clone()}clone(){const{element:e,url:t}=this;let{crossOrigin:i}=e,n=t;this.options.checkCrossOrigin&&Ul(t)&&(i||(i="anonymous"),n=Vl(t)),this.crossOrigin=i,this.crossOriginUrl=n;const s=document.createElement("img");i&&(s.crossOrigin=i),s.src=n||t,s.alt=e.alt||"The image to crop",this.image=s,s.onload=this.start.bind(this),s.onerror=this.stop.bind(this),jl(s,Na),e.parentNode.insertBefore(s,e.nextSibling)}start(){const{image:e}=this;e.onload=null,e.onerror=null,this.sizing=!0;const t=ka.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(ka.navigator.userAgent),i=(e,t)=>{Cl(this.imageData,{naturalWidth:e,naturalHeight:t,aspectRatio:e/t}),this.initialImageData=Cl({},this.imageData),this.sizing=!1,this.sized=!0,this.build()};if(e.naturalWidth&&!t)return void i(e.naturalWidth,e.naturalHeight);const n=document.createElement("img"),s=document.body||document.documentElement;this.sizingImage=n,n.onload=()=>{i(n.width,n.height),t||s.removeChild(n)},n.src=e.src,t||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",s.appendChild(n))}stop(){const{image:e}=this;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}build(){if(!this.sized||this.ready)return;const{element:e,options:t,image:i}=this,n=e.parentNode,s=document.createElement("div");s.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';const r=s.querySelector(`.${Ca}-container`),o=r.querySelector(`.${Ca}-canvas`),a=r.querySelector(`.${Ca}-drag-box`),l=r.querySelector(`.${Ca}-crop-box`),c=l.querySelector(`.${Ca}-face`);this.container=n,this.cropper=r,this.canvas=o,this.dragBox=a,this.cropBox=l,this.viewBox=r.querySelector(`.${Ca}-view-box`),this.face=c,o.appendChild(i),jl(e,Ba),n.insertBefore(r,e.nextSibling),this.isImg||Ll(i,Na),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,jl(l,Ba),t.guides||jl(l.getElementsByClassName(`${Ca}-dashed`),Ba),t.center||jl(l.getElementsByClassName(`${Ca}-center`),Ba),t.background&&jl(r,`${Ca}-bg`),t.highlight||jl(c,Fa),t.cropBoxMovable&&(jl(c,Ha),Pl(c,Ua,Ea)),t.cropBoxResizable||(jl(l.getElementsByClassName(`${Ca}-line`),Ba),jl(l.getElementsByClassName(`${Ca}-point`),Ba)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),wl(t.ready)&&Bl(e,nl,t.ready,{once:!0}),Nl(e,nl)}unbuild(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Ll(this.element,Ba))}uncreate(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}static noConflict(){return window.Cropper=nc,sc}static setDefaults(e){Cl(ul,bl(e)&&e)}}Cl(sc.prototype,Gl,Jl,Ql,ec,tc,ic);const rc=sc,oc=["edit","preview","test"];class ac{#e;#J=!0;#Q;#ee={};#te;#ie;#ne;#se=[];#re;get area(){return this.#e.area}constructor(e){e.area.classList.add("settings","container-col","m5"),this.#e=e,this.area.oninput=e=>this.#oe(e.target),this.area.onchange=e=>this.#oe(e.target)}load(t,i={}){console.log("Settings load items",t,i),this.#ae();const n=new Map,s=new Set;for(let r of t){if("string"==typeof r&&"opponent"===r&&(r={type:"autocomplete",name:"opponent",title:"Opponent",placeholder:"Select an opponent",value:e=>e.dataset.id,ds:"contact"}),oc.includes(r.type))continue;const t=r.name.toLowerCase();if("custom"==r.type){const n=new r.Instance;this.#ee[t]=n;const s=n.render(i);isPromise(s)?s.then((e=>this.#e.append(e))):this.#e.append(e)}else{let e=!0;r.name in i&&(r.val=i[r.name]);let o=r.type;"json"==o&&(o="text");const a=this.#e.addItemTemplate(`settings-${o}-field`,r);switch(n.set(t.toLowerCase(),r),(r.required&&!r.val||r.check&&r.val&&!r.check(r.val))&&s.add(t),r.type){case"autocomplete":{const e=a.querySelector("input");if(Array.isArray(r.options))mr(e,r.options);else if("function"==typeof r.options){const t=r.options();isPromise(t)?t.then((t=>mr(e,t))):mr(e,t)}}break;case"radio":{const e=a.querySelectorAll("input");if(r.val){for(const t of e)if(t.value==r.val){t.checked=!0;break}}else e[0].checked=!0}break;case"region":case"option":if(r.val){const e=a.querySelector(`select > option[value="${r.val}"]`);e&&(e.selected=!0)}break;case"optiontab":if(r.val){const e=a.querySelector(`select > option[value="${r.val}"]`);e&&(e.selected=!0);const t={};for(const{name:e,fields:i}of r.options)if(i)for(const e of i)t[e.name]=e;const i=a.querySelectorAll("[data-tab] input");for(const e of i){const i=t[e.name];i&&i.val&&(e.value=i.val)}const n=a.querySelectorAll("[data-tab] select");for(const e of n){const i=t[e.name];if(i&&i.val){const t=e.querySelector(`option[value="${i.val}"]`);t&&(t.selected=!0)}}const s=a.querySelector(`[data-tab="${r.val}"]`);s&&dom.moveAfterTop(s)}break;case"text":{const e=a.querySelector("textarea");if(r.val&&(e.value=r.val),r.md){e.setAttribute("md","");const t=new MDE({element:e,spellChecker:!1,autoDownloadFontAwesome:!1});this.#te=t}}break;case"json":{const e=a.querySelector("textarea");e.setAttribute("type","json"),r.val&&(e.value=JSON.stringify(r.val))}break;case"list":if(r.val&&Array.isArray(r.val)){const e=a.querySelector("ul");for(const t of r.val){const i=dom.renderTemplate(r.template,t,"li");e.appendChild(i)}}break;case"faicon":{const e=ba({rootElement:a.querySelector(".picker"),theme:"dark"});this.#se.push(e)}break;default:e||a.querySelector("input").setAttribute("readonly","")}}}this.#ie=n,this.#ne=s,this.#J=0==s.size,this.onvalidchange(this.#J)}getData(){const e={},t=this.#le();for(const i of t)if(""!=i.name)switch(i.tagName){case"INPUT":if(i.dataset.id)e[i.name]=i.dataset.id;else switch(i.type){case"checkbox":e[i.name]=!!i.checked;break;case"radio":i.checked&&(e[i.name]=i.value);break;case"number":e[i.name]=Number(i.value);break;default:e[i.name]=i.value}break;case"TEXTAREA":if(i.hasAttribute("md")){e[i.name]=this.#te.value();break}if("json"==i.getAttribute("type")){e[i.name]=JSON.parse(i.value);break}default:e[i.name]=i.value}const i=this.#ce();for(const t of i){const i=Array.from(t.querySelectorAll("li[data-id]")).map((e=>e.dataset.id));e[t.getAttribute("name")]=i}if(this.#Q)for(const[t,i]of Object.entries(this.#Q))e[t]=i.getValue();for(const[t,i]of Object.entries(this.#ee))e[t]=i.getValue();return this.#re&&(e.photo=function(e){const t=e.getCroppedCanvas();var i,n,s,r,o;return(i=t,n=document.createElement("canvas"),s=n.getContext("2d"),r=i.width,o=i.height,n.width=r,n.height=o,s.imageSmoothingEnabled=!0,s.drawImage(i,0,0,r,o),s.globalCompositeOperation="destination-in",s.beginPath(),s.arc(r/2,o/2,Math.min(r,o)/2,0,2*Math.PI,!0),s.fill(),n).toDataURL("image/png")}(this.#re)),e}onvalidchange(e){console.log("Setting valid change",e)}async onFileDrop(e){const t=this.#e.querySelector(".dropzone");if(t){dom.removeChilds(t),t.classList.add("active");for(const i of e){this.#re=await lc(i,t);break}}}#le(e=!0){const t=e?"input,select,textarea:not([data-mode])":"input,select,textarea";return this.area.querySelectorAll(t)}#he(){return this.area.querySelectorAll("textarea[data-mode]")}#ce(){return this.area.querySelectorAll("ul[name]")}#ae(){if(this.#ee={},this.#re&&(this.#re.destroy(),this.#re=null),this.#te&&(this.#te.toTextArea(),this.#te=null),this.#Q){for(const e of Object.values(this.#Q))e.toTextArea();this.#Q=void 0}for(const e of this.#se)e.destroy();this.#se=[],this.#e.removeContent()}#oe(e){if(""==e.name||"TEXTAREA"!=e.tagName&&("INPUT"!=e.tagName||["checkbox","radio","color"].includes(e.type)))return;const t=this.#ie,i=this.#ne,n="INPUT"==e.tagName&&"checkbox"==e.type?!!e.checked:e.value,s=e.name,{check:r}=t.get(s);r&&!r(n)?(i.add(s),e.classList.add("error")):(i.delete(s),e.classList.remove("error")),0==i.size?(this.#J||this.onvalidchange(!0),this.#J=!0):(this.#J&&this.onvalidchange(!1),this.#J=!1)}}async function lc(e,t,i="default"){const n=await loadImage(e,600);console.debug("PHOTO loaded",e.name),t.appendChild(n);const s=new rc(n,{aspectRatio:1,viewMode:1,ready:function(){}});return s.name=i,s}Object.assign(ac.prototype,UX.ListMixin);const cc={string:(e={})=>(hc(e),Object.assign({type:"string",value:e=>e.value,valid:e=>!0},e)),time:(e={})=>(hc(e),Object.assign({type:"time",value:e=>e.value,valid:e=>!0},e)),integer:(e={})=>(hc(e),Object.assign({type:"number",value:e=>Number(e.value),valid:e=>!0},e)),option:(e={})=>(hc(e),Object.assign({type:"option",value:e=>e.value.toLowerCase()},e)),variant:(e={})=>(hc(e),Object.assign({type:"variant",value:e=>e.value.toLowerCase(),valid:e=>!0},e)),text:(e={})=>(hc(e),Object.assign({type:"text",value:e=>e.value,valid:e=>!0},e)),radio:(e={})=>(hc(e),Object.assign({type:"radio",value:e=>e.value.toLowerCase(),valid:e=>!0},e)),list:(e={})=>(hc(e),Object.assign({type:"list"},e)),content:(e={})=>(hc(e),Object.assign({type:"content"},e)),required(e){const t={...e};return t.required=!0,t},name:{type:"string",name:"name",title:"Name",value:e=>e.value,check:e=>e.length>2,noedit:!0},firstname:{type:"string",name:"firstname",value:e=>e.value,check:e=>e.length>2},lastname:{type:"string",name:"lastname",value:e=>e.value,check:e=>e.length>=2},desc:{type:"text",name:"desc",title:"Description",value:e=>e.value,valid:e=>!0},email:{type:"string",name:"email",title:"Email",value:e=>e.value,check:validate.email},ns:{type:"string",name:"ns",title:"Namespace",value:e=>e.value,check:e=>e.length>3},domain:{type:"string",name:"domain",title:"Domain",value:e=>e.value,check:validate.domain},url:{type:"string",name:"url",title:"Url",value:e=>e.value,check:validate.url},role:{type:"option",name:"role",title:"Role",options:["User","Site admin","Admin"],value:e=>e.value.toLowerCase().replace(/ /g,""),valid:e=>!0},access:{type:"option",name:"access",title:"Access",options:["Public","Private"],value:e=>e.value.toLowerCase(),valid:e=>!0},perm:{type:"option",name:"perm",title:"Permission",options:["Full","Read only"],value:e=>e.value.toLowerCase().replace(/ /g,""),valid:e=>!0},channel:{type:"option",name:"channel",title:"Channel",options:()=>app.contacts.getChannels(),value:e=>Number(e.value),valid:e=>!0},comp:{type:"option",name:"comp",title:"Component",options:()=>app.contacts.getComponents(),value:e=>Number(e.value),valid:e=>!0},timeout:{type:"number",name:"timeout",title:"Timeout",value:e=>Number(e.value),valid:e=>!0},tls:{type:"boolean",name:"tls",title:"Tls",value:e=>e.checked,valid:e=>!0},category:{type:"option",name:"category",title:"Category",options:["News","Social","Sport","Education","Fun"],value:e=>e.value.toLowerCase(),valid:e=>!0},region:{type:"region",name:"region",title:"Region",options:["EU","Bulgaria"],value:e=>e.value.toLowerCase(),valid:e=>!0},tag:{type:"string",name:"tag",title:"Tag",value:e=>e.value.toLowerCase(),valid:e=>e.length>2}};function hc(e){e.title||(e.title=e.name.capitalizeFirstLetter(),e.name=e.name.toLowerCase())}function dc(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))}class uc extends Mr{}var pc="top",mc="bottom",gc="right",fc="left",vc="auto",yc=[pc,mc,gc,fc],bc="start",wc="end",kc="clippingParents",xc="viewport",_c="popper",Cc="reference",Ec=yc.reduce((function(e,t){return e.concat([t+"-"+bc,t+"-"+wc])}),[]),Sc=[].concat(yc,[vc]).reduce((function(e,t){return e.concat([t,t+"-"+bc,t+"-"+wc])}),[]),Ac=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Tc(e){return e?(e.nodeName||"").toLowerCase():null}function jc(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Lc(e){return e instanceof jc(e).Element||e instanceof Element}function Dc(e){return e instanceof jc(e).HTMLElement||e instanceof HTMLElement}function Oc(e){return"undefined"!=typeof ShadowRoot&&(e instanceof jc(e).ShadowRoot||e instanceof ShadowRoot)}var Ic={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var i=t.styles[e]||{},n=t.attributes[e]||{},s=t.elements[e];Dc(s)&&Tc(s)&&(Object.assign(s.style,i),Object.keys(n).forEach((function(e){var t=n[e];!1===t?s.removeAttribute(e):s.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach((function(e){var n=t.elements[e],s=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce((function(e,t){return e[t]="",e}),{});Dc(n)&&Tc(n)&&(Object.assign(n.style,r),Object.keys(s).forEach((function(e){n.removeAttribute(e)})))}))}},requires:["computeStyles"]};function zc(e){return e.split("-")[0]}var Pc=Math.max,Mc=Math.min,Rc=Math.round;function $c(e,t){void 0===t&&(t=!1);var i=e.getBoundingClientRect(),n=1,s=1;if(Dc(e)&&t){var r=e.offsetHeight,o=e.offsetWidth;o>0&&(n=Rc(i.width)/o||1),r>0&&(s=Rc(i.height)/r||1)}return{width:i.width/n,height:i.height/s,top:i.top/s,right:i.right/n,bottom:i.bottom/s,left:i.left/n,x:i.left/n,y:i.top/s}}function Bc(e){var t=$c(e),i=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:n}}function Nc(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&Oc(i)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Fc(e){return jc(e).getComputedStyle(e)}function qc(e){return["table","td","th"].indexOf(Tc(e))>=0}function Hc(e){return((Lc(e)?e.ownerDocument:e.document)||window.document).documentElement}function Uc(e){return"html"===Tc(e)?e:e.assignedSlot||e.parentNode||(Oc(e)?e.host:null)||Hc(e)}function Vc(e){return Dc(e)&&"fixed"!==Fc(e).position?e.offsetParent:null}function Wc(e){for(var t=jc(e),i=Vc(e);i&&qc(i)&&"static"===Fc(i).position;)i=Vc(i);return i&&("html"===Tc(i)||"body"===Tc(i)&&"static"===Fc(i).position)?t:i||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Dc(e)&&"fixed"===Fc(e).position)return null;var i=Uc(e);for(Oc(i)&&(i=i.host);Dc(i)&&["html","body"].indexOf(Tc(i))<0;){var n=Fc(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||t&&"filter"===n.willChange||t&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(e)||t}function Yc(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Xc(e,t,i){return Pc(e,Mc(t,i))}function Zc(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Kc(e,t){return t.reduce((function(t,i){return t[i]=e,t}),{})}var Gc={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,n=e.name,s=e.options,r=i.elements.arrow,o=i.modifiersData.popperOffsets,a=zc(i.placement),l=Yc(a),c=[fc,gc].indexOf(a)>=0?"height":"width";if(r&&o){var h=function(e,t){return Zc("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Kc(e,yc))}(s.padding,i),d=Bc(r),u="y"===l?pc:fc,p="y"===l?mc:gc,m=i.rects.reference[c]+i.rects.reference[l]-o[l]-i.rects.popper[c],g=o[l]-i.rects.reference[l],f=Wc(r),v=f?"y"===l?f.clientHeight||0:f.clientWidth||0:0,y=m/2-g/2,b=h[u],w=v-d[c]-h[p],k=v/2-d[c]/2+y,x=Xc(b,k,w),_=l;i.modifiersData[n]=((t={})[_]=x,t.centerOffset=x-k,t)}},effect:function(e){var t=e.state,i=e.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=t.elements.popper.querySelector(n)))&&Nc(t.elements.popper,n)&&(t.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Jc(e){return e.split("-")[1]}var Qc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function eh(e){var t,i=e.popper,n=e.popperRect,s=e.placement,r=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,h=e.roundOffsets,d=e.isFixed,u=o.x,p=void 0===u?0:u,m=o.y,g=void 0===m?0:m,f="function"==typeof h?h({x:p,y:g}):{x:p,y:g};p=f.x,g=f.y;var v=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),b=fc,w=pc,k=window;if(c){var x=Wc(i),_="clientHeight",C="clientWidth";x===jc(i)&&"static"!==Fc(x=Hc(i)).position&&"absolute"===a&&(_="scrollHeight",C="scrollWidth"),(s===pc||(s===fc||s===gc)&&r===wc)&&(w=mc,g-=(d&&x===k&&k.visualViewport?k.visualViewport.height:x[_])-n.height,g*=l?1:-1),s!==fc&&(s!==pc&&s!==mc||r!==wc)||(b=gc,p-=(d&&x===k&&k.visualViewport?k.visualViewport.width:x[C])-n.width,p*=l?1:-1)}var E,S=Object.assign({position:a},c&&Qc),A=!0===h?function(e){var t=e.x,i=e.y,n=window.devicePixelRatio||1;return{x:Rc(t*n)/n||0,y:Rc(i*n)/n||0}}({x:p,y:g}):{x:p,y:g};return p=A.x,g=A.y,l?Object.assign({},S,((E={})[w]=y?"0":"",E[b]=v?"0":"",E.transform=(k.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",E)):Object.assign({},S,((t={})[w]=y?g+"px":"",t[b]=v?p+"px":"",t.transform="",t))}var th={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,n=i.gpuAcceleration,s=void 0===n||n,r=i.adaptive,o=void 0===r||r,a=i.roundOffsets,l=void 0===a||a,c={placement:zc(t.placement),variation:Jc(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,eh(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,eh(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},ih={passive:!0},nh={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,n=e.options,s=n.scroll,r=void 0===s||s,o=n.resize,a=void 0===o||o,l=jc(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&c.forEach((function(e){e.addEventListener("scroll",i.update,ih)})),a&&l.addEventListener("resize",i.update,ih),function(){r&&c.forEach((function(e){e.removeEventListener("scroll",i.update,ih)})),a&&l.removeEventListener("resize",i.update,ih)}},data:{}},sh={left:"right",right:"left",bottom:"top",top:"bottom"};function rh(e){return e.replace(/left|right|bottom|top/g,(function(e){return sh[e]}))}var oh={start:"end",end:"start"};function ah(e){return e.replace(/start|end/g,(function(e){return oh[e]}))}function lh(e){var t=jc(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function ch(e){return $c(Hc(e)).left+lh(e).scrollLeft}function hh(e){var t=Fc(e),i=t.overflow,n=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+n)}function dh(e){return["html","body","#document"].indexOf(Tc(e))>=0?e.ownerDocument.body:Dc(e)&&hh(e)?e:dh(Uc(e))}function uh(e,t){var i;void 0===t&&(t=[]);var n=dh(e),s=n===(null==(i=e.ownerDocument)?void 0:i.body),r=jc(n),o=s?[r].concat(r.visualViewport||[],hh(n)?n:[]):n,a=t.concat(o);return s?a:a.concat(uh(Uc(o)))}function ph(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function mh(e,t){return t===xc?ph(function(e){var t=jc(e),i=Hc(e),n=t.visualViewport,s=i.clientWidth,r=i.clientHeight,o=0,a=0;return n&&(s=n.width,r=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=n.offsetLeft,a=n.offsetTop)),{width:s,height:r,x:o+ch(e),y:a}}(e)):Lc(t)?function(e){var t=$c(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):ph(function(e){var t,i=Hc(e),n=lh(e),s=null==(t=e.ownerDocument)?void 0:t.body,r=Pc(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),o=Pc(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-n.scrollLeft+ch(e),l=-n.scrollTop;return"rtl"===Fc(s||i).direction&&(a+=Pc(i.clientWidth,s?s.clientWidth:0)-r),{width:r,height:o,x:a,y:l}}(Hc(e)))}function gh(e){var t,i=e.reference,n=e.element,s=e.placement,r=s?zc(s):null,o=s?Jc(s):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(r){case pc:t={x:a,y:i.y-n.height};break;case mc:t={x:a,y:i.y+i.height};break;case gc:t={x:i.x+i.width,y:l};break;case fc:t={x:i.x-n.width,y:l};break;default:t={x:i.x,y:i.y}}var c=r?Yc(r):null;if(null!=c){var h="y"===c?"height":"width";switch(o){case bc:t[c]=t[c]-(i[h]/2-n[h]/2);break;case wc:t[c]=t[c]+(i[h]/2-n[h]/2)}}return t}function fh(e,t){void 0===t&&(t={});var i=t,n=i.placement,s=void 0===n?e.placement:n,r=i.boundary,o=void 0===r?kc:r,a=i.rootBoundary,l=void 0===a?xc:a,c=i.elementContext,h=void 0===c?_c:c,d=i.altBoundary,u=void 0!==d&&d,p=i.padding,m=void 0===p?0:p,g=Zc("number"!=typeof m?m:Kc(m,yc)),f=h===_c?Cc:_c,v=e.rects.popper,y=e.elements[u?f:h],b=function(e,t,i){var n="clippingParents"===t?function(e){var t=uh(Uc(e)),i=["absolute","fixed"].indexOf(Fc(e).position)>=0&&Dc(e)?Wc(e):e;return Lc(i)?t.filter((function(e){return Lc(e)&&Nc(e,i)&&"body"!==Tc(e)})):[]}(e):[].concat(t),s=[].concat(n,[i]),r=s[0],o=s.reduce((function(t,i){var n=mh(e,i);return t.top=Pc(n.top,t.top),t.right=Mc(n.right,t.right),t.bottom=Mc(n.bottom,t.bottom),t.left=Pc(n.left,t.left),t}),mh(e,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(Lc(y)?y:y.contextElement||Hc(e.elements.popper),o,l),w=$c(e.elements.reference),k=gh({reference:w,element:v,strategy:"absolute",placement:s}),x=ph(Object.assign({},v,k)),_=h===_c?x:w,C={top:b.top-_.top+g.top,bottom:_.bottom-b.bottom+g.bottom,left:b.left-_.left+g.left,right:_.right-b.right+g.right},E=e.modifiersData.offset;if(h===_c&&E){var S=E[s];Object.keys(C).forEach((function(e){var t=[gc,mc].indexOf(e)>=0?1:-1,i=[pc,mc].indexOf(e)>=0?"y":"x";C[e]+=S[i]*t}))}return C}function vh(e,t){void 0===t&&(t={});var i=t,n=i.placement,s=i.boundary,r=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?Sc:l,h=Jc(n),d=h?a?Ec:Ec.filter((function(e){return Jc(e)===h})):yc,u=d.filter((function(e){return c.indexOf(e)>=0}));0===u.length&&(u=d);var p=u.reduce((function(t,i){return t[i]=fh(e,{placement:i,boundary:s,rootBoundary:r,padding:o})[zc(i)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}var yh={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var s=i.mainAxis,r=void 0===s||s,o=i.altAxis,a=void 0===o||o,l=i.fallbackPlacements,c=i.padding,h=i.boundary,d=i.rootBoundary,u=i.altBoundary,p=i.flipVariations,m=void 0===p||p,g=i.allowedAutoPlacements,f=t.options.placement,v=zc(f),y=l||(v!==f&&m?function(e){if(zc(e)===vc)return[];var t=rh(e);return[ah(e),t,ah(t)]}(f):[rh(f)]),b=[f].concat(y).reduce((function(e,i){return e.concat(zc(i)===vc?vh(t,{placement:i,boundary:h,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:g}):i)}),[]),w=t.rects.reference,k=t.rects.popper,x=new Map,_=!0,C=b[0],E=0;E<b.length;E++){var S=b[E],A=zc(S),T=Jc(S)===bc,j=[pc,mc].indexOf(A)>=0,L=j?"width":"height",D=fh(t,{placement:S,boundary:h,rootBoundary:d,altBoundary:u,padding:c}),O=j?T?gc:fc:T?mc:pc;w[L]>k[L]&&(O=rh(O));var I=rh(O),z=[];if(r&&z.push(D[A]<=0),a&&z.push(D[O]<=0,D[I]<=0),z.every((function(e){return e}))){C=S,_=!1;break}x.set(S,z)}if(_)for(var P=function(e){var t=b.find((function(t){var i=x.get(t);if(i)return i.slice(0,e).every((function(e){return e}))}));if(t)return C=t,"break"},M=m?3:1;M>0&&"break"!==P(M);M--);t.placement!==C&&(t.modifiersData[n]._skip=!0,t.placement=C,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function bh(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function wh(e){return[pc,gc,mc,fc].some((function(t){return e[t]>=0}))}var kh={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,n=e.name,s=i.offset,r=void 0===s?[0,0]:s,o=Sc.reduce((function(e,i){return e[i]=function(e,t,i){var n=zc(e),s=[fc,pc].indexOf(n)>=0?-1:1,r="function"==typeof i?i(Object.assign({},t,{placement:e})):i,o=r[0],a=r[1];return o=o||0,a=(a||0)*s,[fc,gc].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}(i,t.rects,r),e}),{}),a=o[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=o}},xh={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,n=e.name,s=i.mainAxis,r=void 0===s||s,o=i.altAxis,a=void 0!==o&&o,l=i.boundary,c=i.rootBoundary,h=i.altBoundary,d=i.padding,u=i.tether,p=void 0===u||u,m=i.tetherOffset,g=void 0===m?0:m,f=fh(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),v=zc(t.placement),y=Jc(t.placement),b=!y,w=Yc(v),k="x"===w?"y":"x",x=t.modifiersData.popperOffsets,_=t.rects.reference,C=t.rects.popper,E="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,S="number"==typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(x){if(r){var j,L="y"===w?pc:fc,D="y"===w?mc:gc,O="y"===w?"height":"width",I=x[w],z=I+f[L],P=I-f[D],M=p?-C[O]/2:0,R=y===bc?_[O]:C[O],$=y===bc?-C[O]:-_[O],B=t.elements.arrow,N=p&&B?Bc(B):{width:0,height:0},F=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},q=F[L],H=F[D],U=Xc(0,_[O],N[O]),V=b?_[O]/2-M-U-q-S.mainAxis:R-U-q-S.mainAxis,W=b?-_[O]/2+M+U+H+S.mainAxis:$+U+H+S.mainAxis,Y=t.elements.arrow&&Wc(t.elements.arrow),X=Y?"y"===w?Y.clientTop||0:Y.clientLeft||0:0,Z=null!=(j=null==A?void 0:A[w])?j:0,K=I+W-Z,G=Xc(p?Mc(z,I+V-Z-X):z,I,p?Pc(P,K):P);x[w]=G,T[w]=G-I}if(a){var J,Q="x"===w?pc:fc,ee="x"===w?mc:gc,te=x[k],ie="y"===k?"height":"width",ne=te+f[Q],se=te-f[ee],re=-1!==[pc,fc].indexOf(v),oe=null!=(J=null==A?void 0:A[k])?J:0,ae=re?ne:te-_[ie]-C[ie]-oe+S.altAxis,le=re?te+_[ie]+C[ie]-oe-S.altAxis:se,ce=p&&re?function(e,t,i){var n=Xc(e,t,i);return n>i?i:n}(ae,te,le):Xc(p?ae:ne,te,p?le:se);x[k]=ce,T[k]=ce-te}t.modifiersData[n]=T}},requiresIfExists:["offset"]};function _h(e,t,i){void 0===i&&(i=!1);var n,s,r=Dc(t),o=Dc(t)&&function(e){var t=e.getBoundingClientRect(),i=Rc(t.width)/e.offsetWidth||1,n=Rc(t.height)/e.offsetHeight||1;return 1!==i||1!==n}(t),a=Hc(t),l=$c(e,o),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(r||!r&&!i)&&(("body"!==Tc(t)||hh(a))&&(c=(n=t)!==jc(n)&&Dc(n)?{scrollLeft:(s=n).scrollLeft,scrollTop:s.scrollTop}:lh(n)),Dc(t)?((h=$c(t,!0)).x+=t.clientLeft,h.y+=t.clientTop):a&&(h.x=ch(a))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function Ch(e){var t=new Map,i=new Set,n=[];function s(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!i.has(e)){var n=t.get(e);n&&s(n)}})),n.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){i.has(e.name)||s(e)})),n}var Eh={placement:"bottom",modifiers:[],strategy:"absolute"};function Sh(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Ah(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,n=void 0===i?[]:i,s=t.defaultOptions,r=void 0===s?Eh:s;return function(e,t,i){void 0===i&&(i=r);var s,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Eh,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,h={state:a,setOptions:function(i){var s="function"==typeof i?i(a.options):i;d(),a.options=Object.assign({},r,a.options,s),a.scrollParents={reference:Lc(e)?uh(e):e.contextElement?uh(e.contextElement):[],popper:uh(t)};var o,c,u=function(e){var t=Ch(e);return Ac.reduce((function(e,i){return e.concat(t.filter((function(e){return e.phase===i})))}),[])}((o=[].concat(n,a.options.modifiers),c=o.reduce((function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e}),{}),Object.keys(c).map((function(e){return c[e]}))));return a.orderedModifiers=u.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,i=e.options,n=void 0===i?{}:i,s=e.effect;if("function"==typeof s){var r=s({state:a,name:t,instance:h,options:n});l.push(r||function(){})}})),h.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,i=e.popper;if(Sh(t,i)){a.rects={reference:_h(t,Wc(i),"fixed"===a.options.strategy),popper:Bc(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var s=a.orderedModifiers[n],r=s.fn,o=s.options,l=void 0===o?{}:o,d=s.name;"function"==typeof r&&(a=r({state:a,options:l,name:d,instance:h})||a)}else a.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(e){h.forceUpdate(),e(a)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(s())}))}))),o}),destroy:function(){d(),c=!0}};if(!Sh(e,t))return h;function d(){l.forEach((function(e){return e()})),l=[]}return h.setOptions(i).then((function(e){!c&&i.onFirstUpdate&&i.onFirstUpdate(e)})),h}}var Th=Ah({defaultModifiers:[nh,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=gh({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},th,Ic,kh,yh,xh,Gc,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,n=t.rects.reference,s=t.rects.popper,r=t.modifiersData.preventOverflow,o=fh(t,{elementContext:"reference"}),a=fh(t,{altBoundary:!0}),l=bh(o,n),c=bh(a,s,r),h=wh(l),d=wh(c);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}}]});const jh={hideOnClickOutside:!0,hideOnEmojiSelect:!0,hideOnEscape:!0,position:"auto",showCloseButton:!0};class Lh{constructor(e,t){this.isOpen=!1,this.externalEvents=new uc,this.options=Object.assign(Object.assign({},function(e={}){return Object.assign(Object.assign(Object.assign({},jh),{rootElement:document.body}),e)}(t)),va(e)),this.popupEl=document.createElement("div"),this.popupEl.classList.add("popupPicker_popupContainer__-DboI"),this.popupEl.classList.add(this.options.theme),t.className&&this.popupEl.classList.add(t.className),this.options.showCloseButton&&(this.closeButton=document.createElement("button"),this.closeButton.classList.add("popupPicker_closeButton__j1nuQ"),this.closeButton.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">\x3c!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --\x3e<path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>',this.popupEl.appendChild(this.closeButton));const i=document.createElement("div");this.popupEl.appendChild(i),this.picker=ba(Object.assign(Object.assign({},this.options),{rootElement:i})),this.focusTrap=new Oo,this.picker.addEventListener("data:ready",(()=>{this.focusTrap.activate(this.picker.el),this.picker.setInitialFocus()})),this.options.hideOnEmojiSelect&&this.picker.addEventListener("emoji:select",(()=>{this.close()})),this.options.hideOnClickOutside&&(this.onDocumentClick=this.onDocumentClick.bind(this),document.addEventListener("click",this.onDocumentClick)),this.options.hideOnEscape&&(this.handleKeydown=this.handleKeydown.bind(this),this.popupEl.addEventListener("keydown",this.handleKeydown))}addEventListener(e,t){this.externalEvents.on(e,t),this.picker.addEventListener(e,t)}removeEventListener(e,t){this.externalEvents.off(e,t),this.picker.removeEventListener(e,t)}handleKeydown(e){"Escape"===e.key&&this.close()}destroy(){return dc(this,void 0,void 0,(function*(){this.isOpen&&(yield this.close()),document.removeEventListener("click",this.onDocumentClick),this.picker.destroy(),this.externalEvents.removeAll()}))}toggle(){return this.isOpen?this.close():this.open()}open(){return dc(this,void 0,void 0,(function*(){this.isOpen||(yield this.initiateOpenStateChange(!0),this.options.rootElement.appendChild(this.popupEl),this.setPosition(),this.picker.reset(),yield this.animatePopup(!0),yield this.animateCloseButton(!0),this.picker.setInitialFocus(),this.externalEvents.emit("picker:open"))}))}close(){var e,t;return dc(this,void 0,void 0,(function*(){this.isOpen&&(yield this.initiateOpenStateChange(!1),yield this.animateCloseButton(!1),yield this.animatePopup(!1),this.popupEl.remove(),this.picker.reset(),null===(e=this.positionCleanup)||void 0===e||e.call(this),this.focusTrap.deactivate(),null===(t=this.options.triggerElement)||void 0===t||t.focus(),this.externalEvents.emit("picker:close"))}))}getRunningAnimations(){return this.picker.el.getAnimations().filter((e=>"running"===e.playState))}setPosition(){var e;null===(e=this.positionCleanup)||void 0===e||e.call(this),this.positionCleanup=function(e,t,i){if(!i)throw new Error("Must provide a positioning option");return"string"==typeof i?function(e,t,i){if(!t)throw new Error("Reference element is required for relative positioning");const n=Th(t,e,{placement:i,modifiers:[{name:"offset",options:{offset:[0,5]}}]});return()=>n.destroy()}(e,t,i):function(e,t){return e.style.position="fixed",Object.entries(t).forEach((([t,i])=>{e.style[t]=i})),()=>{}}(e,i)}(this.popupEl,this.options.referenceElement,this.options.position)}awaitPendingAnimations(){return Promise.all(this.getRunningAnimations().map((e=>e.finished)))}onDocumentClick(e){var t;const i=e.target,n=null===(t=this.options.triggerElement)||void 0===t?void 0:t.contains(i);!this.isOpen||this.picker.isPickerClick(e)||n||this.close()}animatePopup(e){return Ar(this.picker.el,{opacity:[0,1],transform:["scale(0.9)","scale(1)"]},{duration:150,id:e?"show-picker":"hide-picker",easing:"ease-in-out",direction:e?"normal":"reverse",fill:"both"},this.options)}animateCloseButton(e){if(this.closeButton)return Ar(this.closeButton,{opacity:[0,1]},{duration:25,id:e?"show-close":"hide-close",easing:"ease-in-out",direction:e?"normal":"reverse",fill:"both"},this.options)}initiateOpenStateChange(e){return dc(this,void 0,void 0,(function*(){this.isOpen=e,yield this.awaitPendingAnimations()}))}}const Dh='[role="icon"]';class Oh{#de;constructor(e){this.#de=e}set title(e){this.#de.querySelector(".title").innerText=e}set desc(e){this.#de.querySelector(".ns").innerText=e}set icon(e){const t=this.#de.querySelector(Dh),i=t.className.split(" ").slice(0,-1);i.push(e),t.className=i.join(" ")}set avatar(e){this.#de.querySelector(".avatar").src=e}set region(e){const t=this.#de.querySelector(".flag-icon");t.className="flag-icon",e&&t.classList.add(`flag-icon-${e}`)}set mode(e){this.#de.setAttribute("mode",e)}get icon(){const e=this.#de.querySelector(Dh);return new class{#ue;constructor(e){this.#ue=e}set name(e){this.#ue.setAttribute("name",e)}set id(e){this.#ue.setAttribute("value",String.fromCodePoint(parseInt(e||"f111",16)))}set color(e){this.#ue.style.color=e||"inherit"}set region(e){this.#ue.querySelector(".flag-icon").className=`flag-icon flag-icon-${e}`}}(e)}set admin(e){const t=this.#de.querySelector('button[name="admin"]');t&&(e?dom.showElement(t):dom.hideElement(t))}get toolbar(){return this.#de.querySelector(".toolbar")}get right(){return this.#de.querySelector(".right")}set onclick(e){this.#de.onclick=e}get headline(){return this.#de.querySelector(".headline")}button(e){return this.#de.querySelector(`button[name="${e}"]`)}role(e){return this.#de.querySelector(`[role="${e}"]`)}q(e){return this.#de.querySelector(e)}}class Ih{constructor(e){this.target=e}get contentEditable(){return!!this.target.contentEditable}getPos(){if(this.contentEditable){this.target.focus();let e=document.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this.target),t.setEnd(e.endContainer,e.endOffset),t.toString().length}return this.target.selectionStart}setPos(e){if(this.contentEditable){this.target.focus();try{document.getSelection().collapse(this.target,e)}catch(e){}}else this.target.setSelectionRange(e,e)}}class zh{#e;#P;#pe;#me;#ge;constructor(e){this.#P=e.querySelector("progress"),this.#pe=e.querySelector('[role="speed"]'),this.#me=parseInt(e.dataset.size),this.#ge=Date.seconds(),this.#e=e,e.setAttribute("state","downloading")}progress(e){if(1==e){const e=this.#e.dataset.id;return void this.done(e)}this.#P.value=Math.floor(100*e);const t=Math.floor(this.#me*e),i=Date.seconds()-this.#ge;this.#pe.innerText=`${fileX.formatSize(t/i)}/s`}done(e){console.debug("On torrent done:",e),this.#P.value=100,this.#e.setAttribute("state","done")}}cc.string({name:"status",title:"Status"});cc.name;class Ph extends UX.Page{get area(){return this.container}constructor(e,t){const i=t?dom.renderTemplate(t):dom.createElement("div","container-col","settings","fade","hidden");e.appendChild(i),super(i)}}Object.assign(Ph.prototype,UX.ListMixin);class Mh extends Ph{}class Rh extends Ph{#fe;constructor(e){super(e,"editor-add-code")}async load(){const e=this.querySelector('textarea[name="code"]');this.#fe=await pr.bind(e,"js",!0)}set value(e){this.#fe.setValue(e||"")}get value(){return this.#fe.getValue()}async onAction(e,t,i){}}class $h extends Ph{#ve;constructor(e,t="scraper"){super(e,"editor-add-test");const i=this.querySelector(".results");this.#ve=UX.List.createMixin(i)}async onAction(e,t,i){if(this.#ve.clear(),t.domain)if(console.debug("Sending SCRAPER test request for domain:",t.domain,t.location||"/"),t.code){console.debug(t.code);try{let e="channel-feed",i=await ajax.post("/api/scrap/test",t);if(Array.isArray(i)||"object"==typeof i&&(i=i.data),console.debug("GOT result:",i.length),Array.isArray(i))for(const t of i)this.#ve.addItemTemplate(e,t);else"string"==typeof i&&(result.innerHTML=dom.markdown(i))}catch(e){console.error("Test request failed:",e)}}else console.error("Test request without code!");else console.error("Test request without domain!")}}class Bh extends UX.ListPage{static Fields=cc;static kOptions={};static register(e,t,i){i&&(t.onAdd=i),Bh.kOptions[e]=t}static kPreview={};static preview(e,t){Bh.kPreview[e]=t}#R;#ye;#be={};#we;#ke;#xe;#_e;#Ce;get id(){return"add"}get storageId(){return this.id+"-"+this.type}get dragOptions(){return{directory:!1,hover:!1,files:["image"]}}get excludeFromStack(){return!0}constructor(e="add-editor"){super(e),this.pages=new Map;let t=this.headerElement.querySelector('button[name="submit"]');const i=this.editorElement;this.#ye=i.querySelector(".tabbar");const n=new Mh(this.area);this.addPage("main",n);const s=new ac(n);s.onvalidchange=e=>t.disabled=!e,this.#R=s}get inputSelector(){return"input:not([type=radio]),select,textarea,input[type=radio]:checked"}onFileDrop(e){this.#R.onFileDrop(e)}onAction(e){switch(e){case"submit":this.onAddClicked(this.#R.getData());break;case"cancel":app.cancelEditor()}}onEditorAction(e,t,i){switch(this.current){case"code":{const t=this.#R.getData();this.#we.onAction(e,t,i)}break;case"test":{const t=this.#R.getData();t.code=this.#we?this.#we.value:"",this.#xe.onAction(e,t,i)}}}open(e,t,i){if(!i.reload&&this.type==t)return;if(!i.items){const e=Bh.kOptions[t];Array.isArray(e)?i.items=e:Object.assign(i,e)}console.log("ADD editor open",e,t),this.type=t;const{icon:n,desc:s,items:r,onAdd:o,info:a,onPreview:l}=i;let c=`${e.capitalizeFirstLetter()} ${t.toLowerCase()}`;"edit"==e&&(c+=` '${a.name}'`);const h=new Oh(this.headerElement);h.icon=n,h.title=c,h.desc=s||"no description";let d=a;if(!a){const e=this.storageId;d=localStorage.getItem(e)||void 0,d&&(d=JSON.parse(d))}this.#R.load(r,d),this.#_e=r.onAdd||o,this.#Ce=l||function(){};const u=r.filter((e=>"edit"==e.type)),p=r.filter((e=>["test","preview"].includes(e.type)));if(0==u.length)dom.hideElement(this.#ye);else{dom.showElement(this.#ye),this.#be={};let e=this.#ye.firstElementChild.nextElementSibling;for(;e;){const t=e;e=e.nextElementSibling,dom.removeElement(t)}for(const e of u)this.#Ee(e.name),this.#be[e.name]=a?a[e.name]||"":e.val||"";for(const e of p)this.#Ee(e.name)}this.#ye.firstElementChild.classList.add("active"),this.switchTo("main")}async onTabChange(e,t){if(console.debug("On TAB change",e),!["main","preview","test"].includes(t)){const e=this.#we?this.#we.value:"// add code here\n";this.#be[t]=e}let i=!1;if("preview"==e){if(i=!0,!this.#ke){const e=new(0,Bh.kPreview[this.type])(this.area);e.updateSize(this.height),this.addPage("preview",e),this.#ke=e}const e=Object.values(this.#be)[0];this.#ke.loadFromCode(e)}else if("main"!=e)if("test"==e){if(!this.#xe){const e=new $h(this.area);this.addPage("test",e),this.#xe=e}}else{if(i=!0,!this.#we){const e=new Rh(this.area);this.#we=e,await e.load(),this.addPage("code",e)}this.#we.current=e,this.#we.value=this.#be[e],e="code"}i?this.area.classList.add("max-height"):this.area.classList.remove("max-height"),this.switchTo(e)}onAddClicked(e){console.log("ADD CLICK",e),e.name&&(e.name=e.name.trim().replace(/\s+/g," "));const t=this.storageId;localStorage.setItem(t,JSON.stringify(e)),this.#_e&&("main"!=this.current&&(this.#be[this.#we.current]=this.#we.value),Object.assign(e,this.#be),console.debug("ON Add:",e),this.#_e(e))}#Ee(e){const t=dom.createElement("span","tab");t.innerText=e,t.setAttribute("tab",e),this.#ye.appendChild(t)}}Object.assign(Bh.prototype,UX.PageControllerMixin),window.AddEditor=Bh;class Nh extends UX.ListPage{static id="find";static kAttributes={};static register(e,t){this.kAttributes[e]=t}#Se;#Ae;#Te="";#je;#Le=new Set;get excludeFromStack(){return!0}constructor(e){e||((e=dom.renderTemplate("editor-base",{},"div",["editor-header-grid","editor-find-toolbar"],"editor-find-base")).id="find-editor",dom.hideElement(e)),super(e),this.area.classList.add("cc","m2","results","list"),this.#je=this.editorElement.querySelector('button[name="search"]')}set search(e){this.#je.disabled=e}onAction(e,t,i){this.#De(e,i)}onEditorAction(e,t,i){if("search"===e)i.disabled=!0,this.#Oe();else{const i=t.dataset.id,n=this.#Ae.get(i);this.#Se.onaction&&this.#Se.onaction(e,n),t.classList.add("local")}}onClick(e,t){const i=t.dataset;if(console.log("Find editor click",e),"select"==this.#Se.type)return void(i.selected="false"==i.selected);const n=this.#Se.onclick;n&&n(t.dataset)}onInput(e,t){e.target;const i=e.value,n=i.length>=3;e.nextElementSibling.disabled=!n,1!=i.length&&this.filter(i),this.#Te=n?i:""}onKeyPress(e,t){"Enter"==t&&this.#Te.length>0&&this.#Oe()}open(e,t={ds:e,mode:"ls"}){if(console.log("Opening FIND:",e),this.action==e&&!t.force&&this.#Se&&t.mode==this.#Se.mode&&t.type==this.#Se.type)return;t.ds||(t.ds=e),t.mode||(t.mode="ls"),this.action=e;const i=new Oh(this.headerElement);i.title=t.title||`Find ${e}`,i.desc=t.desc||`Search database for ${e}`,i.icon.name=e;const n=t.type||"find";this.#Ie(n,i,!!t.add);const s=i.button("new");t.add?dom.showElement(s):dom.hideElement(s),this.clear(),this.#F(t)}async#F(e){const{local:t,remote:i,ds:n,cmd:s}=e;if(!e.result&&n&&(e.result=`find-${n}-item`),s?(this.area.setAttribute("group",n||t),this.area.setAttribute("cmd",s)):(this.area.removeAttribute("group"),this.area.removeAttribute("cmd")),this.#Ae=null,this.#Se=e,n)return this.#ze(e);if(this.search=!i,!t)return;const r=await app.db.ls(t);if(0==r.length)return;Fh(r,this.#Le);const o=new Map;for(const e of r)o.set(e.id,e),this.#Pe(e);this.#Ae=o}async#ze({ds:e,result:t,results:i,mode:n,type:s}){if(this.search=!1,"string"==typeof e&&(e=app.ds(e)),"ls"===n){const n=await e.ls();let s,r;Fh(n,this.#Le);for(const o of n)r=o.ds||e.name,s=i&&i[r]||t,this.#Pe(o,s);this.#Ae=new Map(n.map((e=>[e.id.toString(),e])))}}async#Oe(){const e=this.#Te;console.log("Do search:",e);let t,{remote:i,index:n,local:s,table:r,ds:o}=this.#Se;if(this.toggleLoading(),o){"string"==typeof o&&(o=app.ds(o));const e=Nh.kAttributes[o.name]||[];t=await delayResolve(o.search(this.#Te,e,n)),s&&(s=o)}else t=await delayResolve(r?this.#Me(r,null,this.#Te):this.#Re(i,n||"name",e.toLowerCase()));if(t){this.#Ae||(this.#Ae=new Map);const e=this.#Ae,i=[];let n;for(const s of t)if(n=s.id.toString(),e.has(n)){const e=this.getItem(n);e&&dom.showElement(e)}else s.user&&(s.user=await app.loadContact(s.user)),s.remote=!0,i.push(s),e.set(n,s),this.#Pe(s,null,!0);if(s&&i.length>0){console.log("# Adding remote results",i);try{"string"==typeof s?await app.db.add(s,i,"add"):await s.put(i)}catch(e){console.error("Failed to add results into local db",e)}}}this.toggleLoading()}async#Re(e,t,i){const n=i?await app.firebase.search(e,t,i):await app.firebase.ls(e);return n?Object.toArray(n):[]}async#Me(e,t,i){let n;try{let t=`/api/search/${e}`;i&&(t+="?"+new URLSearchParams({what:i}).toString()),n=await ajax.get(t)}catch(e){console.error("Failed to query database")}return n}#Pe(e,t,i=!1){const{result:n,type:s,isselected:r,purge:o}=this.#Se;e.id,t=t||n;const a=this.addItemTemplate(t,e,i);if(a.dataset.name=e.display||e.name,e.remote||a.classList.add("local"),"select"==s){const t=dom.createElement("i","fa","check","fa-circle","stroke","w3-text-blue");a.dataset.selected=!!r&&r(e),a.removeAttribute("cmd"),a.appendChild(t)}else if("cmd"==s);else if("rm"==s){const e=dom.createElement("button","icon","fa","display-hover");e.name="remove",e.title="Remove";const t=this.#Se.ds,i=o?"purge":"rm";e.setAttribute("cmd",i+"-"+t),a.appendChild(e)}else{const t=dom.createElement("button","icon","fa","display-hover");t.name="add",t.title="Add",a.appendChild(t),e.remote||a.classList.add("local")}}#Ie(e,t,i=!1){const n=t.button("new");dom.showElement(n,i);const s=t.button("submit");dom.showElement(s,"select"==e)}#De(e,t){switch(e){case"new":case"add":return void app.executeCommand("add","new",this.action);case"submit":if(this.#Se.ondone){const e=Array.from(this.getItems("selected","true")).map((e=>e.dataset.id)),t=e.map((e=>this.#Ae.get(e)));this.#Se.ondone(t);for(const t of e)this.#Le.add(t)}break;case"select":return}app.cancelEditor()}}function Fh(e,t){e.sort(((e,i)=>t.has(e.id)?-1:t.has(i)?1:0))}window.FindEditor=Nh;class qh extends UX.ListPageController{#$e;#Be=!1;get active(){return this.#$e}get header(){const e=this.headerElement;return new Oh(e)}get opened(){return this.#Be}show(){this.#Be=!0,super.show()}hide(){this.#Be=!1,super.hide()}switchTo(e){this.#$e=super.switchTo(e)}onInput(...e){this.#$e&&this.#$e.onInput(...e)}onFilter(...e){this.#$e&&this.#$e.onFilter(...e)}onKeyPress(...e){this.#$e&&this.#$e.onKeyPress(...e)}onClick(...e){this.#$e&&this.#$e.onClick(...e)}onElementClick(e,...t){if(this.#$e)switch(e.tagName){case"A":case"BUTTON":return this.#$e.onAction(e.getAttribute("name"),null,e)}}onEditorAction(...e){this.#$e&&this.#$e.onAction(...e)}onAction(){}onFileDrop(){}onScrollY(){}onResize(){}}class Hh extends UX.List{#i;#Ne;#Fe;#qe;#He;#Ue=!1;pages=new Map;get collapsed(){return this.#Ue}constructor(e,t,i=[]){let n;e?n=e.nextElementSibling:(n=dom.createElement("div","v-sash","reverse"),e=dom.renderTemplate("editor-sidebar",i),parent.appendChild(e),parent.appendChild(n)),super(e.querySelector(".scrollable")),this.container=e,this.#Fe=n,this.#qe=e.querySelector(".tabbar"),this.#He=e.querySelector(".navbar");let s=250,r=!1;if(t){e.id=t;const i=app.ui[t];i&&(r=!!i.collapsed,s=i.width||s)}e.style.width=`${s}px`,r&&this.toggle()}onAction(e,t,i){switch(e){case"collapse":case"expand":this.toggle();break;default:this.handleAction(e,t,i)}}onElementClick(){}handleAction(){}toggle(){const e=this.container.classList.toggle("collapsed");let t;e?(this.#Fe&&dom.hideElement(this.#Fe),this.#i=this.container.style.width,this.container.style.width=null,t=!1):(this.#Fe&&dom.showElement(this.#Fe),this.container.style.width=this.#i,t=!0),this.#Ue=!t;const i=this.container.closest(".sidebar").id;return i&&app.updateSetting(i,{collapsed:e}),t}show(){this.#Ue=!1,dom.showElement(this.container),this.container.style.width=this.#i,this.#Fe&&dom.showElement(this.#Fe)}hide(){this.#Ue=!0,dom.hideElement(this.container),this.#Fe&&dom.hideElement(this.#Fe)}load(e,t=e){}loadTabs(e=0){const t=this.tabs;console.log("Editor sidebar tabs:",t);for(const e of t)this.#Ve(new Uh(e,!0));this.switchTo(t[e])}onTabChange(e,t){this.switchTo(e)}add(e,t=!1){const i=e.renderTab();this.#qe.insertBefore(i,this.#qe.lastElementChild),this.#Ve(e),t&&(i.classList.add("active"),this.switchTo(e.name))}onClick(){}#Ve(e){this.area.appendChild(e.container),this.addPage(e.id,e)}#We(e){this.#qe.querySelector(".active").classList.remove("active"),e.classList.add("active");const t=e.dataset.tab;this.switchTo(t)}updateTimes(){this.getCurrentPage().updateTimes()}}Object.assign(Hh.prototype,UX.PageControllerMixin);class Uh extends UX.Page{#Ye;constructor(e,t=!1){const i=dom.createElement("div","column","fit","hidden");t&&i.classList.add("show-empty"),super(i),this.reverse&&i.classList.add("reverse"),this.#Ye=e}get id(){return this.#Ye}get area(){return this.container}get name(){return this.#Ye}renderTab(){const e=dom.createElement("span","tab","text-center","fit");if(this.icon){const t=dom.createElement("i","fa",...this.icon.split(" "));e.classList.add("icon"),e.appendChild(t)}return e}updateTimes(){const e=Date.now(),t=this.container.querySelectorAll("time[data-time]");for(const i of t){const t=1e3*Number(i.dataset.time),n=new Date(t);i.innerText=n.offsetFrom(e)}}createList(){return UX.List.createMixin(this.container)}}Object.assign(Uh.prototype,UX.ListMixin);class Vh extends UX.PageController{static Page=qh;static Sidebar=Hh;static#Q={};static register(e,t=e.id){Vh.#Q[t]=e}#Xe=0;#e;#Ze=[];#Ke;#Ge;#Je;#O;#Qe;get currentEditor(){return this.#O}get loadingElement(){return document.getElementById("editor-loading")}get showHover(){return this.#O.dragOptions&&this.#O.dragOptions.hover}get container(){return this.#e}get dragOptions(){return this.#O.dragOptions}constructor(e="editor"){super();const t=document.getElementById(e);this.#e=t,t.onclick=e=>this.#et(e.target,{x:e.clientX,y:e.clientY}),t.oninput=e=>this.onInput(e.target,e.data),t.onkeyup=e=>{const t=e.target;if("Enter"==e.key&&!e.shiftKey){e.preventDefault();const i=t.closest(".search-area");let n=!0;return i&&(n=!Yh(i)),void(n&&this.onKeyPress(t,e.key))}},t.onkeydown=e=>{"Enter"!=e.key||e.shiftKey||e.preventDefault()},t.onpaste=e=>{const t=e.clipboardData.getData("text/plain");console.debug("Editor ON PASTE",t)},t.onchange=e=>this.onChange(e.target,e.target.value),this.#tt()}toggleLoading(){return this.#e.classList.toggle("loading2")}registerMouseEvents(){document.onmousedown=e=>{const t=e.target;if(t.classList.contains("v-sash")){const i=t.previousElementSibling,n=t.classList.contains("reverse"),s=e.clientX,r=i.offsetWidth;document.body.style.cursor="e-resize";const o=e=>{const t=s-e.clientX,o=n?r+t:r-t;i.style.width=`${o}px`},a=e=>{document.documentElement.removeEventListener("mousemove",o,!1),document.documentElement.removeEventListener("mouseup",a,!1),document.body.style.cursor="default";const t=i.id;if(t){const e=parseInt(i.style.width);this.updateWidth(t,e)}};document.documentElement.addEventListener("mousemove",o,!1),document.documentElement.addEventListener("mouseup",a,!1)}}}onAction(e,t,i){const n=this.currentEditor,s=[];switch(e){case"send":{const e=i.closest(".input-area");if(e){i.disabled=!0;const t=e.firstElementChild;let n;t.hasAttribute("contenteditable")?(n=t.innerText,t.innerText=""):(n=t.value,t.value=""),n=n.trim(),i.inputValue=n,s.push(n)}}break;case"play":{const e="pause"==i.value?"play":"pause";i.value=e,i.title=e.capitalizeFirstLetter()}break;case"remove":case"delete":dom.removeElement(t);break;case"update":s.push(n.getData())}const r=i.getAttribute("link");if(r){const[,...e]=r.split("/");return void app.openEditor(...e)}let o=i.getAttribute("cmd");if(/^cmd-/.test(e)&&(o=e.substr(4)),o&&this.#it(o,t,i,...s))return;if(!n)return;const a=n.headerElement;if(a&&a.contains(i))return void n.onAction(e,t,i);const l=n.sidebar;if(l&&l.container.contains(i))return void l.onAction(e,t,i);if(n.hasComments&&i.closest("[comments]"))return void app.comments.onAction(i);let c=t;switch(e){case"call":return void app.openEditor("video","call",t.dataset.id,{audio:!0,video:!1});case"emoji":{const e=function(e){return"INPUT"==e.tagName?e:new class{#nt;constructor(e){this.#nt=e}get element(){return this.#nt}get parent(){return this.#nt.parentElement}get value(){return this.#nt.innerText}set value(e){this.#nt.innerText=e}set oninput(e){return this.#nt.oninput=e}set onkeydown(e){this.#nt.onkeydown=e}focus(){this.#nt.focus()}}(e)}(i.parentElement.firstElementChild);!function(e,t,i="auto"){const n=new Lh({},{triggerElement:e,referenceElement:e,position:i,hideOnClickOutside:!1});n.addEventListener("picker:close",(()=>{const e=t.tagName&&["INPUT","TEXTAREA"].includes(t.tagName)?t:t.element,i=new Ih(e),n=i.getPos();i.setPos(n+1),e.focus(),delete document._popup})),n.addEventListener("picker:open",(()=>{document._popup=n})),n.addEventListener("emoji:select",(e=>{console.log("Emoji selected:",e.emoji),t.value+=e.emoji+" ",t.parent.lastElementChild.disabled=!1})),e.blur(),n.open()}(i,e,"top-end")}return;case"share":if(t.dataset.type)return void app.share(t.dataset.type,t.dataset.id);break;case"cancel":case"submit":"edit"==t.getAttribute("mode")&&(t.removeAttribute("mode"),c=t.querySelector('[role="edit"]'),dom.removeElement(c));break;case"discard":this.cancel()}n.onEditorAction(e,t,i)}onClick(e,t){let i=this.currentEditor;if(!i)return;const n=i.sidebar;if(n&&n.container.contains(e))i=n;else{if(e.hasAttribute("contenteditable")||["INPUT","SELECT"].includes(e.tagName))return;if(i.hasComments){const t=e.closest("[comments]");if(t)return void app.comments.onClick(e,t)}}if(e.hasAttribute("expandable")){const t=e.closest("[data-id]");t&&(e=t)}let s,r,o;if(e.classList.contains("item")){e.removeAttribute("new"),e.classList.remove("new");const t=e.querySelector("[collapsable]");t&&t.classList.toggle("hidden"),e.hasAttribute("selected")?(o=!1,e.removeAttribute("selected")):(o=!0,e.setAttribute("selected","")),s=e.dataset.id;const n=e.closest("[group]");r=n?n.getAttribute("group"):null;let a=e.getAttribute("cmd");!a&&n&&(a=n.getAttribute("cmd")),a&&this.#it(a,e),i.onClick(s,e,o,r)}else{const n=e.getAttribute("tab");if(n){if(!e.classList.contains("active")){const t=e.parentElement;let s=t.querySelector(".tab.active");s.classList.remove("active"),e.classList.add("active");const r=s.getAttribute("tab"),o=t.nextElementSibling;if("tab-area"==o.getAttribute("role")){let e;e=o.querySelector(`[page="${r}"]`),dom.hideElement(e),e=o.querySelector(`[page="${n}"]`),dom.showElement(e)}else i.onTabChange(n,r)}return}let s=e.getAttribute("cmd");if(s){const t=e.closest(".item");this.#it(s,t,e)}i.onElementClick(e,t)}}onInput(e,t){Xh();const i=e.getAttribute("name"),n=this.currentEditor;let s,r=!1;if("INPUT"==e.tagName){const s=e.value.trim();if(t){if(s.isExpression())return e.setAttribute("exp",!0),e.setAttribute("_ph",e.placeholder),e.placeholder="expression",e.spellcheck=!1,e.value="",void(r=!0);r=e.hasAttribute("exp")}else""==s&&e.hasAttribute("exp")&&(e.placeholder=e.getAttribute("_ph"),e.removeAttribute("_ph"),e.removeAttribute("exp"));if("search"==i){const t=e.parentElement.lastElementChild,i=s.length>2;return t.disabled=!i,t.previousElementSibling.disabled=0==s.length,void(n&&n.onFilter(s,e))}}if(n)if("comment"!=i){if(!r){if(s=e.getAttribute("ds"),s){const t=app.ds(s);t&&(this.#Qe=e,async function(e,t){e._items||(e._items=await t.ls()),Zh(e,e._items)}(e,t))}s=e.getAttribute("_ac"),s&&(this.#Qe=e,async function(e,t,i){const n=await t.loadAutocomplete(i);n?Zh(e,n):t.onInput(e)}(e,n,s)),e.hasAttribute("contenteditable")&&(e.value=e.innerText)}n.onInput(e,t,r)}else{const t=e.innerText;e.parentElement.lastElementChild.disabled=!/.{2,2000}/.test(t.trim())}}onKeyPress(e,t){const i=this.currentEditor;if(i){if(i.hasComments&&e.closest("[comments]"))return void app.comments.onKeyPress(e,t);if("Enter"==t){let t=e.tagName.toLowerCase(),i=e.value;if(e.hasAttribute("contenteditable")?(i=e.innerText,t="input",e.innerText=""):e.value="",["input"].includes(t)&&(i=i.trim(),e.inputValue=i,"comment"===e.getAttribute("name"))){const t=e.parentElement,n=t.lastElementChild,s=n.getAttribute("cmd");if(s){const e=t.closest("[data-id]");e&&e.removeAttribute("selected"),this.#it(s,e,n,i)}}}i.onKeyPress(e,t)}}onChange(e,t){if("SELECT"!=e.tagName)return;Xh();const i=this.currentEditor;i&&i.onChange(e,t)}onElementClick(){}handleCommand(){}scrollTo(e){this.#Ge&&this.#Ge.scrollTo(e)}scrollBottom(){this.#Ge&&this.#Ge.scrollBottom()}switchTo(e){let t=this.currentEditor;if(t){if(this.current==e)return t;const i=this.loadingElement;t.hide(),dom.showElement(i),t=this.getPage(e),setTimeout((()=>{dom.hideElement(i),super.switchTo(e)}),800)}else t=super.switchTo(e);return t&&this.#st(t),t}addToStack(){const e=this.current;e&&(this.currentPage.excludeFromStack||0!=this.#Ze.length&&this.#Ze[this.#Ze.length-1]==e||this.#Ze.push(e))}handleEvent(e){switch(e.stopPropagation(),e.preventDefault(),e.type){case"dragenter":return 0==this.#Xe++&&this.showHover&&this.#e.classList.add("hover"),e.target.classList.contains("dropzone")&&(console.debug("DROPZONE element enter"),e.target.classList.add("hover")),!1;case"dragleave":return 0==--this.#Xe&&this.#e.classList.remove("hover","error"),e.target.classList.contains("dropzone")&&(console.debug("DROPZONE element leave"),e.target.classList.remove("hover")),!1;case"drop":this.onDrop(e)}}addPage(e,t,i=!0){const n=super.addPage(e,t);i&&this.#e.appendChild(n.container)}open(e,t,...i){"string"!=typeof e&&(e=e.id),this.addToStack(e),this.#Xe=0;let n=this.switchTo(e);if(!n){const t=Vh.#Q[e];if(!t)throw console.error("Invalid editor:",e),new Error("Invalid editor "+e);let i;t.create&&(i=t.create()),n=new t(i),this.addPage(e,n),this.switchTo(e)}n.open(t,...i)}back(){const e=this.#Ze.pop();console.log("Editor back",e),this.switchTo(e)}cancel(e){if(console.log("STACK: ",this.#Ze),0==this.#Ze.length)return;const t=this.#Ze[this.#Ze.length-1];this.switchTo(t)}notify(e,t="success"){const i=this.currentEditor;if(!i)return;const n=i.editorElement,s=dom.createElement("div","popup","top-right","w3-container","w3-padding","w3-round");s.setAttribute("value",t),s.innerHTML=e,n.appendChild(s),setTimeout((()=>dom.removeElement(s)),3e3)}showNotification(e,t="warning",i=2e3){let n=this.#e.querySelector('[role="popup-area"]');if(!n)return;const s=dom.renderTemplate("popup-item",{msg:e});return n.appendChild(s),"progress"!=t&&setTimeout((()=>dom.removeElement(s)),i),s}async onDrop(e){const t=e.dataTransfer,i=(t.files,[...t.items].filter((e=>"file"===e.kind)).map((e=>e.getAsFileSystemHandle()))),n=[];let s;for await(const e of i)if("directory"===e.kind)console.log(`Directory: ${e.name}`),await Wh(e,n),s=e.name;else{console.log(`File: ${e.name}`);const t=await e.getFile();n.push(t)}if(this.#Xe=0,this.#e.classList.remove("hover"),n.length>0)this.handleImport(n,s);else{const e=t.getData("type"),i=this.currentPage.dragOptions;if(i.items&&!i.items.includes(e))return;let n=t.getData("data");if(n)n=JSON.parse(t.getData("data"));else{const i=t.getData("id");if(!i)return void console.error("No data assigned");const s=app.ds(e);if(!s)return void console.error("DataSource not exists:",e);n=await s.get(i)}this.currentPage.onDrop(n,e)}}async onImport(e){const t=[];let i;for(const n of e)if("directory"===n.kind)console.log(`Directory: ${n.name}`),await Wh(n,t),i=n.name;else{console.log(`File: ${n.name}`);const e=await n.getFile();t.push(e)}this.handleImport(t,i)}async handleImport(e,t){const i=[],n=[],s=[];for(const t of e){const e=fileX.getExtension(t.name);fileX.isImage(e)?i.push(t):fileX.isMedia(e)?n.push(t):s.push(t)}if(n.length>0){const e=this.showNotification(`### Importing ${n.length} files`,"progress");let t;await app.importAudioFiles(n,((i,n,s)=>{switch(n){case"begin":t=dom.renderTemplate("popup-file-item",s),e.appendChild(t);break;case"end":t.setAttribute("state","done");break;case"meta":break;case"done":dom.removeElement(e)}}))}const r=function(e,t){return t?Array.from(e).filter((e=>t.files.includes(e.type?fileX.getType(e.type):fileX.getTypeFromFilename(e.name)))):[]}(e,this.dragOptions);r.length>0&&await this.currentPage.onFileDrop(r,null,t),console.log("EDITOR: emitting files drop event"),e.length>0&&app.emit("filesdropped",e)}#et(e,t){if(this.#Qe){if(e==this.#Qe)return;const t=this.#Qe;if(this.#Qe=null,e.classList.contains("autocomplete-item")){const i=e.querySelector("input"),n=i.value,s=i.dataset.id,r=e.parentElement,o=r.previousElementSibling;o.value=n,o.dataset.id=s,dom.removeElement(r);let a=this.currentEditor;return void(a&&a.onInput(t))}const i=t.nextElementSibling;i&&dom.removeElement(i)}if(!e.hasAttribute("contenteditable")&&!UX.List.handleClick(e))switch(e.tagName){case"A":this.#rt(e,t);break;case"BUTTON":this.#ot(e);break;case"I":if(e.hasAttribute("tooltip")){const t=e.closest("button"),i=e.getAttribute("value");t.value=i;let n=t.closest("[container]")||t.parentElement;if("like"==t.name){t.disabled=!0;const i=e.parentElement;dom.removeElement(i)}this.onAction(t.name,n,t);break}default:this.onClick(e,t)}}#ot(e){let t=e.getAttribute("state");if(t){const i=t;switch(t){case"on":t="off";break;case"off":t="on"}e.setAttribute("state",t);const n=e.title;if(n){let s=n.lastIndexOf(t);-1!=s&&(e.title=n.slice(0,s)+i)}}switch(e.name){case"add":{const t=e.closest("[add]");if(t)return t.classList.add("expanded"),!0}break;case"edit":{const t=e.closest(".edit-area");if(t){const e=t.querySelector("textarea"),i=t.querySelector('button[name="submit"]');t.setAttribute("edit","");const n=MDE.wrap(e);return n.codemirror.on("update",(e=>i.disabled=!1)),void(e.mde=n)}}break;case"cancel":case"submit":if(Vh.handleEditAction(e.name,e)||Vh.handleAddAction(e.name,e))return;break;case"like":{const t=e.querySelector(".reaction");t&&dom.removeElement(t),e.disabled=!0}break;case"search":{const t=e.closest(".search-area");if(t&&Yh(t))return}break;case"clear":{const t=e.closest(".search-area");if(t){!function(e){const t=e.querySelector(".input-area");t.firstElementChild.value="";t.lastElementChild.disabled=!0;let i=e.querySelector(".results");i&&dom.removeElement(i)}(t);let i=this.currentEditor;return void(i&&i.onFilter("",e))}}}let i=e.closest("[data-id]")||e.closest("[container]")||e.parentElement;switch(e.name){case"accept":{const t=e.nextElementSibling;e.disabled=!0,t.disabled=!0}break;case"reject":{const t=e.previousElementSibling;e.disabled=!0,t.disabled=!0}}this.onAction(e.name,i,e)}#rt(e,t){if(e.classList.contains("yt"))return void app.player.playYoutube(e);const i=e.getAttribute("name");if(["next","prev"].includes(i)){const t=e.closest(".slideshow-container");if(t){const e=t.querySelectorAll("img");for(let n=0;n<e.length;++n){const s=e[n];if(!dom.isHidden(s)){"prev"==i?--n<0&&(n=e.length-1):++n,n%=e.length,t.querySelector(".number").innerText=`${n+1} / ${e.length}`,dom.hideElement(s),dom.showElement(e[n]);break}}return}}else if(["more","less"].includes(i)){const t=e.closest(".search-area");if(t){const i=t.querySelector(".results").firstElementChild.querySelectorAll(".item.hidden"),n=Array.from(i).slice(0,10);for(const e of n)dom.showElement(e);return void(n.length<10&&dom.hideElement(e))}}if(!this.currentEditor)return;const n=e.getAttribute("link");if(n&&n.startsWith("#")){const e=n.slice(1),t=(e.startsWith("/")?e.slice(1):e).replaceAll("/","-");app.executeCommand("open-page-wiki",t)}else this.onClick(e,t)}#it(e,t,i,...n){if(this.handleCommand(e,t,i))return!0;const[s,...r]=e.split("-");if(n.unshift(...r),i&&"play"===i.name){const e=i.getAttribute("state"),t="play"==e?"pause":"play";i.setAttribute("state",t),i.title=t.capitalizeFirstLetter(),n.push(e)}switch(s){case"copy":if("code"===n[0]){{const e=i.previousElementSibling;if(e){const t=e.innerText;console.debug("Copied to clipboard:",t),navigator.clipboard.writeText(t),this.notify("Copied to cliboard")}}return}break;case"find":return app.find(...n),!0;case"share":{const e=n.shift();let i;switch(e){case"channel":if(!t&&"channel"==this.#O.type){const e=this.#O.id;return app.share("channel",e),!0}break;case"post":case"article":if("channel"===this.#O.type)i=this.#O.current;else{const e=t.closest("[data-channel]");e&&(i=e.dataset.channel)}}const s=t.dataset.id;let r;i&&(r={channel:i}),app.share(e,s,r)}return!0;case"follow":if(!t&&"channel"==this.#O.type){let e=this.#O.follow;const t=this.#O.id,n=this.#O.type;return e?(console.log("Unsibscribing from channel:",t),e=!1):(console.log("Sibscribing from channel:",t),e=!0),i.value=e,i.title=e?"Unfollow":"Follow",app.executeCommand("follow","channel",n,t),!0}break;case"torrent":{const e=t.dataset.id,i=new zh(t);app.downloadTorrent(e,i)}break;case"load":{const e=t,i=e.dataset.link,n=e.dataset.id;e.removeAttribute("cmd");const s=e.querySelector(".md");s&&async function(e,t,i=!1,n=!1){let s,r="";if(i?s=t:(s=dom.createElement("span","article","md","nomargin","fade"),t&&(n?dom.insertBefore(s,t.lastElementChild):t.appendChild(s))),s.classList.add("loading3"),e.content)r=e.content;else{const i="string"==typeof e?e:e.id,n=app.ds("news");let o;try{o=await n.local.get(i),o&&o.content?r=o.content:(o=await delayResolve(n.remote.get(i),1200),r=o.content,await n.local.put(o))}catch(e){return console.error("Failed to load article"),t&&dom.removeElement(s),s.classList.remove("loading3"),null}}r=toMarkdown(r);const o=dom.markdown(r);s.classList.remove("loading3"),i?s.innerHTML+=o:s.innerHTML=o}({id:n,link:i},s,!0)}break;default:"pin"===s&&dom.removeElement(i)}let o;if(t){let e,r=t;return o=r.dataset.id,o||(r=i.closest("[data-id]"),r&&(o=r.dataset.id)),r&&(e=Object.assign({target:i,item:t,parent:r},r.dataset)),isNaN(o)||(o=parseInt(o)),app.executeCommand(s,...n,o,e),i&&this.#O.onAction(i.name||s,t,i),!0}return app.executeCommand(s,...n),!1}#st(e){this.#O=e,e.dragOptions?this.#at():this.#lt(),this.#Ge&&(this.#Ge.unregisterEvents(),this.#Ge=null),this.#Je&&(this.#Je.unregisterEvents(),this.#Je=null);let t=e.editorElement.querySelector(".scrollable");t&&(this.#Ge=new UX.Scrollable(t),this.#Ge.registerEvents(),this.#Ge.onScrollY=(...e)=>this.#O.onScrollY(...e),this.#Ge.onHeightChange=(...e)=>this.#O.onResize(...e));const i=e.sidebarElement;i&&(t=i.querySelector(".scrollable"),this.#Je=new UX.Scrollable(t),this.#Je.registerEvents())}#at(){this.#e.addEventListener("dragenter",this,!0),this.#e.addEventListener("dragleave",this,!0),this.#e.addEventListener("dragover",this,!0),this.#e.addEventListener("drop",this,!0)}#lt(){this.#e.removeEventListener("dragenter",this),this.#e.removeEventListener("dragleave",this)}#tt(){this.addPage("add",new AddEditor),this.addPage("find",new FindEditor)}#ct(){this.#Ke=new MutationObserver((e=>{let t=0,i=0;for(const n of e)t+=n.addedNodes,i+=n.removedNodes;console.debug("Editor node observer:",t,i)}))}#ht(e){const t=e.editorElement;t&&(console.debug("Editor adding MO for:",e.id),this.#Ke.observe(t,{childList:!0}))}static handleEditAction(e,t){const i=t.closest("[edit]");if(i){const t=i.querySelector("textarea");let n;return t.mde&&(n=t.value,t.mde.toTextArea(),"submit"==e?(t.name,n=t.value,i.querySelector(".md").innerHTML=dom.markdown(n)):(t.value=n,n=null),i.removeAttribute("edit"),delete t.mde),n||!0}}static handleAddAction(e,t){const i=t.closest("[add]");if(!i)return;const n=i.getAttribute("add"),[s,...r]=n.split(",");if("submit"==e){const e=t.closest("[form]"),n=dom.getValues(e,{},"input,select,[contenteditable],[role]"),o=i.querySelector("[container]"),a=dom.renderTemplate(s,n,"div",...r);o.appendChild(a),dom.moveTop(a)}return i.classList.remove("expanded"),!0}}async function Wh(e,t){const i=e.name;for await(const n of e.values())if("file"==n.kind){const[e,s]=fileX.getFilename(n.name),r={album:i};if(fileX.isMedia(s)){const t=e.match(/^([0-9]{1,2})([ -.]+)?(.*)/);t&&(r.title=t[3],r.track=parseInt(t[1]))}const o=await n.getFile();o.meta=r,t.push(o)}console.log("READING meta",t.map((e=>e.meta)))}async function Yh(e){const t=e.getAttribute("ds"),i=e.getAttribute("template"),n=e.querySelector(".input-area"),s=n.firstElementChild.value;n.lastElementChild.disabled=!0;let r=e.querySelector(".results");r&&dom.removeElement(r);const o=!1;if(app){const n=app.ds(t);if(n){e.classList.toggle("loading3");try{const t=await delayResolve(n.search(s),1200);r=dom.renderTemplate("search-area-results",t,"div",i),e.appendChild(r),o=!0}catch(r){}e.classList.toggle("loading3")}}return o}function Xh(e){for(var t=document.getElementsByClassName("autocomplete-items"),i=0;i<t.length;i++)dom.removeElement(t[i])}function Zh(e,t){var i,n,s,r=e.value;if(!r||0==t.length)return!1;let o,a,l;for((i=dom.createElement("div","autocomplete-items")).setAttribute("id",e.name+"autocomplete-list"),e.parentNode.appendChild(i),s=0;s<t.length;s++)if(l=null,"string"==typeof t[s]?(o=t[s].capitalizeFirstLetter(),a=t[s]):(o=t[s].display||t[s].name.capitalizeFirstLetter(),a=t[s].id||t[s].name,l=t[s].photo||t[s].avatar),o.substr(0,r.length).toUpperCase()==r.toUpperCase()){let e="";l&&(e+=`<img src="${l}" class="photo x24 w3-margin-right">`),e+=`<strong>${o.substr(0,r.length)}</strong>`,e+=o.substr(r.length),e+=`<input type='hidden' value='${o}' data-id='${a}'>`,(n=dom.createElement("div","noevents","autocomplete-item","row","ci","w3-padding-small")).innerHTML=e,i.appendChild(n)}}class Kh{#O;#dt;#e;get selected(){return this.#e.querySelector("button.selected")}get active(){return this.#O}constructor(e="navbar"){let t=document.getElementById(e);t||(t=dom.createElement("div")),t.onclick=e=>{const t=e.target;if("BUTTON"!=t.tagName)return;const i=t.name;i&&this.switchTo(i,t)},this.#e=t,app.on("channelmsg",(e=>this.#ut("channel",e.detail))),app.on("chatmsg",(e=>this.#ut("contact",e.detail))),app.on("roommsg",(e=>this.#ut("contact",e.detail))),app.on("gamemsg",(e=>this.#ut("game",e.detail))),app.on("hangup",(e=>{e.detail.missed&&this.#ut("contact",data.detail)}))}e;item(e){return this.#e.querySelector(`button[name="${e}"]`)}addAction({id:e,icon:t}){const i=this.#e.querySelector(".actions"),n=dom.createElement("button","icon","item");n.title=e.capitalizeFirstLetter(),n.dataset.action=e.toLowerCase(),n.innerHTML=`<i class="fa ${t}"></i>`,i.appendChild(n)}show(){dom.showElement(this.#e)}hide(){dom.hideElement(this.#e)}switchTo(e,t){if(this.#O!=e){if(this.clearSelection(),this.select(e,t),t){const e=t.querySelector(".badge");e&&t.removeChild(e)}this.onChange(e)}else["home","task"].includes(e)||(this.#dt&&this.#dt.classList.toggle("selected"),this.toggle())}clearSelection(){this.#O&&(this.#O=null);const e=this.selected;e&&e.classList.remove("selected")}select(e,t){t||(t=this.item(e)),this.#O=e,this.#dt=t,t&&t.classList.add("selected")}onOpenEditor(e){this.#O!=e&&("home"==this.#O&&this.clearSelection(),["task","help"].includes(e)&&(this.clearSelection(),this.select(e)))}addNotification(e,t){const i=this.item(e);let n=i.querySelector(".badge"),s=0;if(n){const e=n.innerText;if("9+"==e)return;s=Number(e)}else n=document.createElement("div"),n.classList.add("badge"),i.appendChild(n);s++,n.innerText=s>9?"9+":`${s}`}onChange(){}toggle(){}#ut(e,t){this.selected&&e==this.selected.name||t.own||this.addNotification(e,t)}}class Gh extends UX.Page{#pt;get type(){return this.#pt}get area(){return this.container}get showFilter(){return!0}get filter(){}set filter(e){}constructor(e,t){super(t),this.#pt=e}onDragStart(){}getIconId(){}static registerOptions(e,t){AddEditor.register(e,t.items)}}const Jh={clearSelection(){const e=document.querySelector("#sidebar .list2");UX.List.clearSelection(e)},add(e,t=!1){return"string"==typeof e?e={id:e}:e.id||(e.id=e.name),this.addTemplate(this.template_,e,t)},getDataType(){return this.opt.dataType},onAdd(){}};Object.assign(Gh.prototype,UX.ListMixin,Jh);class Qh extends UX.List{static Page=Gh;static#mt={};static register(e,t=e.id){Qh.#mt[t]=e}#e;#gt=new Map;#O=null;#ft;#vt;#yt;#C;#bt;#Te;#He;#Ue=!0;#wt;set width(e){this.parentElement.style.width=e}constructor(e="sidebar"){const t="string"==typeof e?document.getElementById(e):e;super(t.querySelector(".scrollable")),this.#e=t,this.width=app.ui.sidebar.width,this.registerEvents(),this.registerClickHandlers();const i=t.querySelector(".head");this.#ft=i.querySelector("i.fa.icon"),this.#vt=i.querySelector(".title"),this.#yt=i.querySelector('input[name="filter"]'),this.#C=i.querySelector('button[name="add"]'),this.#bt=i.querySelector('button[name="import"]'),this.#Te=i.querySelector('button[name="search"]'),this.#C.onclick=()=>this.#kt(),this.#Te.onclick=()=>this.#xt(),this.#bt.onclick=()=>this.onAction("import",null,this.#bt),this.#He=new Kh,this.#He.onChange=e=>{switch(console.debug("SIDEBAR on nav change:",e),e){case"home":case"task":app.openEditor(e);break;default:this.open(e)}},this.#He.toggle=()=>this.toggle(),this.#yt.oninput=e=>this.#_t(e.target,e.data),this.area.ondragstart=e=>{const t=e.dataTransfer,i=e.target,n=i.dataset.id,s=i.parentElement.getAttribute("group");console.debug("Start draging",n,s),t.setData("type",s),t.setData("id",n)},app.on("timeupdate",(e=>this.#Ct(e.detail)))}toggle(){this.#Ue=this.#e.classList.toggle("collapsed")}show(){dom.showElement(this.#e)}hide(){dom.hideElement(this.#e)}async open(e){if(this.#Ue&&this.toggle(),this.#O&&this.#O.type==e)return;this.#He.active!=e&&this.#He.switchTo(e);let t=this.#gt.get(e);t||(t=this.#Et(e),await t.load()),this.#O&&this.#O.hide(),this.#O=t;const i=t.filter;i?(this.#yt.value=i,this.#St(i)):this.#yt.value="";const n=t.title||e;this.#At(t),this.#Tt(n),t.show()}onClick(e,t,i){if(console.log("SIDEBAR on click",e),i&&"A"===i.tagName){const e=i.getAttribute("link");if(e){const[t,i,n]=e.slice(1).split("/");return void("add"===i&&app.add(t,n))}}if(this.selectItem(e),t.classList.remove("missed"),this.#O){let i,n;const s=t.closest("[group]");if(s&&(i=s.getAttribute("group"),n=s.getAttribute("cmd")),n||(n=t.getAttribute("cmd")),n){const e=t.dataset.id;app.executeCommand(...n.split("-"),e)}this.#O.onClick(e,t,i)}}onAction(e,t,i){const n=i.getAttribute("cmd");if(n){const[e,...i]=n.split("-");"find"===e?app.find(i[0]):app.executeCommand(e,...i,t)}else this.#O&&this.#O.onAction(e,t,i)}onOpenEditor(e,t,i){switch(console.debug("SIDEBAR on editor open:",e,this.#O),this.#He.onOpenEditor(e),e){case"contact":case"channel":this.selectItem(i);break;case"home":case"task":this.#Ue||this.toggle(),this.clearSelection()}}switchTo(e){return this.open(e)}load(e){}has(e){return this.#gt.has(e)}#Et(e){const t=Qh.#mt[e];if(!t)throw console.error("Sidebar: unknown page",e),new Error("Invalid sidebar page:",e);const i=dom.createElement("div",`sb-${e}`,"fit","fade","hidden");i.dataset.type=e;const n=new t(i);return this.append(i),this.#gt.set(e,n),n}#Tt(e){const t=this.#O.icon;t?this.#ft.setAttribute("icon-id",t):this.#ft.removeAttribute("icon-id"),this.#vt.innerText=e.toUpperCase()}#At(e){const t=!!e.showFilter,i=!!e.showAdd,n=!!e.showSearch;t?dom.showElement(this.#yt):dom.hideElement(this.#yt),i?dom.showElement(this.#C):dom.hideElement(this.#C),n?dom.showElement(this.#Te):dom.hideElement(this.#Te);const s=e.showImport;this.#bt.title="Import",this.#bt.removeAttribute("cmd"),s?("string"==typeof s?this.#bt.title=s:"object"==typeof s&&(this.#bt.title=s.title,s.cmd&&this.#bt.setAttribute("cmd",s.cmd)),dom.showElement(this.#bt)):(this.#bt.title="Import",this.#bt.removeAttribute("cmd"),dom.hideElement(this.#bt))}#kt(){this.#O&&app.executeCommand("add","new",this.#O.type)}#xt(){this.#O&&app.find(this.#O.type)}#Ct(e){this.#O&&this.#O.updateTimes(e)}#_t(e,t){this.#wt||(this.#wt=setTimeout((()=>{if(!this.#O)return;const e=this.#yt.value.trim();this.#St(e),this.#wt=null}),2e3))}#St(e){const t=this.#O.querySelectorAll("[group]");e&&(this.#O.filter=e);for(const i of t)UX.List.createMixin(i).filter(e)}static defaultSettings(){return{width:"260px"}}}Object.assign(Qh.prototype,UX.PageMixin);const ed={interval:30,log:!1},td=86400;class id{#L=[];#jt;#Lt;#Dt=!1;get interval(){return this.#Lt.interval}set interval(e){this.#Lt.interval=e}constructor(e=ed){this.#Lt=Object.assign({},ed,e)}setTimeout(e,t,i=!1,n=e,s=""){const r=this.createTask(t,s);return i&&(r.interval=e),this.push(n,r),this.#Dt||this.#ge(),r}suspend(){this.#Dt=!0,this.#Ot()}resume(){this.#Dt=!1,this.#L.length>0&&this.#ge()}reset(){console.debug("Runner RESET"),this.#Ot(),this.#L=[],this.#Dt=!1,this.#ge()}execute(){return this.#It()}setInterval(e){const t=this.interval;if(e==t)return;const i=[],n=function(e){return Array.from(e.entries()).filter((e=>null!=e[1]&&e[1].size>0))}(this.#L);if(e<t){const s=Math.floor(t/e);for(const[e,t]of n)i[e*s]=t}else{let s,r=Math.floor(e/t);for(const[e,t]of n)s=Math.floor(e/r),i[s]=t}this.interval=e,this.#L=i,this.#zt()}createTask(...e){return id.createTask(...e)}checkStop(){0==this.#L.length&&this.#Ot()}push(e,t){let i=Math.round(e/this.#Lt.interval);i>0&&--i;let n=this.#L[i];n?n.add(t):this.#L[i]=new Set([t]),t.queue=this.#L[i]}shift(){return this.#L.shift()}#ge(){if(this.#jt)return;const e=this.interval;this.#jt=setInterval((()=>this.execute()),1e3*e)}#Ot(){this.#jt&&(clearInterval(this.#jt),this.#jt=void 0)}#zt(){this.#Dt||(console.debug("Runner restart:",this.interval),this.#Ot(),this.#ge())}#It(){const e=this.#L.shift();if(e)for(const t of e)t.interval&&this.push(t.interval,t),t.execute(!1);this.checkStop()}static createTask(e,t){return{name:t,callback:e,cancel(){this.queue.delete(this)},execute(e=!0){return console.debug(Date.formatTimeDate(),"Task execute ...",this.name),e?(this.forced=!0,this.callback(this)):this.forced?void delete this.forced:this.callback(this)},skipNext(){this.forced=!0}}}}class nd extends id{#Pt;#Mt;constructor(e=[1800,600,60]){e.sort(((e,t)=>t-e)),super({interval:e[e.length-1]}),this.#Pt=e,this.#Mt=e.map((e=>0)),console.debug("Task runner:",this.#Pt)}setTimeout(e,...t){const i=this.#Pt;let n,s;for(let t=0;t<i.length-1;++t){const r=i[t];if(e>=r){let i=e/r;if(i-=Math.floor(i),i>.9||i<.1){n=r,s=t;break}}}if(n||(s=i.length-1,n=i[s]),1==++this.#Mt[s]){let e=!0;for(let t=s+1;t<this.#Mt.length;++t)if(this.#Mt[t]>0){e=!1;break}(e||n<this.interval)&&this.setInterval(n)}const r=super.setTimeout(e,...t);return r._index=s,r.cancel=()=>{if(r.queue.delete(r),r.interval=0,0==--this.#Mt[s])for(let e=s-1;e>=0;--e)if(this.#Mt[e]>0){this.setInterval(this.#Pt[e]);break}},r}async execute(){const e=this.shift();if(e){let t,i=[];for(const n of e)t=n.execute(!1),isPromise(t)?(i.push(t),t.then((()=>this.checkPush(n)))):this.checkPush(n);i.length>0&&await Promise.all(i)}this.checkStop()}checkPush(e){e.interval&&super.push(e.interval,e)}createDailyRunner(e=0,t=5,i=6,n=14){return new sd(this,e,t,i,n)}createDailyRunner2(e=0){return new rd(this,e)}}class sd{#Rt;#Mt=[];#ge;#$t;#Bt=1;#jt=1;constructor(e,t,i,n,s){const r=Date.seconds(),[o,a]=function(e,t=Date.seconds()){const i=Math.floor(t/td)*td;let n=i+3600*(6-e),s=i+3600*(20-e);return t>=n?t<s?(n=0,s-=t):(n=n+td-t,s=n+50400):(n-=t,s-=t),[n,s]}(t,r);this.#jt=i,console.log(Date.formatTimeDate(r),"Starting daily runner in",Math.floor(o/60),"mins"),this.#ge=e.setTimeout(td,(()=>{this.#Rt=e.setTimeout(60*i,(()=>this.#It()),!0)}),!0,o),this.#$t=e.setTimeout(td,(()=>this.#Rt.cancel()),!0,a)}setInterval(e,t){const i=Math.ceil(e/this.#jt)-1;console.debug("Setting interval:",e,i),this.#Mt[i]?this.#Mt[i].push(t):this.#Mt[i]=[t]}#It(){const e=new Date;console.debug(e.formatTimeDate(),"Executing daily runner");const t=[];for(let e=0;e<this.#Mt.length;++e){if(this.#Bt%(e+1))continue;const i=this.#Mt[e];i&&t.push(...i)}++this.#Bt,t.length>0&&function(e){console.debug("TASK call:",e);const t=e.shift();if("function"!=typeof t&&console.debug("###>> ",t),t(),e.length>0){const t=setInterval((()=>{e.shift()(),0==e.length&&clearInterval(t)}),2e3)}}(t)}}class rd{#Nt;#L=[];#Mt=[];#Ft=!1;#qt;constructor(e,t){const[i,n,s]=function(e,t=Date.seconds()){const i=Math.floor(t/td)*td;let n=i+3600*(6-e),s=i+3600*(20-e),r=!1;return t>=n?(n=n+td-t,t<s?(r=!0,s-=t):s=n+50400):(n-=t,s-=t),[n,s,r]}(t);e.setTimeout(td,(()=>this.#Ht()),!0,i,"Daily start task"),e.setTimeout(td,(()=>this.#Ut()),!0,n,"Daily stop task"),this.#Nt=e,console.debug("Daily runner",i,n,s),s&&this.#Ht()}setInterval(e,t,i=!1,n=""){this.#L.push({interval:e,cb:t}),this.#Ft&&this.#Vt(e,t,i,n)}#Ht(){this.#qt=[...this.#L],this.#Ft=!0,console.debug("Starting tasks:",this.#qt.length),this.#Nt.setTimeout(20,(e=>{const t=this.#qt.shift();if(!t)return console.debug("Canceling start task"),void e.cancel();this.#Vt(t.interval,t.cb)}),!0,0,"Starter Task")}#Ut(){for(const e of this.#Mt)e.cancel();this.#Ft=!1,this.#Mt=[]}#Vt(e,t,i=!0,n=""){const s=i?0:Math.ceil(.2*e*Math.random());console.debug("START task delay",n,s);const r=this.#Nt.setTimeout(e,t,!0,s,n);this.#Mt.push(r)}}class od{#Ye;get name(){return this.#Ye}constructor(e){this.#Ye=e}ls(){}count(){}get(){}put(){}set(){}search(){}}class ad extends od{ls(...e){return app.db.ls(this.name,...e)}lsByIndex(...e){return app.db.lsByIndex(this.name,...e)}lsByRange(...e){return app.db.lsByRange(this.name,...e)}count(){return app.db.count(this.name)}async get(e){const t=await app.db.get(this.name,e);return t&&t.content&&"string"!=typeof t.content&&(t.content=unzip(t.content)),t}async getByIndex(e,t){const i=await app.db.getByIndex(this.name,e,t);return i&&i.content&&"string"!=typeof i.content&&(i.content=unzip(i.content)),i}put(e){const t=Array.isArray(e)?e:[e];for(const e of t)e.content&&(e.content=zip(e.content));return app.db.put(this.name,e)}update(e,...t){const i=[e,...t];"object"==typeof e&&i.unshift(e.id);const n=i[1];return n&&n.content&&(n.content=zip(n.content)),app.db.update(this.name,...i)}rm(e){return app.db.rm(this.name,e)}}class ld extends ad{#Wt;constructor(e,t){super(e),this.#Wt=t}async get(e){const t=await app.db.getByIndex(this.name,this.#Wt,e);return t&&t.content&&"string"!=typeof t.content&&(t.content=unzip(t.content)),t}put(e){const t={};return t[this.#Wt]=e,super.update(e.id,t)}}ad.Index=ld,ad.Value=class extends ad{#Yt;constructor(e,t){super(e),this.#Yt=t}async get(e){const t=await super.get(e);if(t)return t[this.#Yt]}put(e,t){"object"==typeof e&&(e=(t=e).id,delete t.id);const i={};return i[this.#Yt]=t,super.update(e,i)}};class cd extends od{#Xt;get path(){return`${this.#Xt}/${this.name}`}constructor(e,t="/api"){super(e),this.#Xt=t}async ls(e=0,t=50,i=0){const n=new URLSearchParams;return n.set("offset",e),n.set("limit",t),i&&n.set("ts",i),await ajax.get(`${this.path}?${n.toString()}`)||[]}async get(e){const t=await this.query(null,e);return t&&Array.isArray(t)?t.length>0?t[0]:null:t}query(e,t){let i=this.path;return e&&(i+=`/${e}`),i+="object"==typeof t?`?${new URLSearchParams(Object.entries(t)).toString()}`:`/${t.toString()}`,ajax.get(i)}search(e,t,i=0,n=20){let s=`${this.#Xt}/search/${this.name}?`;"string"==typeof e&&(e={what:e});const r=new URLSearchParams(e);return t&&t.length>0&&(t.push("id"),r.set("attr",t.join(","))),r.set("offset",i),r.set("limit",n),s+=r.toString(),ajax.get(s)}}class hd extends cd{put(e){return ajax.post(this.path,e)}rm(e){return ajax.delete(`${this.path}/${e}`)}}class dd extends cd{async ls(e,t){const i=await app.firebase.ls(this.name);if(!i)return null;const n=Object.toArray(i);for(const e of n)e.user=await app.loadContact(e.user);return n}get(e){return app.firebase.get(this.name,e)}async search(e,t,i){const n=await app.firebase.search(this.name,i,e.toLowerCase());return n?Object.toArray(n):null}set(...e){return app.firebase.set(...e)}}class ud extends od{static Base=od;static Database=ad;static Rest=cd;#Zt;#Kt;get local(){return this.#Zt}get remote(){return this.#Kt}constructor(e,t=e){super("string"==typeof e?e:e.name),this.#Zt="string"==typeof e?new ad(e):e,this.#Kt="string"==typeof t?new dd(t):t}ls(...e){return this.#Zt.ls(...e)}count(){return this.#Zt.count()}async get(e){let t=await this.#Zt.get(e);return!t&&(t=await this.#Kt.get(e),t)&&("string"==typeof t?t={id:e,content:t}:(t.remote=!0,t.id=t.id||e),await this.#Zt.put(t)),t}async put(e,t=!1){const i=await this.#Kt.put(e);i&&!Array.isArray(e)&&Object.assign(e,i),await this.#Zt.put(e)}async search(...e){return await this.#Kt.search(...e)}async pull(e){let t;return t=await this.#Kt.ls(0,50,e),t.length>0&&await this.#Zt.put(t),t}update(...e){return this.#Zt.update(...e)}rm(e){return this.#Zt.rm(e)}async purge(e){return await this.#Kt.rm(e),this.#Zt.rm(e)}}const pd=function(e){return class extends e{#Gt;#Lt;get local(){return this.#Gt||super.local}constructor(...e){const t={maxCacheSize:1e3,maxCacheTime:1728e5},i=e[e.length-1];"object"==typeof i&&"Object"==i.constructor.name&&(e.pop(),Object.assign(t,i)),super(...e),this.#Lt=t}async ls(...e){if(!this.#Gt){this.#Gt=new CacheMap(this.#Lt);let t=await super.ls(...e);if(t)for(const e of t)this.#Gt.set(e.id,e)}return this.#Gt.values()}async get(e){await this.ls();let t=this.#Gt.get(e);return t||(t=await super.get(e),t&&(t.id=t.id||e,this.#Gt.set(e,t)),t)}put(e){if(this.#Gt){e=Array.isArray(e)?e:[e];for(const t of e)this.#Gt.set(t.id,t)}return super.put(e)}update(e,t,i={}){if(this.#Gt){let n=this.#Gt.get(e);n?Object.assign(n,t):this.#Gt.set(e,Object.assign({id:e},i,t))}return super.update(e,t,i)}}},md=pd(ud),gd=pd(ad),fd=pd(ld);class vd extends ud{get path(){return this.remote.path}constructor(e,t=e,...i){super(e,"string"==typeof t?new cd(t,...i):t)}async ls(){let e=await this.local.ls();return 0==e.length&&(e=await this.remote.ls(),e.length>0&&await this.local.put(e)),e}async rm(e){await this.remote.rm(e),await this.local.rm(e)}}const yd=new ad("update");md.Database=gd,md.DatabaseIndex=fd,vd.Admin=class extends vd{constructor(e,t=e,...i){super(e,"string"==typeof t?new hd(t,...i):t)}},vd.Firebase=class extends od{#Jt;#Qt;get fb(){return this.#Qt}constructor(e){super(e),this.#Jt=new cd(e),this.#Qt=new dd(e)}ls(...e){return this.#Qt.ls(...e)}get(...e){return this.#Qt.get(...e)}put(...e){return this.#Jt.put(...e)}search(...e){return this.#Jt.search(...e)}rm(e){return this.#Jt.rm(e)}},cd.Admin=hd,ud.Cache=md,ud.Backend=vd,ud.Multi=class extends od{#ei;constructor(...e){super(e.map((e=>e.name)).join("-")),this.#ei=[...e]}async ls(){let e=[];for(const t of this.#ei){const i=await t.ls(),n=t.name;for(const t of i)e.push({...t,ds:n})}return e}},ud.Create=class extends vd{#ti;#ii=!1;async ls(){const e=this.local;let t=await e.ls();return 0==t.length&&(t=await this.remote.ls(),await e.put(t)),t}},ud.Update=class extends vd{#a;#ni;constructor(e,t=e){super(e,t),this.#ni="string"==typeof e?e:e.name}async ls(e=0,t=50){const i=Date.now();let n,s=!1;if(this.#a?i-this.#a>7200&&(s=!0):s=!0,s){this.#a=i;const s=await yd.get(this.#ni);if(s){const i=s.ts;n=await this.remote.ls(e,t,i),n.length>0&&await this.local.put(n)}await yd.put({id:this.#ni,ts:i})}return n=await super.ls(),0==n.length&&(n=await this.remote.ls(),n.length>0&&this.local.put(n)),n}},ud.Filter=class{#si;#yt;constructor(e,t=(e=>!0)){this.#si=e,this.#yt=t}get name(){return this.#si.name}get(...e){return this.#si.get(...e)}put(...e){return this.#si.put(...e)}update(...e){return this.#si.update(...e)}async ls(...e){return(await this.#si.ls(...e)).filter(this.#yt)}async search(...e){const t=await this.#si.search(...e);return t?t.filter(this.#yt):null}};const bd={initEvents(){this.event=new EventTarget},on(e,t){this.event.addEventListener(e,t)},emit(e,t){this.event.dispatchEvent(new CustomEvent(e,{detail:t}))}};class wd extends UX.Page{static Database=er;static Player=lr;static Editor=Vh;static Sidebar=Qh;static DataSource=ud;static Commands={register(e,t){this[e]=t}};#ri=!1;#$e=!1;#oi={};#ai;#li;#ci;#R={};#Nt=new nd([1800,300,60]);#hi=new id({interval:5,log:!0});#di;#Je;#we;get runner(){return this.#Nt}get monitor(){return this.#hi}get sidebar(){return this.#Je}get editor(){return this.#we}get expanded(){return!0}get ui(){return this.#ai}get currentEditor(){return this.editor.currentEditor}get db(){return this.#li}get fs(){return this.#ci.root}get musicDirectory(){return this.#oi?this.#oi.music:null}get defaultAvatar(){return"/ui/svg/contact.svg"}get defaultRoom(){return"/ui/svg/contact-green.svg"}get recent(){return this._recent}get recentPath(){return"recent"}handleCommand(e,...t){const i=wd.Commands[e];return!!i&&(i(...t),!0)}isme(e){return!!e&&("string"==typeof e?e.isEmail()?e==this.email:e==this.uid:e.id==this.uid)}memberOf(){return!1}constructor(e="main"){var t,i;super(e),window.app=this,this.event=new EventTarget,this._={},t=localStorage.getItem("theme"),i=window.matchMedia("(prefers-color-scheme: dark)"),null!==t||i.matches;const n=document.getElementById("modal-dialog");window.onbeforeunload=()=>this.unload(),document.onvisibilitychange=()=>document.hidden?this.onBlur():this.onFocus(),document.onclick=e=>{const t=e.target;if(document._popup&&document._popup.onDocumentClick(e),e.target!=n){if(t.hasAttribute("expandable"))["A","CODE"].includes(t.tagName)||t.classList.toggle("expanded");else if("BUTTON"===t.tagName){if(t.closest("#titlebar"))return void this.onAction(t.name,t);const e=t.closest(".modal");if(e)return void(e.style.display="none")}}else n.style.display="none"},document.onchange=e=>{const t=e.target;if("SELECT"===t.tagName&&t.hasAttribute("tab")){const e=t.parentElement.querySelector(`[data-tab="${t.value}"]`);dom.insertAfter(e,t)}},document.onmousedown=e=>{const t=e.target;if(t.classList.contains("v-sash")){const i=t.previousElementSibling,n=t.classList.contains("reverse"),s=e.clientX,r=i.offsetWidth;document.body.style.cursor="e-resize";const o=e=>{const t=s-e.clientX,o=n?r+t:r-t;i.style.width=`${o}px`},a=e=>{document.documentElement.removeEventListener("mousemove",o,!1),document.documentElement.removeEventListener("mouseup",a,!1),document.body.style.cursor="default";const t=i.id;if(t){const e=parseInt(i.style.width);this.updateWidth(t,e)}};document.documentElement.addEventListener("mousemove",o,!1),document.documentElement.addEventListener("mouseup",a,!1)}},document.oncopy=e=>{const t=e.target;if(t.hasAttribute("contenteditable"))return e.clipboardData.setData("text/plain",t.textContent.trim()),void e.preventDefault()},window.addEventListener("freeze",(e=>{console.debug("# On Hibernate !!!")}),{capture:!0}),window.addEventListener("resume",(e=>{console.debug("# On hibernate resume !!!")}),{capture:!0})}createDatabase(){return new er}createEditor(){return new Vh}createSidebar(){return new Qh}async setupDatabase(){}addDS(e,t){this._[t||e.name]=e}ds(e){return this._[e]}toggleLoading(){return super.toggleLoading("loading2")}async load(){try{this.#ci=await fs.init()}catch(e){console.error("Failed to initialize TMPFS",e)}const e=this.createDatabase();try{await e.init(),this.#li=e}catch(e){console.error("Failed to initialize IndexedDB",e)}await this.loadSettings(),await this.registerServiceWorker(),this.#Je=this.createSidebar(),this.#we=this.createEditor(),this.#$e=!0,this.#ri=await this.requestNotifications(),console.log("Notifications enabled?",this.#ri),this.#ui(),this.player=new lr,this.player.registerEvents()}requestNotifications(){return!1}registerServiceWorker(){}unload(){console.log("Unloading app")}onFocus(){this.#$e=!0,this.#hi.resume(),console.debug("# Resuming monitor"),this.#di?(clearTimeout(this.#di),this.#di=void 0):(this.runner.resume(),this.emit("idle",!1))}onBlur(){this.#$e=!1,this.#hi.suspend(),console.debug("## Susspending monitor"),this.#di=setTimeout((()=>{this.#di=void 0,this.runner.suspend(),this.emit("idle",!0)}),12e4)}onHibernate(){this.db.updateHistory()}onResume(){}async setHomeDirectory(e){console.log("Setting home directory",e);const t=e.getDirectoryHandle("Pictures",{create:!0}),i=e.getDirectoryHandle("Music",{create:!0});return this.#oi={root:e,images:t,music:i},this.#li.put("settings",{type:"storage",root:e})}getRootDirectory(e){return fs.directory(this.fs,e,{create:!0})}async getImagesDirectory(){return this.#oi.images||(this.#oi.images=await this.getRootDirectory("Images")),this.#oi.images}async loadSettings(){const e=localStorage.getItem("ui");e?this.#ai=JSON.parse(e):this.defaultSettings();const t=await this.db.ls("settings");for(const e of t){const t=e.type;delete e.type,"storage"===t?this.#oi=e:this.#R[t]=e}console.log("SETTINGS loaded",t)}initUser(){}defaultSettings(){this.#ai={sidebar:Qh.defaultSettings()},this.updateSettings()}setUserInfo(){const e=this.container.querySelectorAll('[role="username"]'),t=this.displayName;for(const i of e)i.innerText=t}updateSettings(){localStorage.setItem("ui",JSON.stringify(this.#ai))}updateWidth(e,t){const i=this.#ai[e];i?i.width=t:this.#ai[e]={width:t},this.updateSettings()}updateSetting(e,t){const i=this.#ai[e];i?Object.assign(i,t):this.#ai[e]=t,this.updateSettings()}async startIdleDetecton(){if("granted"===await IdleDetector.requestPermission())try{const e=new IdleDetector;e.addEventListener("change",(()=>{const t=e.userState,i=e.screenState;console.log(`Idle change: ${t}, ${i}.`)})),await e.start({threshold:6e4,signal}),console.log("IdleDetector is active.")}catch(e){console.error(e.name,e.message)}else console.error("Idle detection permission denied.")}startLifecycle(e=!0){const t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1);setTimeout((()=>{this.emit("datechange"),setInterval((()=>this.emit("datechange")),864e5)}),i-t),e&&this.#Nt.setTimeout(120,(()=>this.emit("timeupdate",Date.now())),!0)}openEditor(...e){this.onOpenEditor(...e),this.editor.open(...e)}cancelEditor(){this.editor.cancel()}onOpenEditor(e,...t){console.debug("APP: Opening editor",e),["find","add","video"].includes(e)||this.sidebar.onOpenEditor(e,...t)}doOpenEditor(...e){this.editor.open(...e)}doSave(){console.log("Updating storage"),localStorage.setItem("objects",JSON.stringify([...this.objects]))}save(e=!1){e?this.doSave():this.saveTimeout||(console.log("APP: Starting save timer ..."),this.saveTimeout=setTimeout((()=>{this.doSave(),delete this.saveTimeout}),kSaveTimeout))}add(e,t,i=!1){this.editor.notify(`'${e}' ${i?"updated":"added"}`),i||this.emit(`${e}add`,t)}startPushClient(){const e=`ws://${location.host}/push/ws`;console.log("HOST:",e);const t=new WebSocket(e);t.onopen=e=>{console.debug("WS PUSH TEST CONNECTION: connected"),t.send(JSON.stringify({method:"bind",user:this.uid}))},t.onmessage=e=>{const t=e.data,i=JSON.parse(t);console.debug("## PUSH received:",i);const[,n,s]=i.to.match(/\/topics\/(channel-)?(.+)/),r=i.data;if(n)return r.id=s,void this.onChannelPush(r);let o=r.msg;if(r.user&&r.user.startsWith("chat-")){const e=r.msg.match(/\[(.+)\]: (.+)/);if(!e)return void console.error("Message not matching room format:",r);const[,t,i]=e;r.room=r.user.slice(5),r.user=t,o=i}const a="json"==i.type||/^\{.*\}$/.test(o);r.msg=a?JSON.parse(o):o,this.onPush(r)},t.onclose=()=>{console.log("PUSH socket remote close")},t.onerror=e=>{console.error("PUSH socket error",e)}}getInfo(e,t){if("channel"===e){const e=wd.kVirtualChannels[t];if(e)return e}return this.db.get(e,t)}showNotification(e,t,i="warning",n=2e3){if("editor"===e)return this.#we.showNotification(t,i,n)}onAction(e,t){let i;(i=t.getAttribute("cmd"))&&this.executeCommand(...i.split("-"))}async importAudioFiles(e,t=function(){}){const i=[];for(const n of e){const e=n.name.hashCode();t(e,"begin",n);const s=await this.db.get("audio",e);if(s){n.meta=s.meta;continue}const r=n.meta||await fileX.getMeta(n),o=fileX.getExtension(n.name),a=fileX.isVideo(o)?"video":"audio";t(e,"meta",r);const l={id:e,type:a,file:n,rating:0};l.meta=r,l.album=r.album?r.album.toLowerCase().hashCode():0,await app.db.put("audio",l),t(e,"end"),i.push(l)}return t(null,"done"),app.emit("audioadd",i),i}#ui(){}static kVirtualChannels={support:{id:"support",display:"Support",desc:"Get help from Support Team",icon:"f059"}};get virtualChannels(){return wd.kVirtualChannels}}Object.assign(wd.prototype,bd),window.App=wd})(),__webpack_exports__})()));